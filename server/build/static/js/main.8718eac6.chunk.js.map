{"version":3,"sources":["components/Login.js","utils/refreshToken.js","components/Logout.js","routes/project/daw/Track.js","routes/project/daw/AlignRecording.js","routes/project/daw/DAW.js","routes/project/Project.js","routes/project/ProjectSearch.js","routes/home/Home.js","routes/groups/Project.js","routes/groups/Group.js","routes/groups/Groups.js","routes/temp-jitsi/EmbeddedJitsi.js","routes/temp-webaudio/Encoder.js","routes/temp-webaudio/WebAudio.js","routes/temp-webaudio/MicRecorder.js","utils/components/PrivateRoute.js","App.js","index.js"],"names":["Login","props","clientId","process","buttonText","onSuccess","res","refreshTiming","tokenObj","expires_in","refreshToken","a","reloadAuthResponse","newAuthRes","console","log","localStorage","setItem","id_token","setTimeout","refreshTokenSetup","onSuccessfulLogin","onFailure","cookiePolicy","style","marginTop","isSignedIn","Logout","onLogoutSuccess","onSuccessfulLogout","FILE_UPLOAD_OPTION","RENAME_TRACK_OPTION","DELETE_TRACK_OPTION","options","Track","playPauseAudio","state","playing","audioFile","pause","setState","play","stop","changeVolume","value","volume","masterVolume","seek","fastForward","duration","currentSeek","forwardTo","rewind","backwardTo","mute","muted","solo","updateSoloTracks","trackId","soloing","selectToRecord","updatedTrackId","selected","setSelectedTrack","_onSelect","option","label","url","takes","s3_info","selectedTake","Howl","src","format","preload","s3URL","clickThreeDotsMenu","e","threeDotsAnchorElement","currentTarget","closeThreeDotsMenu","target","innerText","document","getElementById","click","renameTrack","trackName","deleteTrack","latestTake","Object","keys","length","latestKey","pop","deleteTake","bind","this","prevProps","selectedTrackId","masterPlay","masterRecord","masterStop","soloTracks","targetTake","takeInfo","d","Date","substr","lastIndexOf","formattedDateTime","toLocaleString","name","Confirm","id","newSelectedTake","takeCopy","splice","indexOf","Math","max","apply","newURL","selectedKeyValue","takeDropdownOptions","reduce","acc","take","parseInt","rawDate","push","reverse","marginLeft","display","alt","width","height","title","onClick","IconButton","aria-label","aria-controls","aria-haspopup","type","hidden","onChange","handleFileUpload","files","Menu","anchorEl","keepMounted","open","onClose","PaperProps","maxHeight","map","MenuItem","marginBottom","Tooltip","arrow","disableRipple","color","marginRight","min","defaultValue","placeholder","method","action","Component","AlignRecordingModalContent","crunker","Crunker","dialog","useDialog","useState","isPlaying","setPlaying","bgWaveSurfer","setBgWaveSurfer","recWaveSurfer","setRecWaveSurfer","loadedAudio","setLoadedAudio","dragOffset","setDragOffset","latencyMagnitude","setLatencyMagnitude","onStopDrag","useCallback","_","position","x","latency","useEffect","WaveSurfer","create","container","waveColor","progressColor","cursorColor","cursorWidth","interact","hideScrollbar","isOpen","recordedURL","recordedTrackId","trackMetadata","load","setVolume","zoom","className","axis","bounds","left","right","onStop","params","scrollParent","seekTo","seekAndCenter","close","round","recorder","vmsg","Recorder","wasmURL","DAW","createTrack","createTake","track_id","file","take_number","take_id","toggleMasterPlay","startTime","now","runningTime","timer","setInterval","targetId","test","alert","newId","formattedTime","ms","minutes","floor","seconds","toFixed","newSoloTracks","index","isRecording","isBlocked","showCountdown","toggleMasterRecord","toggleMasterStop","navigator","mediaDevices","getUserMedia","audio","then","catch","clearInterval","stopRecording","blob","File","URL","createObjectURL","CustomDialog","showCloseIcon","initAudio","initWorker","startRecording","trackInfo","track_name","disabled","fontSize","colors","size","onComplete","remainingTime","Project","retrieveProject","project_hash","fetch","URLSearchParams","resp","json","data","status","body","obj","tracks","item","formatted_takes","date_uploaded","project_name","group_name","group","project_id","track_metadata","location","pathname","split","Prompt","formData","FormData","append","updatedTracks","assign","projectId","new_name","getTimezoneOffset","timestamp","toString","pathSuffix","ProjectSearch","setProjectId","preventDefault","startsWith","history","err","Home","RENAME_PROJECT_OPTION","DELETE_PROJECT_OPTION","useHistory","setThreeDotsAnchorElement","renameProject","project","deleteProject","group_id","RENAME_GROUP_OPTION","DELETE_GROUP_OPTION","Group","renameGroup","deleteGroup","projects","createNewProject","concat","updatedProjects","filter","i","projectInfo","Groups","groups","isLoaded","fetchGroups","createNewGroup","updatedGroups","groupInfo","EmbeddedJitsi","displayName","setDisplayName","roomName","setRoomName","password","setPassword","onCall","setOnCall","containerStyles","onMeetingEnd","loadingComponent","errorComponent","event","Encoder","config","sampleRate","bitRate","mp3Encoder","Mp3Encoder","maxSamples","samplesMono","clearBuffer","dataBuffer","buffer","Int8Array","input","output","s","arrayBuffer","Float32Array","out","Int16Array","floatTo16BitPCM","convertBuffer","remaining","subarray","mp3buffer","encodeBuffer","appendToBuffer","flush","Mp3Recorder","getMediaStream","mediaRecorder","mediaChunks","mediaStream","stream","activeStream","microphone","context","createMediaStreamSource","processor","createScriptProcessor","onaudioprocess","lameEncoder","encode","inputBuffer","getChannelData","connect","destination","disconnect","getAudioTracks","forEach","track","AudioContext","deviceId","exact","addMicrophoneListener","finalBuffer","finish","Promise","resolve","reject","Error","Blob","WebAudio","handleRecord","start","recording","handleStopRecord","getMp3","blobURL","recordings","chunks","controls","deleteRecording","PrivateRoute","component","authed","rest","render","to","from","createHashHistory","App","handleSuccessfulLogin","response","userDetails","profileObj","googleId","email","message","JSON","stringify","isUserLoggedIn","handleSuccessfulLogout","clear","parse","getItem","top","givenName","path","ReactDOM"],"mappings":"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","file":"static/js/main.8718eac6.chunk.js","sourcesContent":["// source: https://github.com/Sivanesh-S/react-google-authentication/blob/master/src/components/Login.js\n\nimport React from \"react\";\n\nimport { GoogleLogin } from \"react-google-login\";\nimport { refreshTokenSetup } from \"../utils/refreshToken\";\n\nfunction Login(props) {\n  const onSuccess = (res) => {\n    // console.log(\"Login Success: currentUser:\", res.profileObj);\n    refreshTokenSetup(res);\n    props.onSuccessfulLogin(res);\n  };\n\n  const onFailure = (res) => {\n    console.log(\"Attempt to login failed: res:\", res);\n    // alert(`Failed to login 😢`);\n  };\n\n  return (\n    <div>\n      <GoogleLogin\n        clientId={process.env.REACT_APP_GOOGLE_CLIENT_ID}\n        buttonText=\"Login\"\n        onSuccess={onSuccess}\n        onFailure={onFailure}\n        cookiePolicy={\"single_host_origin\"}\n        style={{ marginTop: \"100px\" }}\n        isSignedIn={true}\n      />\n    </div>\n  );\n}\n\nexport default Login;\n","// source: https://github.com/Sivanesh-S/react-google-authentication/blob/master/src/utils/refreshToken.js\n\nexport const refreshTokenSetup = (res) => {\n  // Timing to renew access token\n  let refreshTiming = (res.tokenObj.expires_in || 3600 - 5 * 60) * 1000;\n\n  const refreshToken = async () => {\n    const newAuthRes = await res.reloadAuthResponse();\n    refreshTiming = (newAuthRes.expires_in || 3600 - 5 * 60) * 1000;\n    console.log(\"newAuthRes:\", newAuthRes);\n    // saveUserToken(newAuthRes.access_token);  <-- save new token\n    localStorage.setItem(\"authToken\", newAuthRes.id_token);\n\n    // Setup the other timer after the first one\n    setTimeout(refreshToken, refreshTiming);\n  };\n\n  // Setup first refresh timer\n  setTimeout(refreshToken, refreshTiming);\n};\n","import React from \"react\";\nimport { GoogleLogout } from \"react-google-login\";\n\nfunction Logout(props) {\n  const onSuccess = () => {\n    // console.log('Logged out successfully');\n    // alert(\"Logged out successfully ✌\");\n    props.onSuccessfulLogout();\n  };\n\n  return (\n    <div>\n      <GoogleLogout\n        clientId={process.env.REACT_APP_GOOGLE_CLIENT_ID}\n        buttonText=\"Logout\"\n        onLogoutSuccess={onSuccess}\n      ></GoogleLogout>\n    </div>\n  );\n}\n\nexport default Logout;\n","import { Howl } from \"howler\";\nimport Slider from \"rc-slider\";\nimport \"rc-slider/assets/index.css\";\nimport React, { Component } from \"react\";\nimport \"./Track.css\";\nimport Dropdown from \"react-dropdown\";\nimport \"react-dropdown/style.css\";\nimport { Confirm } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\nimport HeadsetRoundedIcon from \"@material-ui/icons/HeadsetRounded\";\nimport VolumeOffRoundedIcon from \"@material-ui/icons/VolumeOffRounded\";\n\nconst FILE_UPLOAD_OPTION = \"+ Upload File\";\nconst RENAME_TRACK_OPTION = \"Rename Track\";\nconst DELETE_TRACK_OPTION = \"Delete Track\";\n\nconst options = [FILE_UPLOAD_OPTION, RENAME_TRACK_OPTION, DELETE_TRACK_OPTION];\n\nclass Track extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selected: false,\n      playing: false,\n      muted: false,\n      audioFile: null,\n      s3URL: null,\n      selectedTake: null,\n      latestTake: 0,\n      soloing: false,\n      volume: 84.95,\n      threeDotsAnchorElement: null,\n    };\n    if (Object.keys(props.takes).length !== 0) {\n      const latestKey = Object.keys(props.takes).pop();\n      const url = props.takes[latestKey].s3_info;\n      if (url) {\n        this.state.audioFile = new Howl({\n          src: [url],\n          volume: 0.5,\n          format: [\"mp3\", \"wav\"],\n          preload: true,\n        });\n        this.state.s3URL = url;\n        this.state.selectedTake = latestKey;\n      }\n    }\n    this.deleteTake = this.deleteTake.bind(this);\n  }\n\n  componentDidMount() {\n    // if this track has takes and the page refreshed, select most recent take\n    if (Object.keys(this.props.takes).length !== 0) {\n      const latestKey = Object.keys(this.props.takes).pop();\n      const url = this.props.takes[latestKey].s3_info;\n      if (url) {\n        this.setState({\n          audioFile: new Howl({\n            src: [url],\n            volume: 0.5,\n            format: [\"mp3\", \"wav\"],\n            preload: true,\n          }),\n          s3URL: url,\n          selectedTake: latestKey,\n          latestTake: latestKey,\n        });\n      }\n      // otherwise reset the take state\n    } else {\n      this.setState({\n        selectedTake: null,\n        audioFile: null,\n        s3URL: null,\n        latestTake: 0,\n      });\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    // unselect selected track if a different track is selected\n    if (\n      this.state.selected &&\n      this.props.selectedTrackId !== this.props.trackId\n    ) {\n      this.setState({ selected: false });\n    }\n\n    // if no take is currently selected and # of states updated\n    if (\n      (this.state.selectedTake === null ||\n        this.state.latestTake !== Object.keys(this.props.takes).pop()) &&\n      Object.keys(this.props.takes).length !== 0\n    ) {\n      const latestKey = Object.keys(this.props.takes).pop();\n      const url = this.props.takes[latestKey].s3_info;\n      if (url) {\n        console.log(\"updated take to take \" + latestKey);\n        this.setState({\n          latestTake: latestKey,\n          selectedTake: latestKey,\n          audioFile: new Howl({\n            src: [url],\n            volume: 0.5,\n            format: [\"mp3\", \"wav\"],\n            preload: true,\n          }),\n          s3URL: url,\n        });\n      }\n    } else if (\n      Object.keys(this.props.takes).length === 0 &&\n      this.state.audioFile\n    ) {\n      this.setState({\n        selectedTake: null,\n        audioFile: null,\n        s3URL: null,\n        latestTake: 0,\n      });\n    }\n\n    // play non-selected track during recording or stop if DAW master controls indicate\n    if (\n      this.props.masterPlay &&\n      this.state.audioFile &&\n      !this.state.playing &&\n      (!this.state.selected ||\n        (this.state.selected && !this.props.masterRecord))\n    ) {\n      console.log(`[${this.props.trackName}] playing 1: ${this.state.s3URL}`);\n      this.state.audioFile.seek(0);\n      this.state.audioFile.play();\n      this.setState({ playing: true });\n    } else if (\n      this.props.masterStop &&\n      this.state.audioFile &&\n      this.state.playing\n    ) {\n      this.state.audioFile.stop();\n      this.setState({ playing: false });\n    }\n\n    // update soloing\n    if (\n      !this.state.soloing &&\n      this.props.soloTracks.length !== 0 &&\n      !this.state.muted &&\n      this.state.audioFile\n    ) {\n      this.state.audioFile.mute(true);\n      this.setState({\n        muted: true,\n      });\n    } else if (\n      this.props.soloTracks.length === 0 &&\n      this.state.muted &&\n      prevProps.soloTracks.length !== 0\n    ) {\n      this.state.audioFile.mute(false);\n      this.setState({\n        muted: false,\n      });\n    }\n\n    if (\n      this.state.audioFile &&\n      prevProps.masterVolume !== this.props.masterVolume\n    ) {\n      this.state.audioFile.volume(\n        (this.props.masterVolume * this.state.volume) / 100\n      );\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.state.audioFile) {\n      this.state.audioFile.stop();\n    }\n  }\n\n  playPauseAudio = () => {\n    if (this.state.playing) {\n      this.state.audioFile.pause();\n      this.setState({ playing: false });\n    } else {\n      this.state.audioFile.play();\n      this.setState({ playing: true });\n    }\n  };\n\n  stop = () => {\n    this.state.audioFile.stop();\n    this.setState({ playing: false });\n  };\n\n  changeVolume = (value) => {\n    // convert linear 1->100 to log 1->100 via f(n) = 50 * log(n)\n    // const volume = Math.max(0, 40 * Math.log10(value));\n    // const volume =\n    //   Math.max(0, (1 - Math.log(value) / Math.log(0.5)) / 9.5) * 100;\n    const volume = value;\n    this.state.audioFile.volume((this.props.masterVolume * volume) / 100);\n    this.setState({ volume: volume });\n  };\n\n  seek = (value) => {\n    this.state.audioFile.pause();\n    this.state.audioFile.seek(value);\n    if (this.state.playing) {\n      this.state.audioFile.play();\n    }\n  };\n\n  fastForward = () => {\n    this.state.audioFile.pause();\n    const duration = this.state.audioFile.duration();\n    const currentSeek = this.state.audioFile.seek();\n    const forwardTo = currentSeek + 5;\n    if (forwardTo >= duration) {\n      this.state.audioFile.stop();\n      return;\n    }\n    console.log(\"ff: \" + currentSeek + \" -> \" + forwardTo);\n    this.state.audioFile.seek(forwardTo);\n    if (this.state.playing) {\n      this.state.audioFile.play();\n    }\n  };\n\n  rewind = () => {\n    this.state.audioFile.pause();\n    const currentSeek = this.state.audioFile.seek();\n    let backwardTo = currentSeek - 5;\n    if (backwardTo <= 0) {\n      backwardTo = 0;\n    }\n    console.log(\"rewind: \" + currentSeek + \" -> \" + backwardTo);\n    this.state.audioFile.seek(backwardTo);\n    if (this.state.playing) {\n      this.state.audioFile.play();\n    }\n  };\n\n  mute = () => {\n    this.state.audioFile.mute(!this.state.muted);\n    this.setState({\n      muted: !this.state.muted,\n    });\n  };\n\n  solo = () => {\n    this.props.updateSoloTracks(this.props.trackId);\n    if (!this.state.soloing) {\n      this.state.audioFile.mute(false);\n      this.setState({\n        soloing: true,\n        muted: false,\n      });\n    } else {\n      this.setState({\n        soloing: false,\n      });\n    }\n  };\n\n  selectToRecord = () => {\n    const updatedTrackId = !this.state.selected ? this.props.trackId : null;\n    this.props.setSelectedTrack(updatedTrackId);\n    this.setState({ selected: !this.state.selected });\n  };\n\n  _onSelect = (option) => {\n    console.log(\"Selected \" + option.label);\n    this.state.audioFile.stop();\n    const url = this.props.takes[option.value].s3_info;\n    this.setState({\n      playing: false,\n      selectedTake: option.value,\n      audioFile: new Howl({\n        src: [url],\n        volume: 0.5,\n        format: [\"mp3\", \"wav\"],\n        preload: true,\n      }),\n      s3URL: url,\n    });\n  };\n\n  async deleteTake() {\n    console.log(\"deleting take\");\n    const targetTake = this.state.selectedTake;\n    const takeInfo = this.props.takes[targetTake];\n    const d = new Date(\n      takeInfo[\"date_uploaded\"].substr(\n        0,\n        takeInfo[\"date_uploaded\"].lastIndexOf(\" \") + 1\n      )\n    );\n    const formattedDateTime = d.toLocaleString(\"en-US\");\n\n    const name = `Take ${targetTake} - ${formattedDateTime}`;\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Take\"\n    );\n    if (result) {\n      this.state.audioFile.stop();\n      await this.props.deleteTake(this.props.trackId, targetTake, takeInfo.id);\n\n      let newSelectedTake = null;\n      if (Object.keys(this.props.takes).length > 1) {\n        console.log(\"selecting existing take\");\n        const takeCopy = Object.keys(this.props.takes);\n        takeCopy.splice(takeCopy.indexOf(targetTake), 1);\n        newSelectedTake = Math.max.apply(Math, takeCopy);\n        const newURL = this.props.takes[newSelectedTake].s3_info;\n        this.setState({\n          playing: false,\n          selectedTake: newSelectedTake,\n          audioFile: new Howl({\n            src: [newURL],\n            volume: this.props.masterVolume * 0.5,\n            format: [\"mp3\", \"wav\"],\n            preload: true,\n          }),\n          s3URL: newURL,\n          latestTake: newSelectedTake,\n        });\n      } else {\n        console.log(\"unsetting audio file\");\n        this.setState({\n          playing: false,\n          selectedTake: newSelectedTake,\n          audioFile: null,\n          s3URL: null,\n          latestTake: 0,\n        });\n      }\n    }\n  }\n\n  clickThreeDotsMenu = (e) => {\n    this.setState({ threeDotsAnchorElement: e.currentTarget });\n  };\n\n  closeThreeDotsMenu = (e) => {\n    const option = e.target.innerText;\n    if (option === FILE_UPLOAD_OPTION) {\n      document.getElementById(\"file-upload\").click();\n    } else if (option === RENAME_TRACK_OPTION) {\n      this.props.renameTrack(this.props.trackId, this.props.trackName);\n    } else if (option === DELETE_TRACK_OPTION) {\n      this.props.deleteTrack(this.props.trackId, this.props.trackName);\n    }\n    this.setState({ threeDotsAnchorElement: null });\n  };\n\n  render() {\n    let selectedKeyValue = { value: this.state.selectedTake };\n    const takeDropdownOptions = Object.keys(this.props.takes)\n      .reduce((acc, take) => {\n        if (parseInt(take) <= parseInt(this.state.latestTake)) {\n          const rawDate = this.props.takes[take][\"date_uploaded\"];\n          const d = new Date(rawDate);\n          const formattedDateTime = d.toLocaleString(\"en-US\");\n          if (take === this.state.selectedTake) {\n            selectedKeyValue[\"label\"] = `Take ${take} - ${formattedDateTime}`;\n          }\n          acc.push({\n            value: take,\n            label: `Take ${take} - ${formattedDateTime}`,\n          });\n        }\n        return acc;\n      }, [])\n      .reverse();\n\n    return (\n      <div style={{ marginLeft: \"5px\" }}>\n        <hr />\n        <div>\n          {this.state.selected ? (\n            <div style={{ display: \"inline-block\" }}>\n              <img\n                src=\"images/daw/selected.png\"\n                alt=\"selected\"\n                width=\"10\"\n                height=\"10\"\n              />{\" \"}\n              <b>Track: {this.props.trackName}</b>{\" \"}\n            </div>\n          ) : (\n            <div style={{ display: \"inline-block\" }}>\n              Track: {this.props.trackName}{\" \"}\n            </div>\n          )}\n          <button\n            title=\"Select/unselect track for recording\"\n            onClick={this.selectToRecord}\n            style={{ marginLeft: \"5px\" }}\n          >\n            {this.state.selected ? \"Unselect\" : \"Select to Record\"}\n          </button>\n          <IconButton\n            aria-label=\"more\"\n            aria-controls=\"track-menu\"\n            aria-haspopup=\"true\"\n            onClick={this.clickThreeDotsMenu}\n            style={{ marginLeft: \"5px\" }}\n          >\n            <MoreHorizIcon />\n          </IconButton>\n          <input\n            type=\"file\"\n            id=\"file-upload\"\n            hidden\n            onChange={(e) =>\n              this.props.handleFileUpload(e.target.files, this.props.trackId)\n            }\n          />\n          <Menu\n            id=\"track-menu\"\n            anchorEl={this.state.threeDotsAnchorElement}\n            keepMounted\n            open={this.state.threeDotsAnchorElement !== null}\n            onClose={this.closeThreeDotsMenu}\n            PaperProps={{\n              style: {\n                maxHeight: 40 * 4.5,\n                width: \"20ch\",\n              },\n            }}\n          >\n            {options.map((option) => (\n              <MenuItem key={option} onClick={this.closeThreeDotsMenu}>\n                {option}\n              </MenuItem>\n            ))}\n          </Menu>\n        </div>\n        {this.state.audioFile && Object.keys(this.props.takes).length > 0 && (\n          <div style={{ marginBottom: \"20px\" }}>\n            <Tooltip title=\"Mute\" arrow>\n              <IconButton\n                disableRipple\n                aria-label=\"Mute this track\"\n                onClick={this.mute}\n              >\n                {this.state.muted ? (\n                  <VolumeOffRoundedIcon color=\"secondary\" />\n                ) : (\n                  <VolumeOffRoundedIcon />\n                )}\n              </IconButton>\n            </Tooltip>\n            <Tooltip title=\"Solo\" arrow>\n              <IconButton\n                disableRipple\n                aria-label=\"Solo this track\"\n                onClick={this.solo}\n              >\n                {this.state.soloing ? (\n                  <HeadsetRoundedIcon color=\"secondary\" />\n                ) : (\n                  <HeadsetRoundedIcon />\n                )}\n              </IconButton>\n            </Tooltip>\n            <div\n              style={{\n                display: \"inline-block\",\n                marginLeft: \"10px\",\n                marginRight: \"10px\",\n                width: \"100px\",\n              }}\n            >\n              Volume\n              <Slider\n                min={0}\n                max={100}\n                defaultValue={50}\n                onChange={this.changeVolume}\n              />\n            </div>\n            <div\n              style={{\n                marginLeft: \"10px\",\n                display: \"inline-flex\",\n                width: 310,\n              }}\n            >\n              <Dropdown\n                options={takeDropdownOptions}\n                onChange={this._onSelect}\n                value={selectedKeyValue}\n                placeholder=\"Select an option\"\n              />\n            </div>\n            <div style={{ display: \"inline-flex\" }}>\n              <form method=\"get\" action={this.state.s3URL}>\n                <button type=\"submit\">Download Take</button>\n              </form>\n              <button onClick={this.deleteTake}>Delete Take</button>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default Track;\n","import {\n  useDialog,\n  ModalContent,\n  ModalFooter,\n  ModalButton,\n} from \"react-st-modal\";\nimport { useState, useEffect, useCallback } from \"react\";\nimport \"./AlignRecording.css\";\nimport WaveSurfer from \"wavesurfer.js\";\nimport Draggable from \"react-draggable\";\nimport Crunker from \"crunker\"; // https://github.com/jackedgson/crunker\n\n// const backing = \"audio/kq/KillerQueen_bg.wav\";\n// const recording = \"audio/kq/KillerQueen_solo.wav\";\nconst backing = \"audio/click.mp3\";\nconst recording = \"audio/off_kovacs.mp3\";\n\nexport default function AlignRecordingModalContent(props) {\n  const crunker = new Crunker();\n  const dialog = useDialog();\n\n  const [isPlaying, setPlaying] = useState(false);\n  const [bgWaveSurfer, setBgWaveSurfer] = useState(null);\n  const [recWaveSurfer, setRecWaveSurfer] = useState(null);\n  const [loadedAudio, setLoadedAudio] = useState(false);\n\n  const [dragOffset, setDragOffset] = useState(0);\n  const [latencyMagnitude, setLatencyMagnitude] = useState(0);\n\n  const onStopDrag = useCallback((_, position) => {\n    console.log(\"stopped:\", position.x);\n    const latency = 12.5053 * position.x + 7.3617;\n    setDragOffset(position.x);\n    setLatencyMagnitude(latency);\n  }, []);\n\n  useEffect(() => {\n    setBgWaveSurfer(\n      WaveSurfer.create({\n        container: \"#bg_waveform\",\n        waveColor: \"#D9DCFF\",\n        progressColor: \"#4353FF\",\n        cursorColor: \"#4353FF\",\n        cursorWidth: 1,\n        height: 200,\n        width: 1000,\n        interact: false,\n        hideScrollbar: true,\n      })\n    );\n    setRecWaveSurfer(\n      WaveSurfer.create({\n        container: \"#rec_waveform\",\n        waveColor: \"#D9DCFF\",\n        progressColor: \"#4353FF\",\n        cursorColor: \"#4353FF\",\n        cursorWidth: 1,\n        height: 200,\n        width: 1000,\n        interact: false,\n        hideScrollbar: true,\n      })\n    );\n  }, []);\n\n  useEffect(() => {\n    if (bgWaveSurfer && recWaveSurfer && dialog && !dialog.isOpen) {\n      bgWaveSurfer.stop();\n      recWaveSurfer.stop();\n    }\n  }, [bgWaveSurfer, recWaveSurfer, loadedAudio, dialog]);\n\n  useEffect(() => {\n    console.log(\"loading recordings\");\n    console.log(props.recordedURL, props.recordedTrackId, props.trackMetadata);\n    if (bgWaveSurfer && recWaveSurfer && !loadedAudio) {\n      // let nonRecordedTrackURLs = Object.keys(props.trackMetadata)\n      //   .filter((trackId) => {\n      //     return trackId !== props.recordedTrackId;\n      //   })\n      //   .map((trackId) => {\n      //     // TODO: made executive decision to just pick latest track, but eventually need to fix how take state is stored so DAW Object can access it\n      //     const takeId = Object.keys(props.trackMetadata[trackId].takes).pop();\n      //     const audio_url = props.trackMetadata[trackId].takes[takeId].s3_info;\n      //     return audio_url;\n      //   });\n      // console.log(nonRecordedTrackURLs);\n      // crunker\n      //   .fetchAudio(...nonRecordedTrackURLs)\n      //   .then((buffers) => {\n      //     // => [AudioBuffer, AudioBuffer]\n      //     return crunker.mergeAudio(buffers);\n      //   })\n      //   .then((merged) => {\n      //     // => AudioBuffer\n      //     return crunker.export(merged, \"audio/mp3\");\n      //   })\n      //   .then((output) => {\n      //     // => {blob, element, url}\n      //     bgWaveSurfer.load(output.url);\n      //     recWaveSurfer.load(props.recordedURL);\n\n      //     bgWaveSurfer.setVolume(0.3);\n      //     recWaveSurfer.setVolume(0.2);\n\n      //     bgWaveSurfer.zoom(80);\n      //     recWaveSurfer.zoom(80);\n      //     setLoadedAudio(true);\n      //   });\n\n      // !TODO REMOVE LATER, ONLY FOR TEST\n      bgWaveSurfer.load(backing);\n      recWaveSurfer.load(recording);\n\n      bgWaveSurfer.setVolume(0.3);\n      recWaveSurfer.setVolume(0.2);\n\n      bgWaveSurfer.zoom(80);\n      recWaveSurfer.zoom(80);\n      setLoadedAudio(true);\n    }\n  }, [bgWaveSurfer, recWaveSurfer, loadedAudio, crunker, props]); // TODO check\n\n  return (\n    <div className=\"outerDiv\">\n      <Draggable axis=\"x\" bounds={{ left: -285, right: 285 }}>\n        <div className=\"cursor\">\n          <div className=\"point\" />\n          <div className=\"startLine\" />\n        </div>\n      </Draggable>\n      <ModalContent>\n        <p>\n          Drag your recording left and right to align the start of your\n          recording! <br />\n          (Move the red cursor as a \"ruler\" to guide alignment)\n        </p>\n        <p>\n          <b>Backing</b>\n        </p>\n        <div id=\"bg_waveform\"></div>\n        <p>\n          <b>Recording</b>\n        </p>\n        <Draggable axis=\"x\" onStop={onStopDrag}>\n          <div id=\"rec_waveform\"></div>\n        </Draggable>\n      </ModalContent>\n      <ModalFooter>\n        <ModalButton\n          onClick={() => {\n            console.log(\"offset:\", dragOffset);\n\n            bgWaveSurfer.params.scrollParent = false;\n            recWaveSurfer.params.scrollParent = false;\n\n            bgWaveSurfer.seekTo(0);\n            recWaveSurfer.seekAndCenter(0);\n\n            // ! TODO UNCOMMENT THIS\n            // recWaveSurfer.seekAndCenter(3 / recWaveSurfer.getDuration());\n\n            if (dragOffset > 0) {\n              console.log(\"[recorded early]: user wants to playback later\");\n              console.log(latencyMagnitude);\n              bgWaveSurfer.play(null, 7);\n              setTimeout(() => {\n                recWaveSurfer.play(null, 10 - latencyMagnitude / 1000);\n              }, latencyMagnitude);\n            } else if (dragOffset < 0) {\n              console.log(\"[recorded late]: user wants to playback earlier\");\n              const latency = -latencyMagnitude;\n              console.log(latency);\n              bgWaveSurfer.play(null, 7);\n              recWaveSurfer.play(\n                latencyMagnitude / 1000,\n                7 + latencyMagnitude / 1000\n              );\n              // setLatencyMagnitude(latency);\n            } else {\n              bgWaveSurfer.play(null, 7);\n              recWaveSurfer.play(null, 7);\n            }\n          }}\n        >\n          Play\n        </ModalButton>\n        <ModalButton\n          onClick={() => {\n            bgWaveSurfer.pause();\n            recWaveSurfer.pause();\n            setPlaying(!isPlaying);\n          }}\n        >\n          Stop\n        </ModalButton>\n        <ModalButton\n          onClick={() => {\n            // Сlose the dialog and return the value\n            bgWaveSurfer.stop();\n            recWaveSurfer.stop();\n            console.log(\"returning value:\", latencyMagnitude);\n            dialog.close(Math.round(latencyMagnitude));\n          }}\n        >\n          Submit\n        </ModalButton>\n      </ModalFooter>\n    </div>\n  );\n}\n","import React, { Component } from \"react\";\nimport \"./DAW.css\";\nimport Track from \"./Track\";\nimport { CountdownCircleTimer } from \"react-countdown-circle-timer\";\nimport { CustomDialog } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\nimport AlignRecordingModalContent from \"./AlignRecording\";\nimport Slider from \"rc-slider\";\nimport \"rc-slider/assets/index.css\";\nimport vmsg from \"vmsg\"; // https://github.com/Kagami/vmsg\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport PlayArrowRoundedIcon from \"@material-ui/icons/PlayArrowRounded\";\nimport StopRoundedIcon from \"@material-ui/icons/StopRounded\";\nimport FiberManualRecordRoundedIcon from \"@material-ui/icons/FiberManualRecordRounded\";\n\nconst recorder = new vmsg.Recorder({\n  wasmURL: \"https://unpkg.com/vmsg@0.3.0/vmsg.wasm\", // ! TODO\n});\n\nclass DAW extends Component {\n  constructor() {\n    super();\n    this.state = {\n      masterPlay: false,\n      masterStop: false,\n      masterRecord: false,\n      isRecording: false,\n      selectedTrackId: null, // to record\n      isBlocked: true,\n      showCountdown: false,\n      runningTime: 0,\n      soloTracks: [],\n      masterVolume: 0.5,\n    };\n    this.toggleMasterRecord = this.toggleMasterRecord.bind(this);\n    this.toggleMasterStop = this.toggleMasterStop.bind(this);\n    // this.test = this.test.bind(this);\n  }\n\n  componentDidUpdate() {\n    if (this.state.masterPlay && this.state.masterStop) {\n      this.setState({\n        masterPlay: false,\n        masterStop: false,\n        runningTime: 0,\n      });\n    }\n  }\n\n  componentDidMount() {\n    console.log(\"reloading DAW\");\n    navigator.mediaDevices\n      .getUserMedia({ audio: true })\n      .then(() => {\n        console.log(\"mic permission granted\");\n        this.setState({ isBlocked: false });\n      })\n      .catch(() => {\n        console.log(\"MIC PERMISSIOM DENIED\");\n        this.setState({ isBlocked: true });\n      });\n\n    this.setState({\n      isRecording: false,\n      masterRecord: false,\n      selectedTrackId: null,\n      soloTracks: [],\n    });\n  }\n\n  // TRACK OPERATIONS\n\n  createTrack = () => {\n    this.props.createTrack();\n  };\n\n  renameTrack = (id, name) => {\n    this.props.renameTrack(id, name);\n  };\n\n  deleteTrack = (id, name) => {\n    const successfulDelete = this.props.deleteTrack(id, name);\n    if (successfulDelete) {\n      // if deleted a selected track, reset selected track\n      this.setState({ selectedTrackId: null });\n    }\n  };\n\n  // TAKE OPERATIONS\n\n  createTake = (track_id, file, latency = 0) => {\n    this.props.createTake(track_id, file, latency);\n  };\n\n  deleteTake = (track_id, take_number, take_id) => {\n    this.props.deleteTake(track_id, take_number, take_id);\n  };\n\n  // PLAYBACK OPERATIONS\n\n  toggleMasterPlay = () => {\n    console.log(\"> master play\");\n    this.setState((state) => {\n      const startTime = Date.now() - this.state.runningTime;\n      this.timer = setInterval(() => {\n        this.setState({ runningTime: Date.now() - startTime });\n      });\n      return { masterPlay: true };\n    });\n  };\n\n  async toggleMasterStop() {\n    console.log(\"> master stop\");\n    if (!this.state.masterPlay) {\n      return;\n    }\n    clearInterval(this.timer);\n    this.setState({ masterStop: true, runningTime: 0 });\n    // let recordedURL, file;\n    if (this.state.isRecording) {\n      const blob = await recorder.stopRecording();\n      // Mp3Recorder.stop()\n      //   .getMp3()\n      //   .then(([buffer, blob]) => {\n      let file = new File(\n        [blob],\n        `recording_track_${this.state.selectedTrackId}.mp3`\n      );\n      let recordedURL = URL.createObjectURL(file);\n      //   return { file: file, recordedURL: recordedURL };\n      // })\n      // .then(async (obj) => {\n      let latency = -1; // in ms\n      if (Object.keys(this.props.trackMetadata).length > 1) {\n        // ! TODO\n        // latency = await CustomDialog(\n        //   <AlignRecordingModalContent\n        //     recordedURL={recordedURL}\n        //     recordedTrackId={this.state.selectedTrackId}\n        //     trackMetadata={this.props.trackMetadata}\n        //   />,\n        //   {\n        //     title: \"Check Recording\",\n        //     showCloseIcon: true,\n        //   }\n        // );\n        // console.log(\"latency:\", latency);\n      }\n      this.createTake(this.state.selectedTrackId, file, latency); // ! TODO\n      this.setState({ isRecording: false, masterRecord: false });\n      // })\n      // .catch((e) => console.log(e));\n    }\n  }\n\n  async test() {\n    const latency = await CustomDialog(\n      <AlignRecordingModalContent recordedURL={\"test1\"} />,\n      {\n        title: \"Check Recording\",\n        showCloseIcon: true,\n      }\n    );\n    console.log(\"latency:\", latency);\n  }\n\n  // https://codesandbox.io/s/v67oz43lm7?file=/src/index.js\n  async toggleMasterRecord() {\n    console.log(\"> master record\");\n    if (this.state.selectedTrackId === null) {\n      alert(\"Select a track to record!\");\n    } else {\n      console.log(\"recording track \" + this.state.selectedTrackId);\n      // Mp3Recorder.start();\n      await recorder.initAudio();\n      await recorder.initWorker();\n      recorder.startRecording();\n\n      this.setState((state) => {\n        return {\n          masterRecord: true,\n          showCountdown: true,\n          isRecording: true,\n        };\n      });\n    }\n  }\n\n  handleFileUpload = (files, targetId) => {\n    console.log(\"handling file upload\");\n    if (\n      files === null ||\n      files[0] === null ||\n      typeof files[0] === \"undefined\"\n    ) {\n      return;\n    }\n    if (/\\.(mp3|ogg|wav|flac|aac|aiff|m4a)$/i.test(files[0].name)) {\n      console.log(\"> validated file: \", files[0].name);\n      this.createTake(targetId, files[0]);\n    } else {\n      alert(\n        \"Please upload valid audio file type (mp3, ogg, wav, flac, aac, aiff, m4a)\"\n      );\n      return;\n    }\n  };\n\n  setSelectedTrack = (id) => {\n    const newId = id !== null ? id : null;\n    console.log(\"selecting track to record: \" + newId);\n    this.setState({ selectedTrackId: newId });\n  };\n\n  formattedTime = (ms) => {\n    let minutes = Math.floor(ms / 60000);\n    let seconds = ((ms % 60000) / 1000).toFixed(2);\n    return minutes + \":\" + (seconds < 10 ? \"0\" : \"\") + seconds;\n  };\n\n  updateSoloTracks = (trackId) => {\n    let newSoloTracks = [...this.state.soloTracks];\n    let index = newSoloTracks.indexOf(trackId);\n\n    if (index !== -1) {\n      // remove\n      newSoloTracks.splice(index, 1);\n    } else {\n      // add\n      newSoloTracks.push(trackId);\n    }\n    console.log(\"new solo tracks:\", newSoloTracks);\n    this.setState({ soloTracks: newSoloTracks });\n  };\n\n  changeVolume = (value) => {\n    // convert linear 1->100 to log 1->100 via f(n) = 50 * log(n)\n    this.setState({ masterVolume: value / 75 });\n  };\n\n  render() {\n    return (\n      <div>\n        <div>\n          {this.props.trackMetadata &&\n          Object.keys(this.props.trackMetadata).length > 0 ? (\n            Object.keys(this.props.trackMetadata).map((trackId) => {\n              const trackInfo = this.props.trackMetadata[trackId];\n              return (\n                <div key={`track_${trackId}`}>\n                  <div>\n                    <Track\n                      trackName={trackInfo.track_name}\n                      trackId={trackId}\n                      takes={trackInfo.takes}\n                      masterPlay={this.state.masterPlay}\n                      masterStop={this.state.masterStop}\n                      masterRecord={this.state.masterRecord}\n                      selectedTrackId={this.state.selectedTrackId}\n                      setSelectedTrack={this.setSelectedTrack}\n                      deleteTake={this.deleteTake}\n                      soloTracks={this.state.soloTracks}\n                      updateSoloTracks={this.updateSoloTracks}\n                      masterVolume={this.state.masterVolume}\n                      renameTrack={this.renameTrack}\n                      deleteTrack={this.deleteTrack}\n                      handleFileUpload={this.handleFileUpload}\n                    />\n                  </div>\n                  {Object.keys(this.props.trackMetadata[trackId].takes)\n                    .length === 0 && (\n                    <div style={{ marginTop: \"-20px\" }}>\n                      <input\n                        style={{\n                          marginLeft: \"20px\",\n                          marginTop: \"25px\",\n                          marginBottom: \"20px\",\n                        }}\n                        type=\"file\"\n                        onChange={(e) =>\n                          this.handleFileUpload(e.target.files, trackId)\n                        }\n                      />\n                    </div>\n                  )}\n                </div>\n              );\n            })\n          ) : (\n            <div style={{ marginTop: \"10px\" }} />\n          )}\n        </div>\n        <button\n          style={{ marginTop: \"10px\", marginLeft: \"5px\", marginBottom: \"20px\" }}\n          className=\"stitched\"\n          onClick={this.createTrack}\n        >\n          + New Track\n        </button>\n        <p>\n          <b>Master Controls</b>\n        </p>\n        {this.state.isBlocked && (\n          <p> Please allow access to your mic to record!</p>\n        )}\n        {/* TODO: Live Monitoring, Rehearse */}\n        <IconButton\n          disableRipple\n          aria-label=\"Stop\"\n          onClick={this.toggleMasterRecord}\n          disabled={this.state.masterPlay || this.state.isBlocked}\n        >\n          {this.state.masterPlay || this.state.isBlocked ? (\n            <FiberManualRecordRoundedIcon style={{ fontSize: 28 }} />\n          ) : (\n            <FiberManualRecordRoundedIcon\n              style={{ fontSize: 28 }}\n              color=\"secondary\"\n            />\n          )}\n        </IconButton>\n        <IconButton\n          disableRipple\n          aria-label=\"Stop\"\n          onClick={this.toggleMasterStop}\n          disabled={!this.state.masterPlay}\n        >\n          <StopRoundedIcon style={{ fontSize: 35 }} />\n        </IconButton>\n        <IconButton\n          disableRipple\n          aria-label=\"Play\"\n          onClick={this.toggleMasterPlay}\n          disabled={\n            this.state.masterPlay ||\n            Object.keys(this.props.trackMetadata).length === 0\n          }\n          style={{ marginLeft: \"-5px\" }}\n        >\n          <PlayArrowRoundedIcon style={{ fontSize: 35 }} />\n        </IconButton>{\" \"}\n        <button onClick={this.test}>Test</button>{\" \"}\n        {this.formattedTime(this.state.runningTime)}\n        <div\n          style={{\n            position: \"absolute\",\n            marginLeft: \"285px\",\n            marginTop: \"-45px\",\n            width: \"100px\",\n          }}\n        >\n          Volume\n          <Slider\n            min={0}\n            max={100}\n            defaultValue={50}\n            onChange={this.changeVolume}\n          />\n        </div>\n        {this.state.showCountdown && (\n          <div\n            className=\"timer\"\n            style={{\n              position: \"absolute\",\n              marginLeft: \"400px\",\n              marginTop: \"-110px\",\n            }}\n          >\n            <CountdownCircleTimer\n              isPlaying\n              duration={3}\n              colors={[[\"#0f52bd\", 1]]}\n              size={90}\n              onComplete={() => {\n                const startTime = Date.now() - this.state.runningTime;\n                this.timer = setInterval(() => {\n                  this.setState({ runningTime: Date.now() - startTime });\n                });\n                this.setState({ showCountdown: false, masterPlay: true });\n              }}\n            >\n              {({ remainingTime }) => remainingTime}\n            </CountdownCircleTimer>\n            <button\n              onClick={() => {\n                this.setState({\n                  showCountdown: false,\n                });\n                this.toggleMasterStop();\n              }}\n              style={{ marginTop: \"10px\", marginBottom: \"10px\" }}\n            >\n              Ahh I'm not ready!\n            </button>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default DAW;\n","import React, { Component } from \"react\";\nimport DAW from \"./daw/DAW\";\nimport { Prompt, Confirm } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\n\nclass Project extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      project_name: null,\n      group_name: null,\n      project_id: null,\n      track_metadata: null,\n      project_hash: props.location.pathname.split(\"/\").pop(),\n    };\n    if (this.state.project_hash === \"project\") {\n      this.state.project_hash = null;\n    }\n    this.createTrack = this.createTrack.bind(this);\n    this.deleteTrack = this.deleteTrack.bind(this);\n    this.renameTrack = this.renameTrack.bind(this);\n    this.createTake = this.createTake.bind(this);\n    this.deleteTake = this.deleteTake.bind(this);\n  }\n\n  componentDidMount() {\n    this.retrieveProject(this.state.project_hash);\n  }\n\n  componentDidUpdate(prevProps) {\n    const pathname = this.props.location.pathname.split(\"/\").pop();\n    // fetch project if last page was project search page\n    if (\n      pathname !== \"project\" &&\n      pathname !== null &&\n      this.props.location.pathname !== prevProps.location.pathname\n    ) {\n      this.retrieveProject(pathname);\n      // loaded project search page\n    } else if (pathname === \"project\" && this.state.project_hash !== null) {\n      this.setState({\n        project_hash: null,\n        project_name: null,\n        group_name: null,\n        project_id: null,\n        track_metadata: null,\n      });\n    }\n  }\n\n  retrieveProject = (project_hash) => {\n    console.log(\"retrieving project: \" + project_hash);\n    if (project_hash === null || project_hash === \"\") {\n      return;\n    }\n    fetch(\"/api/project?\" + new URLSearchParams({ project_hash: project_hash }))\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        const tracks = obj.body.tracks\n          ? obj.body.tracks.reduce((obj, item) => {\n              const formatted_takes = item[\"takes\"].reduce((obj, item) => {\n                obj[item[\"take\"]] = {\n                  date_uploaded: item[\"date_uploaded\"],\n                  id: item[\"id\"],\n                  s3_info: item[\"s3_info\"],\n                  track_id: item[\"track_id\"],\n                };\n                return obj;\n              }, {});\n              obj[item[\"id\"]] = {\n                takes: formatted_takes,\n                track_name: item[\"track_name\"],\n              };\n              return obj;\n            }, {})\n          : {};\n        if (obj.status === 200) {\n          this.setState({\n            project_hash: project_hash,\n            project_name: obj.body.project_name,\n            group_name: obj.body.group.group_name,\n            project_id: obj.body.id,\n            track_metadata: tracks,\n          });\n        }\n      });\n  };\n\n  async createTrack() {\n    console.log(\"creating new track\");\n    const track_name = await Prompt(\"Name Your Track\");\n    if (track_name) {\n      const formData = new FormData();\n      formData.append(\"track_name\", track_name);\n      formData.append(\"project_id\", this.state.project_id);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n      fetch(\"/api/track\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status !== 400) {\n            console.log(\"added new track\");\n            let updatedTracks = Object.assign({}, this.state.track_metadata);\n            updatedTracks[obj.body.track_id] = {\n              id: parseInt(obj.body.track_id),\n              project_id: this.state.projectId,\n              takes: {},\n              track_name: track_name,\n            };\n            this.setState({ track_metadata: updatedTracks });\n          }\n        });\n    }\n  }\n\n  async renameTrack(id, name) {\n    console.log(\"renaming track\");\n    const new_name = await Prompt(\"Rename Your Track\", {\n      defaultValue: name,\n    });\n    if (new_name) {\n      const formData = new FormData();\n      formData.append(\"track_id\", id);\n      formData.append(\"new_name\", new_name);\n      const requestOptions = {\n        method: \"PUT\",\n        body: formData,\n      };\n      fetch(\"/api/track\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            let updatedTracks = Object.assign({}, this.state.track_metadata);\n            updatedTracks[id].track_name = new_name;\n            this.setState({ track_metadata: updatedTracks });\n          }\n        });\n    }\n  }\n\n  async deleteTrack(id, name) {\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Track\"\n    );\n    if (result) {\n      const formData = new FormData();\n      formData.append(\"track_id\", id);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/track\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedTracks = Object.assign({}, this.state.track_metadata);\n            delete updatedTracks[id];\n            this.setState({ track_metadata: updatedTracks });\n            return true;\n          }\n        });\n    }\n    return false;\n  }\n\n  createTake(track_id, file, latency) {\n    console.log(\"creating new take for\", track_id);\n    const formData = new FormData();\n    formData.append(\"track_id\", track_id);\n    formData.append(\"file\", file);\n    formData.append(\"latency\", latency);\n    formData.append(\"tz_offset\", new Date().getTimezoneOffset() / 60);\n    const requestOptions = {\n      method: \"POST\",\n      body: formData,\n    };\n\n    fetch(\"/api/take\", requestOptions)\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        if (obj.status !== 400) {\n          console.log(\"CREATED TAKE:\", obj);\n          let updatedTracks = Object.assign({}, this.state.track_metadata);\n          updatedTracks[parseInt(track_id)].takes[parseInt(obj.body.take)] = {\n            id: parseInt(obj.body.take_id),\n            track_id: parseInt(track_id),\n            s3_info: obj.body.s3_info,\n            date_uploaded: new Date(obj.body.timestamp).toString(),\n          };\n          this.setState({ track_metadata: updatedTracks });\n        }\n      });\n  }\n\n  deleteTake(track_id, take_number, take_id) {\n    const formData = new FormData();\n    formData.append(\"take_id\", take_id);\n    const requestOptions = {\n      method: \"DELETE\",\n      body: formData,\n    };\n    fetch(\"/api/take\", requestOptions)\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        if (obj.status === 200) {\n          const updatedTracks = Object.assign({}, this.state.track_metadata);\n          delete updatedTracks[track_id].takes[take_number];\n          this.setState({ track_metadata: updatedTracks });\n        }\n      });\n  }\n\n  render() {\n    const pathSuffix = this.props.location.pathname.split(\"/\").pop();\n\n    // show loading screen if have not retrieved data yet\n    if (this.state.project_name === null && pathSuffix !== \"project\") {\n      return <div>Loading...</div>;\n    }\n\n    return (\n      this.state.project_hash &&\n      pathSuffix !== \"project\" &&\n      pathSuffix !== \"\" && (\n        <div>\n          <h2>{this.state.project_name}</h2>\n          <div style={{ marginTop: \"20px\" }}>\n            <DAW\n              trackMetadata={this.state.track_metadata}\n              retrieveProject={this.retrieveProject}\n              createTrack={this.createTrack}\n              deleteTrack={this.deleteTrack}\n              renameTrack={this.renameTrack}\n              createTake={this.createTake}\n              deleteTake={this.deleteTake}\n            />\n          </div>\n        </div>\n      )\n    );\n  }\n}\n\nexport default Project;\n","import React, { useState } from \"react\";\n\n// mimics Zoom's search functionality (i.e. if you enter mit.zoom.us/j/ without any ID)\nfunction ProjectSearch(props) {\n  const [projectId, setProjectId] = useState(\"\");\n\n  const searchProject = (e) => {\n    console.log(\"projectId\", projectId);\n    e.preventDefault();\n    fetch(\"/api/project?\" + new URLSearchParams({ project_hash: projectId }))\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        console.log(obj);\n        if (obj.status === 200) {\n          props.history.push(`/project/${projectId}`);\n        }\n      })\n      .catch(function (err) {\n        alert(\"Cannot find project ID or URL: \" + projectId, err);\n      });\n  };\n\n  const handleChange = (e) => {\n    e.preventDefault();\n    // parse project id out of url\n    if (e.target.value.startsWith(\"http\")) {\n      setProjectId(e.target.value.split(\"/\").pop());\n    } else {\n      setProjectId(e.target.value);\n    }\n  };\n\n  return (\n    <div>\n      <h2>Find a Project</h2>\n      <br></br>\n      <form style={{ marginLeft: 10 }}>\n        <input\n          style={{ width: 250 }}\n          type=\"text\"\n          value={projectId}\n          onChange={handleChange}\n          placeholder=\"Enter Project ID or URL\"\n        ></input>\n        <input type=\"submit\" hidden></input>\n        <button onClick={searchProject}>Go!</button>\n      </form>\n    </div>\n  );\n}\n\nexport default ProjectSearch;\n","import React, { Component } from \"react\";\n\nclass Home extends Component {\n  render() {\n    return (\n      <div>\n        <h2>HOMEPAGE</h2>\n        <p>Login to get started! 🎶</p>\n      </div>\n    );\n  }\n}\n\nexport default Home;\n","import React, { useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\n\nconst RENAME_PROJECT_OPTION = \"Rename Project\";\nconst DELETE_PROJECT_OPTION = \"Delete Project\";\nconst options = [RENAME_PROJECT_OPTION, DELETE_PROJECT_OPTION];\n\nfunction Project(props) {\n  const history = useHistory();\n  const [threeDotsAnchorElement, setThreeDotsAnchorElement] = useState(null);\n\n  const rehearse = () => {\n    history.push({\n      pathname: `/project/${props.project.project_hash}`,\n      state: {\n        project: props.project,\n        group_name: props.group_name,\n        group_id: props.group_id,\n      },\n    });\n  };\n\n  const clickThreeDotsMenu = (e) => {\n    setThreeDotsAnchorElement(e.currentTarget);\n  };\n\n  const closeThreeDotsMenu = (e) => {\n    const option = e.target.innerText;\n    if (option === RENAME_PROJECT_OPTION) {\n      props.renameProject(props.project.id, props.project.project_name);\n    } else if (option === DELETE_PROJECT_OPTION) {\n      props.deleteProject(props.project.id, props.project.project_name);\n    }\n    setThreeDotsAnchorElement(null);\n  };\n\n  return (\n    <li>\n      Project: {props.project.project_name}{\" \"}\n      <button onClick={rehearse}>Rehearse!</button>\n      <IconButton\n        aria-label=\"more\"\n        aria-controls=\"project-menu\"\n        aria-haspopup=\"true\"\n        onClick={clickThreeDotsMenu}\n        style={{ marginLeft: \"5px\" }}\n      >\n        <MoreHorizIcon />\n      </IconButton>\n      <Menu\n        id=\"project-menu\"\n        anchorEl={threeDotsAnchorElement}\n        keepMounted\n        open={threeDotsAnchorElement !== null}\n        onClose={closeThreeDotsMenu}\n        PaperProps={{\n          style: {\n            maxHeight: 40 * 4.5,\n            width: \"20ch\",\n          },\n        }}\n      >\n        {options.map((option) => (\n          <MenuItem key={option} onClick={closeThreeDotsMenu}>\n            {option}\n          </MenuItem>\n        ))}\n      </Menu>\n    </li>\n  );\n}\n\nexport default Project;\n","import React, { Component } from \"react\";\nimport Project from \"./Project\";\nimport \"./Group.css\";\nimport { Prompt, Confirm } from \"react-st-modal\";\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\n\nconst RENAME_GROUP_OPTION = \"Rename Group\";\nconst DELETE_GROUP_OPTION = \"Delete Group\";\nconst options = [RENAME_GROUP_OPTION, DELETE_GROUP_OPTION];\n\nclass Group extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      projects: props.projects,\n      threeDotsAnchorElement: null,\n    };\n    this.createNewProject = this.createNewProject.bind(this);\n    this.deleteProject = this.deleteProject.bind(this);\n    this.renameProject = this.renameProject.bind(this);\n  }\n\n  async createNewProject() {\n    const project_name = await Prompt(\"Name Your Project\");\n    if (project_name) {\n      const formData = new FormData();\n      formData.append(\"project_name\", project_name);\n      formData.append(\"group_id\", this.props.id);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n\n      fetch(\"/api/project\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status !== 400) {\n            this.setState({\n              projects: this.state.projects.concat([\n                {\n                  project_name: project_name,\n                  id: obj.body.project_id,\n                  project_hash: obj.body.project_hash,\n                },\n              ]),\n            });\n          }\n        });\n    }\n  }\n\n  async deleteProject(id, name) {\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Project\"\n    );\n    if (result) {\n      const formData = new FormData();\n      formData.append(\"project_id\", id);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/project\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedProjects = [...this.state.projects].filter(\n              (i) => i.id !== id\n            );\n            this.setState({\n              projects: updatedProjects,\n            });\n          }\n        });\n    }\n  }\n\n  async renameProject(id, name) {\n    const new_name = await Prompt(\"Rename Your Project\", {\n      defaultValue: name,\n    });\n    if (new_name) {\n      const formData = new FormData();\n      formData.append(\"project_id\", id);\n      formData.append(\"new_name\", new_name);\n      const requestOptions = {\n        method: \"PUT\",\n        body: formData,\n      };\n\n      fetch(\"/api/project\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedProjects = [\n              ...this.state.projects,\n            ].map((projectInfo) =>\n              projectInfo.id === id\n                ? { ...projectInfo, project_name: new_name }\n                : projectInfo\n            );\n            this.setState({\n              projects: updatedProjects,\n            });\n          }\n        });\n    }\n  }\n\n  clickThreeDotsMenu = (e) => {\n    this.setState({ threeDotsAnchorElement: e.currentTarget });\n  };\n\n  closeThreeDotsMenu = (e) => {\n    const option = e.target.innerText;\n    if (option === RENAME_GROUP_OPTION) {\n      this.props.renameGroup(this.props.id, this.props.name);\n    } else if (option === DELETE_GROUP_OPTION) {\n      this.props.deleteGroup(this.props.id, this.props.name);\n    }\n    this.setState({ threeDotsAnchorElement: null });\n  };\n\n  render() {\n    return (\n      <div style={{ marginTop: \"-5px\", marginBottom: \"-15px\" }}>\n        <h3>\n          {this.props.name}\n          {\"  \"}\n          <button style={{ marginLeft: \"5px\" }} onClick={this.createNewProject}>\n            + New Project\n          </button>\n          <IconButton\n            aria-label=\"more\"\n            aria-controls=\"group-menu\"\n            aria-haspopup=\"true\"\n            onClick={this.clickThreeDotsMenu}\n            style={{ marginLeft: \"5px\" }}\n          >\n            <MoreHorizIcon />\n          </IconButton>\n          <Menu\n            id=\"group-menu\"\n            anchorEl={this.state.threeDotsAnchorElement}\n            keepMounted\n            open={this.state.threeDotsAnchorElement !== null}\n            onClose={this.closeThreeDotsMenu}\n            PaperProps={{\n              style: {\n                maxHeight: 40 * 4.5,\n                width: \"20ch\",\n              },\n            }}\n          >\n            {options.map((option) => (\n              <MenuItem key={option} onClick={this.closeThreeDotsMenu}>\n                {option}\n              </MenuItem>\n            ))}\n          </Menu>\n        </h3>\n        <div style={{ marginTop: \"-25px\" }}>\n          <ul>\n            {this.state.projects && this.state.projects.length === 0 && (\n              <p className=\"text-muted\" style={{ marginTop: \"25px\" }}>\n                No projects created yet!\n              </p>\n            )}\n            {this.state.projects.map((projectInfo, i) => (\n              <div key={`project_${i}`}>\n                <div style={{ marginTop: \"-20px\", marginBottom: \"-10px\" }}>\n                  <Project\n                    project={projectInfo}\n                    group_name={this.props.name}\n                    group_id={this.props.id}\n                    renameProject={this.renameProject}\n                    deleteProject={this.deleteProject}\n                  />\n                </div>\n              </div>\n            ))}\n          </ul>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Group;\n","import React, { Component } from \"react\";\nimport Group from \"./Group\";\nimport \"./Groups.css\";\nimport { Confirm, Prompt } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\n\nclass Groups extends Component {\n  constructor() {\n    super();\n    this.state = {\n      groups: [],\n      isLoaded: false,\n    };\n    this.fetchGroups();\n    this.createNewGroup = this.createNewGroup.bind(this);\n    this.deleteGroup = this.deleteGroup.bind(this);\n    this.renameGroup = this.renameGroup.bind(this);\n  }\n\n  componentDidUpdate() {\n    if (!this.state.isLoaded) {\n      this.fetchGroups();\n    }\n  }\n\n  fetchGroups() {\n    fetch(\"/api/groups\", {\n      method: \"GET\",\n    })\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((res) => {\n        if (res.status !== 400) {\n          this.setState({ groups: res.body, isLoaded: true });\n        }\n      });\n  }\n\n  async createNewGroup() {\n    console.log(\"creating new group!\");\n    const group_name = await Prompt(\"Name Your Group\");\n    if (group_name) {\n      const formData = new FormData();\n      formData.append(\"group_name\", group_name);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status !== 400) {\n            this.setState({\n              groups: this.state.groups.concat([\n                { group_name: group_name, id: obj.body.group_id, projects: [] },\n              ]),\n            });\n          }\n        });\n    }\n  }\n\n  async deleteGroup(id, name) {\n    console.log(\"deleting group\");\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Group\"\n    );\n    if (result) {\n      const formData = new FormData();\n      formData.append(\"group_id\", id);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedGroups = [...this.state.groups].filter(\n              (i) => i.id !== id\n            );\n            this.setState({\n              groups: updatedGroups,\n            });\n          }\n        });\n    }\n  }\n\n  async renameGroup(id, name) {\n    console.log(\"renaming group\");\n    const new_name = await Prompt(\"Rename Your Group\", {\n      defaultValue: name,\n    });\n    if (new_name) {\n      const formData = new FormData();\n      formData.append(\"new_name\", new_name);\n      formData.append(\"group_id\", id);\n      const requestOptions = {\n        method: \"PUT\",\n        body: formData,\n      };\n\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedGroups = [...this.state.groups].map((groupInfo) =>\n              groupInfo.id === id\n                ? { ...groupInfo, group_name: new_name }\n                : groupInfo\n            );\n            this.setState({\n              groups: updatedGroups,\n            });\n          }\n        });\n    }\n  }\n\n  render() {\n    if (!this.state.isLoaded) {\n      return <div>Loading...</div>;\n    }\n    return (\n      <div>\n        <h2>REHEARSAL GROUPS</h2>\n        {this.state.groups &&\n          this.state.groups.map((groupInfo, i) => (\n            <div key={`group_${i}`}>\n              <Group\n                id={groupInfo.id}\n                name={groupInfo.group_name}\n                projects={groupInfo.projects}\n                renameGroup={this.renameGroup}\n                deleteGroup={this.deleteGroup}\n              />\n            </div>\n          ))}\n        <button className=\"stitched\" onClick={this.createNewGroup}>\n          + New Group\n        </button>\n      </div>\n    );\n  }\n}\n\nexport default Groups;\n","import React, { useState } from \"react\";\nimport { Jutsu } from \"react-jutsu\";\n\n// https://github.com/this-fifo/jutsu\nexport const EmbeddedJitsi = () => {\n  const [displayName, setDisplayName] = useState(\"\");\n  const [roomName, setRoomName] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [onCall, setOnCall] = useState(false);\n\n  const handleClick = (event) => {\n    event.preventDefault();\n    if (roomName && displayName) setOnCall(true);\n  };\n\n  return (\n    <div>\n      <h2>Jitsi</h2>\n      <br />\n      {onCall ? (\n        <Jutsu\n          containerStyles={{ width: \"800px\", height: \"400px\" }}\n          roomName={roomName}\n          displayName={displayName}\n          password={password}\n          onMeetingEnd={() => console.log(\"Meeting has ended\")}\n          loadingComponent={<p>Loading ...</p>}\n          errorComponent={<p>Oops, something went wrong</p>}\n        />\n      ) : (\n        <form>\n          <p>Create a Room</p>\n          <input\n            id=\"room\"\n            type=\"text\"\n            placeholder=\"Room Name\"\n            value={roomName}\n            onChange={(e) => setRoomName(e.target.value)}\n          />\n          <input\n            id=\"name\"\n            type=\"text\"\n            placeholder=\"Name\"\n            value={displayName}\n            onChange={(e) => setDisplayName(e.target.value)}\n          />\n          <input\n            id=\"password\"\n            type=\"text\"\n            placeholder=\"Password (optional)\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n          />\n          <button onClick={handleClick} type=\"submit\">\n            Start / Join\n          </button>\n        </form>\n      )}\n    </div>\n  );\n};\n","import { Mp3Encoder } from \"lamejs\";\n\nclass Encoder {\n  constructor(config) {\n    this.config = {\n      sampleRate: 44100,\n      bitRate: 128,\n    };\n\n    Object.assign(this.config, config);\n\n    this.mp3Encoder = new Mp3Encoder(\n      1,\n      this.config.sampleRate,\n      this.config.bitRate\n    );\n\n    // Audio is processed by frames of 1152 samples per audio channel\n    // http://lame.sourceforge.net/tech-FAQ.txt\n    this.maxSamples = 1152;\n\n    this.samplesMono = null;\n    this.clearBuffer();\n  }\n\n  /**\n   * Clear active buffer\n   */\n  clearBuffer() {\n    this.dataBuffer = [];\n  }\n\n  /**\n   * Append new audio buffer to current active buffer\n   * @param {Buffer} buffer\n   */\n  appendToBuffer(buffer) {\n    this.dataBuffer.push(new Int8Array(buffer));\n  }\n\n  /**\n   * Float current data to 16 bits PCM\n   * @param {Float32Array} input\n   * @param {Int16Array} output\n   */\n  floatTo16BitPCM(input, output) {\n    for (let i = 0; i < input.length; i++) {\n      const s = Math.max(-1, Math.min(1, input[i]));\n      output[i] = s < 0 ? s * 0x8000 : s * 0x7fff;\n    }\n  }\n\n  /**\n   * Convert buffer to proper format\n   * @param {Array} arrayBuffer\n   */\n  convertBuffer(arrayBuffer) {\n    const data = new Float32Array(arrayBuffer);\n    const out = new Int16Array(arrayBuffer.length);\n    this.floatTo16BitPCM(data, out);\n\n    return out;\n  }\n\n  /**\n   * Encode and append current buffer to dataBuffer\n   * @param {Array} arrayBuffer\n   */\n  encode(arrayBuffer) {\n    this.samplesMono = this.convertBuffer(arrayBuffer);\n    let remaining = this.samplesMono.length;\n\n    for (let i = 0; remaining >= 0; i += this.maxSamples) {\n      const left = this.samplesMono.subarray(i, i + this.maxSamples);\n      const mp3buffer = this.mp3Encoder.encodeBuffer(left);\n      this.appendToBuffer(mp3buffer);\n      remaining -= this.maxSamples;\n    }\n  }\n\n  /**\n   * Return full dataBuffer\n   */\n  finish() {\n    this.appendToBuffer(this.mp3Encoder.flush());\n\n    return this.dataBuffer;\n  }\n}\n\nexport default Encoder;\n","import React, { Component } from \"react\";\nimport MicRecorder from \"./MicRecorder\";\n\nconst audioType = \"audio/mp3\";\nconst Mp3Recorder = new MicRecorder({ bitRate: 128 });\n\nclass WebAudio extends Component {\n  constructor() {\n    super();\n    this.state = {\n      recording: false,\n      recordings: [],\n    };\n    // this.clearBuffer();\n  }\n\n  // componentDidMount() {\n  //   navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {\n  //     this.mediaRecorder = new MediaRecorder(stream);\n  //     this.chunks = [];\n  //     this.mediaRecorder.ondataavailable = (e) => {\n  //       if (e.data && e.data.size > 0) {\n  //         this.chunks.push(e.data);\n  //       }\n  //     };\n  //   });\n  // }\n\n  // /**\n  //  * Clear active buffer\n  //  */\n  // clearBuffer = () => {\n  //   this.chunks = [];\n  // };\n\n  handleRecord = () => {\n    console.log(\"recording now\");\n    // wipe old data chunks\n    // this.chunks = [];\n    // start recorder with 10ms buffer\n    // this.mediaRecorder.start(10);\n    Mp3Recorder.start();\n    this.setState({ recording: true });\n  };\n\n  handleStopRecord = () => {\n    console.log(\"stopped now\");\n    // stop the recorder\n    // this.mediaRecorder.stop();\n    Mp3Recorder.stop()\n      .getMp3()\n      .then(([buffer, blob]) => {\n        // const file = new File(\n        //   [blob],\n        //   `recording_track_${this.state.selectedTrackId}.mp3`\n        // );\n        // const latency = 220; // in ms\n        // this.createTake(this.state.selectedTrackId, file, latency);\n        const blobURL = URL.createObjectURL(blob);\n        console.log(blobURL);\n        // append videoURL to list of saved videos for rendering\n        const recordings = this.state.recordings.concat([blobURL]);\n        // this.setState({ recordings });\n        this.setState({ recording: false, recordings });\n      })\n      .catch((e) => console.log(e));\n    // save audio to memory\n    // this.saveAudio();\n  };\n\n  convertBuffer = () => {\n    // const data = new Float32Array(this.chunks);\n    // const out = new Int16Array(this.chunks.length);\n    // // float to 16 bits PCM\n    // for (let i = 0; i < data.length; i++) {\n    //   const s = Math.max(-1, Math.min(1, data[i]));\n    //   out[i] = s < 0 ? s * 0x8000 : s * 0x7fff;\n    // }\n    // return out;\n  };\n\n  saveAudio() {\n    // this.samplesMono = this.convertBuffer();\n    // console.log(this.chunks.length);\n    // console.log(this.samplesMono.length);\n    // // encode to mp3\n    // let mp3Data = [];\n    // for (var i = 0; i < this.chunks.length; i += sampleBlockSize) {\n    //   let sampleChunk = this.chunks.subarray(i, i + sampleBlockSize);\n    //   let mp3buf = this.mp3encoder.encodeBuffer(sampleChunk);\n    //   if (mp3buf.length > 0) {\n    //     mp3Data.push(mp3buf);\n    //   }\n    // }\n    // let mp3buf = this.mp3encoder.flush();\n\n    // if (mp3buf.length > 0) {\n    //   mp3Data.push(new Int8Array(mp3buf));\n    // }\n\n    // convert saved chunks to blob\n    const blob = new Blob(this.chunks, { type: audioType });\n    console.log(blob);\n    // generate video url from blob\n    const blobURL = URL.createObjectURL(blob);\n    console.log(blobURL);\n    // append videoURL to list of saved videos for rendering\n    const recordings = this.state.recordings.concat([blobURL]);\n    this.setState({ recordings });\n  }\n\n  deleteRecording(blobURL) {\n    // filter out current videoURL from the list of saved videos\n    const recordings = this.state.recordings.filter((a) => a !== blobURL);\n    this.setState({ recordings });\n  }\n\n  render() {\n    return (\n      <div>\n        <div>\n          <p>test mic with web audio</p>\n          <button disabled={this.state.recording} onClick={this.handleRecord}>\n            record\n          </button>\n          <button\n            disabled={!this.state.recording}\n            onClick={this.handleStopRecord}\n          >\n            stop\n          </button>\n        </div>\n        <div>\n          <p>Recordings:</p>\n          {this.state.recordings.map((blobURL, i) => (\n            <div key={`recording_${i}`}>\n              <audio controls style={{ width: 300 }} src={blobURL} />\n              <div>\n                <button onClick={() => this.deleteRecording(blobURL)}>\n                  Delete\n                </button>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default WebAudio;\n","import Encoder from \"./Encoder\";\n\nclass MicRecorder {\n  constructor(config) {\n    this.mediaRecorder = null;\n    this.mediaChunks = [];\n    this.mediaStream = null;\n    // this.config = {\n    //   // 128 or 160 kbit/s – mid-range bitrate quality\n    //   bitRate: 160,\n    //   startRecordingAt: 0,\n    //   deviceId: null,\n    // };\n    // this.activeStream = null;\n    // this.context = null;\n    // this.microphone = null;\n    // this.processor = null;\n    // this.startTime = 0;\n    // Object.assign(this.config, config);\n  }\n\n  componentDidMount() {}\n\n  getMediaStream = () => {};\n\n  /**\n   * Starts to listen for the microphone sound\n   * @param {MediaStream} stream\n   */\n  addMicrophoneListener(stream) {\n    this.activeStream = stream;\n\n    // This prevents the weird noise once you start listening to the microphone\n    // this.timerToStart = setTimeout(() => {\n    //   delete this.timerToStart;\n    // }, this.config.startRecordingAt);\n\n    // Set up Web Audio API to process data from the media stream (microphone).\n    this.microphone = this.context.createMediaStreamSource(stream);\n\n    // Settings a bufferSize of 0 instructs the browser to choose the best bufferSize\n    this.processor = this.context.createScriptProcessor(0, 1, 1);\n\n    // Add all buffers from LAME into an array.\n    this.processor.onaudioprocess = (event) => {\n      // if (this.timerToStart) {\n      //   return;\n      // }\n\n      // Send microphone data to LAME for MP3 encoding while recording.\n      this.lameEncoder.encode(event.inputBuffer.getChannelData(0));\n    };\n\n    // Begin retrieving microphone data.\n    this.microphone.connect(this.processor);\n    this.processor.connect(this.context.destination);\n  }\n\n  /**\n   * Disconnect microphone, processor and remove activeStream\n   */\n  stop() {\n    if (this.processor && this.microphone) {\n      // Clean up the Web Audio API resources.\n      this.microphone.disconnect();\n      this.processor.disconnect();\n\n      // If all references using this.context are destroyed, context is closed\n      // automatically. DOMException is fired when trying to close again\n      if (this.context && this.context.state !== \"closed\") {\n        this.context.close();\n      }\n\n      this.processor.onaudioprocess = null;\n\n      // Stop all audio tracks. Also, removes recording icon from chrome tab\n      this.activeStream.getAudioTracks().forEach((track) => track.stop());\n    }\n\n    return this;\n  }\n\n  /**\n   * Requests access to the microphone and start recording\n   * @return Promise\n   */\n  start() {\n    this.context = new AudioContext();\n    this.config.sampleRate = this.context.sampleRate;\n    this.lameEncoder = new Encoder(this.config);\n\n    const audio = this.config.deviceId\n      ? { deviceId: { exact: this.config.deviceId } }\n      : true;\n\n    // return new Promise((resolve, reject) => {\n    navigator.mediaDevices.getUserMedia({ audio }).then((stream) => {\n      this.addMicrophoneListener(stream);\n      // resolve(stream);\n    });\n    // .catch(function (err) {\n    //   reject(err);\n    // });\n    // });\n  }\n\n  /**\n   * Return Mp3 Buffer and Blob with type mp3\n   * @return {Promise}\n   */\n  getMp3() {\n    const finalBuffer = this.lameEncoder.finish();\n\n    return new Promise((resolve, reject) => {\n      if (finalBuffer.length === 0) {\n        reject(new Error(\"No buffer to send\"));\n      } else {\n        resolve([finalBuffer, new Blob(finalBuffer, { type: \"audio/mp3\" })]);\n        this.lameEncoder.clearBuffer();\n      }\n    });\n  }\n}\n\nexport default MicRecorder;\n","import React from \"react\";\nimport { Route, Redirect } from \"react-router-dom\";\n\nfunction PrivateRoute({ component: Component, authed, ...rest }) {\n  return (\n    <Route\n      {...rest}\n      render={(props) => authed === true\n        ? <Component {...props} />\n        : <Redirect to={{ pathname: '/', state: { from: props.location } }} />\n      }\n    />\n  )\n}\n\nexport default PrivateRoute;","import React, { Component } from \"react\";\nimport { HashRouter, NavLink, Route } from \"react-router-dom\";\nimport { Redirect } from \"react-router\";\nimport { createHashHistory } from \"history\";\n\n// import Footer from \"./components/Footer\";\nimport Login from \"./components/Login\";\nimport Logout from \"./components/Logout\";\nimport Project from \"./routes/project/Project\";\nimport ProjectSearch from \"./routes/project/ProjectSearch\";\nimport Home from \"./routes/home/Home\";\nimport Groups from \"./routes/groups/Groups\";\nimport { EmbeddedJitsi } from \"./routes/temp-jitsi/EmbeddedJitsi\"; // temp\nimport WebAudio from \"./routes/temp-webaudio/WebAudio\"; // temp\n\nimport PrivateRoute from \"./utils/components/PrivateRoute\";\n\nconst history = createHashHistory();\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.state = {\n      userDetails: {},\n      isUserLoggedIn: false,\n    };\n  }\n\n  componentDidMount() {\n    let userDetails = JSON.parse(localStorage.getItem(\"userDetails\"));\n    let isUserLoggedIn = localStorage.getItem(\"isUserLoggedIn\") === \"true\";\n    if (isUserLoggedIn && !this.state.isUserLoggedIn) {\n      this.setState({\n        userDetails: userDetails,\n        isUserLoggedIn: isUserLoggedIn,\n      });\n    }\n  }\n\n  handleSuccessfulLogin = (response) => {\n    const userDetails = response.profileObj;\n    const formData = new FormData();\n    formData.append(\"google_auth_id\", userDetails.googleId);\n    formData.append(\"google_email\", userDetails.email);\n    formData.append(\"user_name\", userDetails.name);\n    const requestOptions = {\n      method: \"POST\",\n      body: formData,\n    };\n\n    fetch(\"/auth/login\", requestOptions)\n      .then((resp) => resp.json())\n      .then((res) => {\n        console.log(res.message);\n      });\n\n    localStorage.setItem(\"userDetails\", JSON.stringify(userDetails));\n    localStorage.setItem(\"isUserLoggedIn\", true);\n    this.setState({ userDetails: userDetails, isUserLoggedIn: true });\n  };\n\n  handleSuccessfulLogout = () => {\n    fetch(\"/auth/logout\", { method: \"POST\" })\n      .then((resp) => resp.json())\n      .then((res) => {\n        console.log(res.message);\n      });\n    localStorage.clear();\n    this.setState({ userDetails: {}, isUserLoggedIn: false });\n  };\n\n  render() {\n    // default to groups page if no history, otherwise go to last page before refresh\n    let pathname = history.location.pathname;\n    if (this.state.isUserLoggedIn && history.location.pathname === \"/\") {\n      pathname = \"/groups\";\n    }\n    return (\n      <HashRouter history={history}>\n        <div>\n          <h1>JamNSync</h1>\n          <div style={{ position: \"absolute\", right: 20, top: 35 }}>\n            {!this.state.isUserLoggedIn && (\n              <Login onSuccessfulLogin={this.handleSuccessfulLogin} />\n            )}\n            {this.state.isUserLoggedIn && (\n              <div style={{ display: \"flex\" }}>\n                <div>\n                  <p>Welcome, {this.state.userDetails.givenName}!</p>\n                </div>\n                <div style={{ marginLeft: \"5px\" }}>\n                  <Logout onSuccessfulLogout={this.handleSuccessfulLogout} />\n                </div>\n              </div>\n            )}\n          </div>\n\n          <ul className=\"header\">\n            {!this.state.isUserLoggedIn && (\n              <li>\n                <NavLink exact to=\"/\">\n                  Home\n                </NavLink>\n              </li>\n            )}\n            {this.state.isUserLoggedIn && (\n              <li>\n                <NavLink to=\"/groups\">Groups</NavLink>\n              </li>\n            )}\n            {this.state.isUserLoggedIn && (\n              <li>\n                <NavLink to=\"/project\">Project</NavLink>\n              </li>\n            )}\n          </ul>\n\n          <div className=\"content\">\n            <Route exact path=\"/\">\n              {this.state.isUserLoggedIn && pathname !== \"/\" ? (\n                <Redirect to={pathname} />\n              ) : (\n                <Home />\n              )}\n            </Route>\n            <PrivateRoute\n              path=\"/groups\"\n              component={Groups}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              exact\n              path={\"/project\"}\n              component={ProjectSearch}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              path=\"/project/\"\n              component={Project}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              path=\"/jitsi\"\n              component={EmbeddedJitsi}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              path=\"/webaudio\"\n              component={WebAudio}\n              authed={this.state.isUserLoggedIn}\n            />\n          </div>\n\n          {/* <Footer /> */}\n        </div>\n      </HashRouter>\n    );\n  }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(\n  <App />,\n  document.getElementById(\"root\")\n);"],"sourceRoot":""}