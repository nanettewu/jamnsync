{"version":3,"sources":["components/Login.js","utils/refreshToken.js","components/Logout.js","routes/project/daw/Track.js","routes/project/daw/LoadingGif.js","routes/project/daw/AlignRecording.js","routes/project/daw/DAW.js","routes/project/Project.js","routes/home/Home.js","routes/projects/Project.js","routes/projects/Group.js","routes/projects/Projects.js","routes/groups/Member.js","routes/groups/AddMemberModal.js","routes/groups/Group.js","routes/groups/Groups.js","utils/components/PrivateRoute.js","App.js","index.js"],"names":["Login","props","clientId","process","buttonText","onSuccess","res","refreshTiming","tokenObj","expires_in","refreshToken","a","reloadAuthResponse","newAuthRes","console","log","localStorage","setItem","id_token","setTimeout","refreshTokenSetup","onSuccessfulLogin","onFailure","alert","error","cookiePolicy","style","marginTop","isSignedIn","Logout","onLogoutSuccess","onSuccessfulLogout","FILE_UPLOAD_OPTION","RENAME_TRACK_OPTION","DELETE_TRACK_OPTION","options","Track","stop","audioFile","currentTime","pause","setState","playing","changeVolume","value","volume","masterVolume","seek","state","play","fastForward","duration","currentSeek","forwardTo","rewind","backwardTo","mute","updateMutedTracks","trackId","muted","solo","updateSoloTracks","soloing","selectToRecord","updatedTrackId","selected","setSelectedTrack","_onSelect","option","label","url","takes","s3_info","selectedTake","s3URL","document","getElementById","clickThreeDotsMenu","e","threeDotsAnchorElement","currentTarget","closeThreeDotsMenu","target","innerText","click","renameTrack","trackName","deleteTrack","latestTake","Object","keys","length","latestKey","pop","deleteTake","bind","this","prevProps","selectedTrackId","masterPlay","masterRecord","masterStop","soloTracks","Math","min","targetTake","takeInfo","d","lastIndexOf","Date","substr","formattedDateTime","toLocaleString","name","Confirm","id","newSelectedTake","takeCopy","splice","indexOf","max","apply","newURL","selectedKeyValue","takeDropdownOptions","reduce","acc","take","parseInt","rawDate","push","reverse","buttonSelectText","marginLeft","display","src","alt","width","height","title","onClick","IconButton","aria-label","aria-controls","aria-haspopup","type","hidden","onChange","handleFileUpload","files","Menu","anchorEl","keepMounted","open","onClose","PaperProps","maxHeight","map","MenuItem","marginBottom","Tooltip","arrow","disableRipple","fontSize","color","marginRight","defaultValue","preload","autobuffer","position","placeholder","method","action","disabled","Component","LoadingGif","text","AlignRecordingModalContent","dialog","useDialog","useState","isPlaying","setPlaying","playbackTimer","setPlaybackTimer","delayPlaybackTimer","setDelayPlaybackTimer","bgWaveSurfer","setBgWaveSurfer","recWaveSurfer","setRecWaveSurfer","loadedAudio","setLoadedAudio","setMixedBackingTrackURL","dragOffset","setDragOffset","latencyMagnitude","setLatencyMagnitude","onStopDrag","useCallback","_","x","latency","useEffect","WaveSurfer","create","container","waveColor","progressColor","cursorColor","cursorWidth","interact","hideScrollbar","isOpen","crunker","Crunker","nonRecordedTrackURLs","trackMetadata","filter","recordedTrackId","mutedTracks","includes","takeId","audio_url","fetchAudio","then","buffers","mergeAudio","merged","export","output","load","recordedURL","setVolume","zoom","className","axis","bounds","left","right","onStop","clearTimeout","close","params","scrollParent","seekTo","seekAndCenter","getDuration","round","AudioContext","window","webkitAudioContext","WebAudioRecorder","DAW","beginGroupPlayListener","toggleMasterPlay","requestingGroupPlayback","preparedGroupAction","beginGroupStopListener","data","projectName","receivedImmediateStop","toggleMasterStop","username","JSON","parse","getItem","stopped_by","beginGroupRecordListener","toggleMasterRecord","requestingGroupRecord","updateNumPreparedListener","numGroupMembersPrepared","num_prepared","numGroupMembersTotal","num_total","notifyWaitingGroupMember","requester","requestGroupPlay","requestGroupRecord","createTrack","createTake","track_id","file","is_manual_upload","take_number","take_id","startTime","now","runningTime","timer","setInterval","startMicrophone","audioContext","navigator","mediaDevices","getUserMedia","audio","stream","gumStream","input","createMediaStreamSource","recorder","workerDir","encoding","numChannels","setOptions","timeLimit","encodeAfterRecord","mp3","bitRate","onComplete","blob","getAudioTracks","stopMicrophone","startRecording","targetId","test","newId","formattedTime","ms","minutes","floor","seconds","toFixed","newSoloTracks","index","newMutedTracks","rehearse","isRehearsing","downloadMixedTrack","latestTakeURLs","link","createElement","href","datestring","getFullYear","getMonth","getDate","timestring","getHours","getMinutes","outputFilename","setAttribute","body","appendChild","parentNode","removeChild","socket","emit","channel","projectHash","shouldPlay","requestGroupStop","user","shouldRecord","cancelRequest","createAnnotation","event","keyCode","isRecording","isBlocked","showCountdown","initialLoad","stopMicProcessing","catch","on","addEventListener","off","removeEventListener","clearInterval","finishRecording","File","URL","createObjectURL","CustomDialog","showCloseIcon","isCanClose","otherMembersOnline","numOnlineUsers","trackInfo","track_name","claimedTracks","colors","size","remainingTime","Project","updateOnlineUsersListener","user_list","onlineUsers","updateProjectListener","refresh","retrieveProject","project_hash","fetch","URLSearchParams","resp","json","status","obj","tracks","item","formatted_takes","date_uploaded","project_name","group_name","group","project_id","track_metadata","location","pathname","split","isCreatingTake","isDeletingTakeOrTrack","userDetails","Prompt","formData","FormData","append","updatedTracks","assign","projectId","new_name","getTimezoneOffset","timestamp","toString","pathSuffix","placement","i","Home","authed","RENAME_PROJECT_OPTION","DELETE_PROJECT_OPTION","history","useHistory","setThreeDotsAnchorElement","renameProject","project","deleteProject","group_id","Group","renameGroup","deleteGroup","projects","createNewProject","concat","updatedProjects","projectInfo","sortedProjects","sort","b","Projects","updateProjectsListener","fetchGroups","groups","isLoaded","class","groupInfo","Member","removeMember","hideRemoveButton","onlyMemberInGroup","AddMemberModalContent","newUserId","setNewUserId","newUserName","setNewUserName","userDropdownOptions","users","userid","RENAME_GROUP_OPTION","DELETE_GROUP_OPTION","group_membership","addMember","all_users","undefined","newMemberInfo","newUsername","updatedMembership","Groups","updateGroupsListener","createNewGroup","updatedGroups","PrivateRoute","component","rest","render","to","from","io","ROOT_URL","createHashHistory","App","handleSuccessfulLogin","response","profileObj","googleId","email","message","stringify","isUserLoggedIn","handleSuccessfulLogout","clear","replace","prevState","top","givenName","exact","path","ReactDOM"],"mappings":"uZAkCeA,MA3Bf,SAAeC,GAYb,OACE,8BACE,cAAC,cAAD,CACEC,SAAUC,2EACVC,WAAW,QACXC,UAhBY,SAACC,ICNY,SAACA,GAEhC,IAAIC,EAA6D,KAA5CD,EAAIE,SAASC,YAAc,MAE1CC,EAAY,uCAAG,4BAAAC,EAAA,sEACML,EAAIM,qBADV,OACbC,EADa,OAEnBN,EAA2D,KAA1CM,EAAWJ,YAAc,MAC1CK,QAAQC,IAAI,cAAeF,GAE3BG,aAAaC,QAAQ,YAAaJ,EAAWK,UAG7CC,WAAWT,EAAcH,GARN,2CAAH,qDAYlBY,WAAWT,EAAcH,GDRvBa,CAAkBd,GAClBL,EAAMoB,kBAAkBf,IAcpBgB,UAXY,SAAChB,GACjBQ,QAAQC,IAAI,kCAAmCT,GAC/CiB,MAAM,gBAAkBjB,EAAIkB,MAAQ,OAUhCC,aAAc,qBACdC,MAAO,CAAEC,UAAW,SACpBC,YAAY,OEPLC,MAlBf,SAAgB5B,GAOd,OACE,8BACE,cAAC,eAAD,CACEC,SAAUC,2EACVC,WAAW,SACX0B,gBAXY,WAGhB7B,EAAM8B,2B,wKCSJC,EAAqB,gBACrBC,EAAsB,eACtBC,EAAsB,eAEtBC,EAAU,CAACH,EAAoBC,EAAqBC,GAmgB3CE,E,kDAhgBb,WAAYnC,GAAQ,IAAD,EAcjB,GAdiB,qBACjB,cAAMA,IA+JRoC,KAAO,WACL,EAAKC,UAAUC,YAAc,EAC7B,EAAKD,UAAUE,QACf,EAAKC,SAAS,CAAEC,SAAS,KAnKR,EAsKnBC,aAAe,SAACC,GACd,IAAMC,EAASD,EACf,EAAKN,UAAUO,OAAU,EAAK5C,MAAM6C,aAAe,IAAOD,EAC1D,EAAKJ,SAAS,CAAEI,OAAQA,KAzKP,EA4KnBE,KAAO,SAACH,GACN,EAAKN,UAAUC,YAAcK,EAC7B,EAAKN,UAAUE,QACX,EAAKQ,MAAMN,SACb,EAAKJ,UAAUW,QAhLA,EAoLnBC,YAAc,WACZ,EAAKZ,UAAUE,QACf,IAAMW,EAAW,EAAKb,UAAUa,WAC1BC,EAAc,EAAKd,UAAUC,YAC7Bc,EAAYD,EAAc,EAChC,GAAIC,GAAaF,EAGf,OAFA,EAAKb,UAAUC,YAAc,OAC7B,EAAKD,UAAUE,QAGjB1B,QAAQC,IAAI,OAASqC,EAAc,OAASC,GAC5C,EAAKf,UAAUC,YAAcc,EACzB,EAAKL,MAAMN,SACb,EAAKJ,UAAUW,QAjMA,EAqMnBK,OAAS,WACP,EAAKhB,UAAUE,QACf,IAAMY,EAAc,EAAKd,UAAUC,YAC/BgB,EAAaH,EAAc,EAC3BG,GAAc,IAChBA,EAAa,GAEfzC,QAAQC,IAAI,WAAaqC,EAAc,OAASG,GAChD,EAAKjB,UAAUC,YAAcgB,EACzB,EAAKP,MAAMN,SACb,EAAKJ,UAAUW,QA/MA,EAmNnBO,KAAO,WACL,EAAKvD,MAAMwD,kBAAkB,EAAKxD,MAAMyD,SACxC,EAAKpB,UAAUqB,OAAS,EAAKX,MAAMW,MACnC,EAAKlB,SAAS,CACZkB,OAAQ,EAAKX,MAAMW,SAvNJ,EA2NnBC,KAAO,WACL,EAAK3D,MAAM4D,iBAAiB,EAAK5D,MAAMyD,SAClC,EAAKV,MAAMc,QAOd,EAAKrB,SAAS,CACZqB,SAAS,KAPX,EAAKxB,UAAUqB,OAAQ,EACvB,EAAKlB,SAAS,CACZqB,SAAS,EACTH,OAAO,MAjOM,EA0OnBI,eAAiB,WACf,IAAMC,EAAkB,EAAKhB,MAAMiB,SAAgC,KAArB,EAAKhE,MAAMyD,QACzD,EAAKzD,MAAMiE,iBAAiBF,GAC5B,EAAKvB,SAAS,CAAEwB,UAAW,EAAKjB,MAAMiB,YA7OrB,EAgPnBE,UAAY,SAACC,GACXtD,QAAQC,IAAI,YAAcqD,EAAOC,OACjC,EAAK/B,UAAUC,YAAc,EAC7B,EAAKD,UAAUE,QACf,IAAM8B,EAAM,EAAKrE,MAAMsE,MAAMH,EAAOxB,OAAO4B,QAC3C,EAAK/B,SAAS,CACZC,SAAS,EACT+B,aAAcL,EAAOxB,MACrB8B,MAAOJ,IAET,EAAKhC,UAAYqC,SAASC,eAAT,qBACD,EAAK3E,MAAMyD,WA3PV,EAoTnBmB,mBAAqB,SAACC,GACpB,EAAKrC,SAAS,CAAEsC,uBAAwBD,EAAEE,iBArTzB,EAwTnBC,mBAAqB,SAACH,GACpB,IAAMV,EAASU,EAAEI,OAAOC,UACpBf,IAAWpC,EACb2C,SAASC,eAAT,sBAAuC,EAAK3E,MAAMyD,UAAW0B,QACpDhB,IAAWnC,EACpB,EAAKhC,MAAMoF,YAAY,EAAKpF,MAAMyD,QAAS,EAAKzD,MAAMqF,WAC7ClB,IAAWlC,GACpB,EAAKjC,MAAMsF,YAAY,EAAKtF,MAAMyD,QAAS,EAAKzD,MAAMqF,WAExD,EAAK7C,SAAS,CAAEsC,uBAAwB,QA/TxC,EAAK/B,MAAQ,CACXiB,UAAU,EACVvB,SAAS,EACTiB,OAAO,EACPe,MAAO,KACPD,aAAc,KACde,WAAY,EACZ1B,SAAS,EACTjB,OAAQ,MACRkC,uBAAwB,MAE1B,EAAKzC,UAAY,KACuB,IAApCmD,OAAOC,KAAKzF,EAAMsE,OAAOoB,OAAc,CACzC,IAAMC,EAAYH,OAAOC,KAAKzF,EAAMsE,OAAOsB,MACrCvB,EAAMrE,EAAMsE,MAAMqB,GAAWpB,QAC/BF,IACF,EAAKtB,MAAM0B,MAAQJ,EACnB,EAAKtB,MAAMyB,aAAemB,EAC1B,EAAKtD,UAAYqC,SAASC,eAAT,qBACD,EAAK3E,MAAMyD,WArBd,OAyBjB,EAAKoC,WAAa,EAAKA,WAAWC,KAAhB,gBAzBD,E,gEA8BjB,GAA6C,IAAzCN,OAAOC,KAAKM,KAAK/F,MAAMsE,OAAOoB,OAAc,CAC9C,IAAMC,EAAYH,OAAOC,KAAKM,KAAK/F,MAAMsE,OAAOsB,MAC1CvB,EAAM0B,KAAK/F,MAAMsE,MAAMqB,GAAWpB,QACpCF,IACF0B,KAAKvD,SAAS,CACZiC,MAAOJ,EACPG,aAAcmB,EACdJ,WAAYI,IAEdI,KAAK1D,UAAYqC,SAASC,eAAT,qBACDoB,KAAK/F,MAAMyD,gBAK7BsC,KAAKvD,SAAS,CACZgC,aAAc,KACdC,MAAO,KACPc,WAAY,M,yCAKCS,GAmBjB,GAjBID,KAAKhD,MAAM0B,OAA4B,OAAnBsB,KAAK1D,UAC3B0D,KAAK1D,UAAYqC,SAASC,eAAT,qBACDoB,KAAK/F,MAAMyD,UAEG,OAArBsC,KAAKhD,MAAM0B,OAAqC,OAAnBsB,KAAK1D,YAC3C0D,KAAK1D,UAAY,MAKjB0D,KAAKhD,MAAMiB,UACX+B,KAAK/F,MAAMiG,kBAAoBF,KAAK/F,MAAMyD,SAE1CsC,KAAKvD,SAAS,CAAEwB,UAAU,IAKG,OAA5B+B,KAAKhD,MAAMyB,cACVuB,KAAKhD,MAAMwC,aAAeC,OAAOC,KAAKM,KAAK/F,MAAMsE,OAAOsB,OACjB,IAAzCJ,OAAOC,KAAKM,KAAK/F,MAAMsE,OAAOoB,OAWoB,IAAzCF,OAAOC,KAAKM,KAAK/F,MAAMsE,OAAOoB,QAAgBK,KAAKhD,MAAM0B,OAClEsB,KAAKvD,SAAS,CACZgC,aAAc,KACdC,MAAO,KACPc,WAAY,QAdd,CACA,IAAMI,EAAYH,OAAOC,KAAKM,KAAK/F,MAAMsE,OAAOsB,MAC1CvB,EAAM0B,KAAK/F,MAAMsE,MAAMqB,GAAWpB,QACpCF,GACF0B,KAAKvD,SAAS,CACZ+C,WAAYI,EACZnB,aAAcmB,EACdlB,MAAOJ,IAaX0B,KAAK/F,MAAMkG,YACXH,KAAK1D,YACJ0D,KAAKhD,MAAMN,WACVsD,KAAKhD,MAAMiB,UACV+B,KAAKhD,MAAMiB,WAAa+B,KAAK/F,MAAMmG,eAEtCtF,QAAQC,IAAR,kBACaiF,KAAK/F,MAAMqF,UADxB,sBAC+CU,KAAKhD,MAAM0B,QAE1DsB,KAAK1D,UAAUC,YAAc,EAC7ByD,KAAK1D,UAAUW,OACf+C,KAAKvD,SAAS,CAAEC,SAAS,KAChBsD,KAAK/F,MAAMoG,YAAcL,KAAK1D,WAAa0D,KAAKhD,MAAMN,UAC/DsD,KAAK1D,UAAUE,QACfwD,KAAKvD,SAAS,CAAEC,SAAS,KAKxBsD,KAAKhD,MAAMc,SACqB,IAAjCkC,KAAK/F,MAAMqG,WAAWX,QACrBK,KAAKhD,MAAMW,QACZqC,KAAKhD,MAAM0B,MAOsB,IAAjCsB,KAAK/F,MAAMqG,WAAWX,QACtBK,KAAKhD,MAAMW,OACXqC,KAAKhD,MAAM0B,OACqB,IAAhCuB,EAAUK,WAAWX,SAErBK,KAAK1D,UAAUqB,OAAQ,EACvBqC,KAAKvD,SAAS,CACZkB,OAAO,MAZTqC,KAAK1D,UAAUqB,OAAQ,EACvBqC,KAAKvD,SAAS,CACZkB,OAAO,KAeTqC,KAAKhD,MAAM0B,OACXuB,EAAUnD,eAAiBkD,KAAK/F,MAAM6C,eAEtCkD,KAAK1D,UAAUO,OAAS0D,KAAKC,IAAI,EAAGR,KAAK/F,MAAM6C,iB,6CAK7CkD,KAAK1D,WACP0D,KAAK1D,UAAUE,U,wKA8GjB1B,QAAQC,IAAI,iBACN0F,EAAaT,KAAKhD,MAAMyB,aACxBiC,EAAWV,KAAK/F,MAAMsE,MAAMkC,GAGhCE,GADkD,IAAhDD,EAAQ,cAAkBE,YAAY,KACpC,IAAIC,KACNH,EAAQ,cAAkBI,OACxB,EACAJ,EAAQ,cAAkBE,YAAY,KAAO,IAI7C,IAAIC,KAAKH,EAAQ,eAEjBK,EAAoBJ,EAAEK,eAAe,SAErCC,E,eAAeR,E,cAAgBM,G,SAChBG,YAAQ,oCAAD,OACUD,EADV,MAE1B,e,0CAGIjB,KAAK1D,YACP0D,KAAK1D,UAAUC,YAAc,EAC7ByD,KAAK1D,UAAUE,S,UAEXwD,KAAK/F,MAAM6F,WAAWE,KAAK/F,MAAMyD,QAAS+C,EAAYC,EAASS,I,QAEjEC,EAAkB,KAClB3B,OAAOC,KAAKM,KAAK/F,MAAMsE,OAAOoB,OAAS,IACnC0B,EAAW5B,OAAOC,KAAKM,KAAK/F,MAAMsE,QAC/B+C,OAAOD,EAASE,QAAQd,GAAa,GAC9CW,EAAkBb,KAAKiB,IAAIC,MAAMlB,KAAMc,GACjCK,EAAS1B,KAAK/F,MAAMsE,MAAM6C,GAAiB5C,QACjDwB,KAAKvD,SAAS,CACZC,SAAS,EACT+B,aAAc2C,EACd1C,MAAOgD,EACPlC,WAAY4B,MAGdtG,QAAQC,IAAI,wBACZiF,KAAKvD,SAAS,CACZC,SAAS,EACT+B,aAAc2C,EACd1C,MAAO,KACPc,WAAY,K,sIAsBV,IAAD,OACHmC,EAAmB,CAAE/E,MAAOoD,KAAKhD,MAAMyB,cACrCmD,EAAsBnC,OAAOC,KAAKM,KAAK/F,MAAMsE,OAChDsD,QAAO,SAACC,EAAKC,GACZ,GAAIC,SAASD,IAASC,SAAS,EAAKhF,MAAMwC,YAAa,CACrD,IAAMyC,EAAU,EAAKhI,MAAMsE,MAAMwD,GAAjB,cAEVhB,EADI,IAAIF,KAAKoB,GACSjB,eAAe,SACvCe,IAAS,EAAK/E,MAAMyB,eACtBkD,EAAgB,MAAhB,eAAoCI,EAApC,cAA8ChB,IAEhDe,EAAII,KAAK,CACPtF,MAAOmF,EACP1D,MAAM,QAAD,OAAU0D,EAAV,cAAoBhB,KAG7B,OAAOe,IACN,IACFK,UAEGC,EAAmBpC,KAAKhD,MAAMiB,SAChC,WACA,mBAEJ,OACE,sBAAKvC,MAAO,CAAE2G,WAAY,OAA1B,UACE,uBACA,gCACGrC,KAAKhD,MAAMiB,SACV,sBAAKvC,MAAO,CAAE4G,QAAS,gBAAvB,UACE,qBACEC,IAAI,0BACJC,IAAI,WACJC,MAAM,KACNC,OAAO,OACN,IACH,wCAAW1C,KAAK/F,MAAMqF,aAAe,OAGvC,sBAAK5D,MAAO,CAAE4G,QAAS,gBAAvB,oBACUtC,KAAK/F,MAAMqF,UAAW,OAGlC,wBACEqD,MAAM,sCACNC,QAAS5C,KAAKjC,eACdrC,MAAO,CAAE2G,WAAY,OAHvB,SAKGD,IAEH,cAACS,EAAA,EAAD,CACEC,aAAW,OACXC,gBAAc,aACdC,gBAAc,OACdJ,QAAS5C,KAAKnB,mBACdnD,MAAO,CAAE2G,WAAY,OALvB,SAOE,cAAC,IAAD,MAEF,uBACEY,KAAK,OACL9B,GAAE,sBAAiBnB,KAAK/F,MAAMyD,SAC9BwF,QAAM,EACNC,SAAU,SAACrE,GACT,EAAK7E,MAAMmJ,iBAAiBtE,EAAEI,OAAOmE,MAAO,EAAKpJ,MAAMyD,YAG3D,cAAC4F,EAAA,EAAD,CACEnC,GAAG,aACHoC,SAAUvD,KAAKhD,MAAM+B,uBACrByE,aAAW,EACXC,KAA4C,OAAtCzD,KAAKhD,MAAM+B,uBACjB2E,QAAS1D,KAAKf,mBACd0E,WAAY,CACVjI,MAAO,CACLkI,UAAW,IACXnB,MAAO,SATb,SAaGtG,EAAQ0H,KAAI,SAACzF,GAAD,OACX,cAAC0F,EAAA,EAAD,CAAuBlB,QAAS,EAAK3D,mBAArC,SACGb,GADYA,WAMpB4B,KAAKhD,MAAM0B,OAASe,OAAOC,KAAKM,KAAK/F,MAAMsE,OAAOoB,OAAS,GAC1D,sBAAKjE,MAAO,CAAEqI,aAAc,OAAQpI,UAAW,SAA/C,UACE,cAACqI,EAAA,EAAD,CAASrB,MAAM,OAAOsB,OAAK,EAA3B,SACE,cAACpB,EAAA,EAAD,CACEqB,eAAa,EACbpB,aAAW,kBACXF,QAAS5C,KAAKxC,KACd9B,MAAO,CAAEC,UAAW,OAJtB,SAMGqE,KAAKhD,MAAMW,MACV,cAAC,IAAD,CACEjC,MAAO,CAAEyI,SAAU,IACnBC,MAAM,cAGR,cAAC,IAAD,CAAsB1I,MAAO,CAAEyI,SAAU,UAI/C,cAACH,EAAA,EAAD,CAASrB,MAAM,OAAOsB,OAAK,EAA3B,SACE,cAACpB,EAAA,EAAD,CACEqB,eAAa,EACbpB,aAAW,kBACXF,QAAS5C,KAAKpC,KACdlC,MAAO,CAAEC,UAAW,OAJtB,SAMGqE,KAAKhD,MAAMc,QACV,cAAC,IAAD,CACEpC,MAAO,CAAEyI,SAAU,IACnBC,MAAM,cAGR,cAAC,IAAD,CAAoB1I,MAAO,CAAEyI,SAAU,UAI7C,sBACEzI,MAAO,CACL4G,QAAS,eACTD,WAAY,OACZgC,YAAa,OACb5B,MAAO,QALX,mBASE,cAAC,IAAD,CACEjC,IAAK,EACLgB,IAAK,IACL8C,aAAc,IACdnB,SAAUnD,KAAKrD,kBAInB,uBACEwE,GAAE,qBAAgBnB,KAAK/F,MAAMyD,SAC7B6E,IAAG,UAAKvC,KAAKhD,MAAM0B,MAAhB,oBACH6F,QAAQ,OACRC,WAAW,SAGb,qBACE9I,MAAO,CACL2G,WAAY,OACZ1G,UAAW,OACX2G,QAAS,cACTmC,SAAU,WACVhC,MAAO,KANX,SASE,cAAC,IAAD,CACEtG,QAASyF,EACTuB,SAAUnD,KAAK7B,UACfvB,MAAO+E,EACP+C,YAAY,uBAGhB,sBACEhJ,MAAO,CACL4G,QAAS,cACTmC,SAAU,WACVpC,WAAY,QACZ1G,UAAW,QALf,UAQE,sBAAMgJ,OAAO,MAAMC,OAAM,UAAK5E,KAAKhD,MAAM0B,MAAhB,oBAAzB,SACE,wBAAQuE,KAAK,SAAb,6BAEF,wBACE4B,SAAU7E,KAAK/F,MAAMkG,WACrByC,QAAS5C,KAAKF,WAFhB,sC,GAnfMgF,aCELC,E,uKApBX,OACE,sBAAKrJ,MAAO,CAAE4G,QAAS,OAAQyB,aAAc,QAA7C,UACE,qBACErI,MAAO,CACL2G,WAAY,OACZgC,YAAa,MACb1I,UAAW,QAEb4G,IAAI,yBACJC,IAAI,UACJC,MAAM,KACNC,OAAO,OAGT,uCAAQ1C,KAAK/F,MAAM+K,e,GAhBFF,a,6ECYV,SAASG,EAA2BhL,GACjD,IAAMiL,EAASC,cADyC,EAGxBC,oBAAS,GAHe,mBAGjDC,EAHiD,KAGtCC,EAHsC,OAIdF,mBAAS,MAJK,mBAIjDG,EAJiD,KAIlCC,EAJkC,OAKJJ,mBAAS,MALL,mBAKjDK,EALiD,KAK7BC,EAL6B,OAMhBN,mBAAS,MANO,mBAMjDO,EANiD,KAMnCC,EANmC,OAOdR,mBAAS,MAPK,mBAOjDS,EAPiD,KAOlCC,EAPkC,OAQlBV,oBAAS,GARS,mBAQjDW,EARiD,KAQpCC,EARoC,OASAZ,mBAAS,MATT,mBAS3Ba,GAT2B,aAWpBb,mBAAS,GAXW,mBAWjDc,EAXiD,KAWrCC,EAXqC,OAYRf,mBAAS,GAZD,mBAYjDgB,EAZiD,KAY/BC,EAZ+B,KAclDC,EAAaC,uBAAY,SAACC,EAAG/B,GACjC3J,QAAQC,IAAI,WAAY0J,EAASgC,GACjC,IAAMC,EAAU,QAAUjC,EAASgC,EAAI,OACvC3L,QAAQC,IAAI2L,GACZP,EAAc1B,EAASgC,GACvBJ,EAAoBK,KACnB,IAyGH,OAvGAC,qBAAU,WACRf,EACEgB,IAAWC,OAAO,CAChBC,UAAW,eACXC,UAAW,UACXC,cAAe,UACfC,YAAa,UACbC,YAAa,EACbxE,OAAQ,IACRD,MAAO,IACP0E,UAAU,EACVC,eAAe,KAGnBtB,EACEc,IAAWC,OAAO,CAChBC,UAAW,gBACXC,UAAW,UACXC,cAAe,UACfC,YAAa,UACbC,YAAa,EACbxE,OAAQ,IACRD,MAAO,IACP0E,UAAU,EACVC,eAAe,OAGlB,IAEHT,qBAAU,WACJhB,GAAgBE,GAAiBX,IAAWA,EAAOmC,SACrD1B,EAAatJ,OACbwJ,EAAcxJ,UAEf,CAACsJ,EAAcE,EAAeE,EAAab,IAE9CyB,qBAAU,WACR,GAAIhB,GAAgBE,IAAkBE,EAAa,CACjD,IAAMuB,EAAU,IAAIC,IAChBC,EAAuB/H,OAAOC,KAAKzF,EAAMwN,eAC1CC,QAAO,SAAChK,GAEP,OACEA,IAAYzD,EAAM0N,kBACjB1N,EAAM2N,YAAYC,SAASnK,IAC5B+B,OAAOC,KAAKzF,EAAMwN,cAAc/J,GAASa,OAAOoB,OAAS,KAG5DkE,KAAI,SAACnG,GAEJ,IAAMoK,EAASrI,OAAOC,KAAKzF,EAAMwN,cAAc/J,GAASa,OAAOsB,MACzDkI,EACJ9N,EAAMwN,cAAc/J,GAASa,MAAMuJ,GAAQtJ,QAC3C,mBAEF,OADA1D,QAAQC,IAAI,aAAegN,GACpBA,KAEXjN,QAAQC,IACN,qDACEyM,EAAqB7H,QAGrB6H,EAAqB7H,OAAS,GAChC7E,QAAQC,IAAI,uCACZuM,EACGU,WADH,MAAAV,EAAO,YACUE,IACdS,MAAK,SAACC,GAEL,OAAOZ,EAAQa,WAAWD,MAE3BD,MAAK,SAACG,GAEL,OAAOd,EAAQe,OAAOD,EAAQ,gBAE/BH,MAAK,SAACK,GAELrC,EAAwBqC,EAAOhK,KAC/BqH,EAAa4C,KAAKD,EAAOhK,KACzBuH,EAAc0C,KAAKtO,EAAMuO,aAEzB7C,EAAa8C,UAAU,IACvB5C,EAAc4C,UAAU,IAExB9C,EAAa+C,KAAK,IAClB7C,EAAc6C,KAAK,IACnB1C,GAAe,QAGnBlL,QAAQC,IAAI,uCACZkL,EAAwBuB,EAAqB,IAC7C7B,EAAa4C,KAAKf,EAAqB,IACvC3B,EAAc0C,KAAKtO,EAAMuO,aAEzB7C,EAAa8C,UAAU,IACvB5C,EAAc4C,UAAU,IAExB9C,EAAa+C,KAAK,IAClB7C,EAAc6C,KAAK,IACnB1C,GAAe,OAGlB,CAACL,EAAcE,EAAeE,EAAa9L,IAG5C,qBAAK0O,UAAU,WAAf,SACE,gCACE,cAAC,IAAD,CAAWC,KAAK,IAAIC,OAAQ,CAAEC,MAAO,IAAKC,MAAO,KAAjD,SACE,sBAAKJ,UAAU,SAAf,UACE,qBAAKA,UAAU,UACf,qBAAKA,UAAU,mBAGnB,eAAC,IAAD,WACI5C,EAGA,6HAFA,cAAC,EAAD,CAAYf,KAAM,gCAOpB,4BACE,iDAEF,qBAAK7D,GAAG,gBACR,4BACE,4CAEF,cAAC,IAAD,CAAWyH,KAAK,IAAII,OAAQ1C,EAA5B,SACE,qBAAKnF,GAAG,eAAezF,MAAO,CAAE2G,WAAY,iBAGhD,eAAC,IAAD,WAwBE,cAAC,IAAD,CACEO,QAAO,sBAAE,sBAAAjI,EAAA,6DAEPgL,EAAatJ,OACbwJ,EAAcxJ,OACd4M,aAAa1D,GAJN,SAKcrE,YAAQ,iDAE3B,mBAPK,gBAULpG,QAAQC,IAAI,uBACZmK,EAAOgE,MAAM,UAXR,2CAcTjG,KAAM,SAfR,6BAmBA,cAAC,IAAD,CACEL,QAAS,WACP,GAAIyC,EACFM,EAAanJ,QACbqJ,EAAcrJ,QACdyM,aAAa1D,GACb0D,aAAaxD,QAUb,GARA3K,QAAQC,IAAI,UAAWmL,GAEvBP,EAAawD,OAAOC,cAAe,EACnCvD,EAAcsD,OAAOC,cAAe,EAEpCzD,EAAa0D,OAAO,GACpBxD,EAAcyD,cAAc,EAAIzD,EAAc0D,eAE1CrD,EAAa,EACfpL,QAAQC,IAAI,kDACZD,QAAQC,IAAIqL,GACZZ,EACErK,YAAW,WACTmK,GAAW,KACV,MAELK,EAAa1I,KAAK,KAAM,GACxByI,EACEvK,YAAW,WACT0K,EAAc5I,KAAK,EAAG,GAAKmJ,EAAmB,OAC7CA,SAEA,GAAIF,EAAa,EAAG,CACzBpL,QAAQC,IACN,mDAEF,IAAM2L,GAAWN,EACjBtL,QAAQC,IAAI2L,GACZlB,EACErK,YAAW,WACTmK,GAAW,KACV,MAELK,EAAa1I,KAAK,KAAM,GACxB4I,EAAc5I,KAAK,EAAIyJ,EAAU,IAAM,GAAKA,EAAU,UAEtDlB,EACErK,YAAW,WACTmK,GAAW,KACV,MAELK,EAAa1I,KAAK,KAAM,GACxB4I,EAAc5I,KAAK,EAAG,IAG1BqI,GAAYD,IArDhB,SAwDIA,EAAqB,OAAT,SAEhB,cAAC,IAAD,CACEzC,QAAS,WAEP+C,EAAatJ,OACbwJ,EAAcxJ,OACd4M,aAAa1D,GACbzK,QAAQC,IAAI,mBAAoBqL,GAChClB,EAAOgE,MAAM3I,KAAKiJ,MAAMpD,KAP5B,4B,kFCzPJqD,GAAeC,OAAOD,cAAgBC,OAAOC,mBAC7CC,GAAmBF,OAAOE,iBAC1BtC,GAAU,IAAIC,IA6xBLsC,G,kDA1xBb,aAAe,IAAD,8BACZ,gBAkCFC,uBAAyB,WACvBhP,QAAQC,IAAI,0CACZ,EAAKgP,mBACL,EAAKtN,SAAS,CACZuN,yBAAyB,EACzBC,oBAAqB,QAxCX,EA4CdC,uBAAyB,SAACC,GAIxB,GAHArP,QAAQC,IACN,8CAAgD,EAAKd,MAAMmQ,cAExD,EAAKpN,MAAMqN,sBAAuB,CACrC,EAAK5N,SAAS,CAAE4N,uBAAuB,IACvC,EAAKC,mBACL,IAAMC,EAAWC,KAAKC,MAAMzP,aAAa0P,QAAQ,gBAAgBzJ,KAClC,kBAApBkJ,EAAKQ,YAA2BR,EAAKQ,aAAeJ,GAC7DhP,MAAM,GAAD,OAAI4O,EAAKQ,WAAT,gBArDG,EA0DdC,yBAA2B,WACzB9P,QAAQC,IAAI,4CACZ,EAAK8P,qBACL,EAAKpO,SAAS,CAAEqO,uBAAuB,EAAOb,oBAAqB,QA7DvD,EAgEdc,0BAA4B,SAACZ,GAC3BrP,QAAQC,IAAI,yDACZ,EAAK0B,SAAS,CACZuO,wBAAyBb,EAAKc,aAC9BC,qBAAsBf,EAAKgB,UAC3BlB,oBAAqBE,EAAKvF,UArEhB,EAyEdwG,yBAzEc,uCAyEa,WAAOjB,GAAP,SAAAxP,EAAA,6DACzBG,QAAQC,IACN,kDACEoP,EAAKkB,UACL,eACAlB,EAAKvF,QALgB,SAOC1D,YAAQ,GAAD,OAC5BiJ,EAAKkB,UADuB,2BACKlB,EAAKvF,OADV,oBAE/B,mBACA,MACA,MAXuB,eAcvB9J,QAAQC,IAAR,wCAA6CoP,EAAKvF,OAAlD,MACoB,SAAhBuF,EAAKvF,OACP,EAAK0G,mBAEL,EAAKC,uBAGPzQ,QAAQC,IAAR,4CAAiDoP,EAAKvF,OAAtD,QACA,EAAKnI,SAAS,CAAEwN,oBAAqBE,EAAKvF,UAtBnB,2CAzEb,wDAoKd4G,YAAc,WACZ,EAAKvR,MAAMuR,eArKC,EAwKdnM,YAAc,SAAC8B,EAAIF,GACjB,EAAKhH,MAAMoF,YAAY8B,EAAIF,IAzKf,EA4Kd1B,YAAc,SAAC4B,EAAIF,GACQ,EAAKhH,MAAMsF,YAAY4B,EAAIF,IAElD,EAAKxE,SAAS,CAAEyD,gBAAiB,QA/KvB,EAqLduL,WAAa,SAACC,EAAUC,EAAMC,GAAmC,IAAjBlF,EAAgB,uDAAN,EACxD,EAAKzM,MAAMwR,WAAWC,EAAUC,EAAMC,EAAkBlF,IAtL5C,EAyLd5G,WAAa,SAAC4L,EAAUG,EAAaC,GACnC,EAAK7R,MAAM6F,WAAW4L,EAAUG,EAAaC,IA1LjC,EA+Ld/B,iBAAmB,WACjBjP,QAAQC,IAAI,iBACR,EAAKiC,MAAMmD,YAGf,EAAK1D,UAAS,SAACO,GACb,IAAM+O,EAAYlL,KAAKmL,MAAQ,EAAKhP,MAAMiP,YAI1C,OAHA,EAAKC,MAAQC,aAAY,WACvB,EAAK1P,SAAS,CAAEwP,YAAapL,KAAKmL,MAAQD,OAErC,CAAE5L,YAAY,OAzMX,EAwPdiM,gBAAkB,WAChBtR,QAAQC,IAAI,gCACZ,EAAKsR,aAAe,IAAI5C,GACxB6C,UAAUC,aAAaC,aAAa,CAAEC,OAAO,IAAQxE,MAAK,SAACyE,GACzD5R,QAAQC,IACN,wFAEF,EAAK4R,UAAYD,EAGjB,EAAKE,MAAQ,EAAKP,aAAaQ,wBAAwBH,GAEvD,EAAKI,SAAW,IAAIlD,GAAiB,EAAKgD,MAAO,CAC/CG,UAAW,MACXC,SAAU,MACVC,YAAa,IAGf,EAAKH,SAASI,WAAW,CACvBC,UAAW,IACXC,mBAAmB,EACnBC,IAAK,CAAEC,QAAS,OAGlB,EAAKR,SAASS,WAAd,uCAA2B,WAAOT,EAAUU,GAAjB,SAAA7S,EAAA,6DACzBG,QAAQC,IAAI,iCACZ,EAAK4R,UAAUc,iBAAiB,GAAGpR,OAFV,SAGnB,EAAKqR,eAAeF,GAHD,2CAA3B,oCAAAxN,KAAA,eAMA,EAAK8M,SAASa,qBAtRJ,EAyUdvK,iBAAmB,SAACC,EAAOuK,GAEzB,GADA9S,QAAQC,IAAI,2CAA4C6S,GAE5C,OAAVvK,GACa,OAAbA,EAAM,IACc,qBAAbA,EAAM,GAIf,GAAI,sCAAsCwK,KAAKxK,EAAM,GAAGpC,MAAxD,CACEnG,QAAQC,IAAI,qBAAsBsI,EAAM,GAAGpC,MAE3C,EAAKwK,WAAWmC,EAAUvK,EAAM,IADT,QAGvB9H,MACE,8EAxVQ,EA8Vd2C,iBAAmB,SAACiD,GAClB,IAAM2M,EAAe,OAAP3M,EAAcA,EAAK,KACjCrG,QAAQC,IAAI,8BAAgC+S,GAC5C,EAAKrR,SAAS,CAAEyD,gBAAiB4N,KAjWrB,EAoWdC,cAAgB,SAACC,GACf,IAAIC,EAAU1N,KAAK2N,MAAMF,EAAK,KAC1BG,GAAYH,EAAK,IAAS,KAAMI,QAAQ,GAC5C,OAAOH,EAAU,KAAOE,EAAU,GAAK,IAAM,IAAMA,GAvWvC,EA0WdtQ,iBAAmB,SAACH,GAClB,IAAI2Q,EAAa,YAAO,EAAKrR,MAAMsD,YAC/BgO,EAAQD,EAAc9M,QAAQ7D,IAEnB,IAAX4Q,EAEFD,EAAc/M,OAAOgN,EAAO,GAG5BD,EAAcnM,KAAKxE,GAErB5C,QAAQC,IAAI,mBAAoBsT,GAChC,EAAK5R,SAAS,CAAE6D,WAAY+N,KAtXhB,EAyXd5Q,kBAAoB,SAACC,GACnB,IAAI6Q,EAAc,YAAO,EAAKvR,MAAM4K,aAChC0G,EAAQC,EAAehN,QAAQ7D,IAEpB,IAAX4Q,EAEFC,EAAejN,OAAOgN,EAAO,GAG7BC,EAAerM,KAAKxE,GAEtB5C,QAAQC,IAAI,oBAAqBwT,GACjC,EAAK9R,SAAS,CAAEmL,YAAa2G,KArYjB,EAwYd5R,aAAe,SAACC,GACd,EAAKH,SAAS,CAAEK,aAAcF,EAAQ,OAzY1B,EA4Yd4R,SAAW,WACT1T,QAAQC,IAAI,wBAAyB,EAAKiC,MAAMyR,cAChD,EAAKhS,SAAS,CACZgS,cAAe,EAAKzR,MAAMyR,gBA/YhB,EAmZdC,mBAAqB,WACnB5T,QAAQC,IAAI,qBACZ,IAAI4T,EAAiBlP,OAAOC,KAAK,EAAKzF,MAAMwN,eACzCC,QAAO,SAAChK,GAGP,OAAoB,IAFH+B,OAAOC,KAAK,EAAKzF,MAAMwN,cAAc/J,GAASa,OAC5DoB,UAGJkE,KAAI,SAACnG,GACJ,IAAMa,EAAQ,EAAKtE,MAAMwN,cAAc/J,GAASa,MAC1CuJ,EAASrI,OAAOC,KAAKnB,GAAOsB,MAElC,OADA/E,QAAQC,IAAI+M,GACLvJ,EAAMuJ,GAAQtJ,QAAU,sBAEnC1D,QAAQC,IAAI4T,GACZrH,GACGU,WADH,MAAAV,GAAO,YACUqH,IACd1G,MAAK,SAACC,GACL,OAAOZ,GAAQa,WAAWD,MAE3BD,MAAK,SAACG,GACL,OAAOd,GAAQe,OAAOD,EAAQ,gBAE/BH,MAAK,SAACK,GAEL,IAAMsG,EAAOjQ,SAASkQ,cAAc,KACpCD,EAAKE,KAAOxG,EAAOhK,IACnB,IAAMqC,EAAI,IAAIE,KACRkO,EAAU,UAAMpO,EAAEqO,cAAR,YACdrO,EAAEsO,WAAa,EADD,YAEZtO,EAAEuO,WACAC,EAAU,UAAMxO,EAAEyO,WAAR,YAAsBzO,EAAE0O,aAAxB,YAAwC1O,EAAEuO,UAA1C,YACdvO,EAAEyO,YAAc,GAAK,KAAO,MAExBE,EAAc,UAAM,EAAKrV,MAAMmQ,YAAjB,YAAgC2E,EAAhC,YAA8CI,GAClEP,EAAKW,aAAa,WAAYD,GAE9B3Q,SAAS6Q,KAAKC,YAAYb,GAC1BA,EAAKxP,QACLwP,EAAKc,WAAWC,YAAYf,OA1bpB,EA8bdtD,iBAAmB,WACjBxQ,QAAQC,IAAI,qCACZ6U,GAAOC,KACL,qBACA,CACEC,QAAS,EAAK7V,MAAM8V,cAEtB,SAACC,GACKA,EACF,EAAKjG,mBAEL,EAAKtN,SAAS,CACZuN,yBAAyB,EACzBC,oBAAqB,aA3cjB,EAkddgG,iBAAmB,WACjBnV,QAAQC,IAAI,4CACZ,IAAMwP,EAAWC,KAAKC,MAAMzP,aAAa0P,QAAQ,gBAAgBzJ,KACjE2O,GAAOC,KAAK,uBAAwB,CAClCC,QAAS,EAAK7V,MAAM8V,YACpBG,KAAM3F,KAvdI,EA6ddgB,mBAAqB,WACnBzQ,QAAQC,IAAI,oCACuB,OAA/B,EAAKiC,MAAMkD,gBACb3E,MAAM,kDAENqU,GAAOC,KACL,uBACA,CACEC,QAAS,EAAK7V,MAAM8V,cAEtB,SAACI,GACKA,EACF,EAAKtF,qBAEL,EAAKpO,SAAS,CACZqO,uBAAuB,EACvBb,oBAAqB,eA7enB,EAqfdmG,cAAgB,WACdtV,QAAQC,IAAI,sCACZ6U,GAAOC,KAAK,iBAAkB,CAAEC,QAAS,EAAK7V,MAAM8V,cAAe,WACjE,EAAKtT,SAAS,CACZuN,yBAAyB,EACzBc,uBAAuB,EACvBb,oBAAqB,WA3fb,EAogBdoG,iBAAmB,SAACC,GACI,KAAlBA,EAAMC,SAAkB,EAAKvT,MAAMmD,YACrCrF,QAAQC,IACN,mBAAqB,EAAKgT,cAAc,EAAK/Q,MAAMiP,eArgBvD,EAAKjP,MAAQ,CACXmD,YAAY,EACZE,YAAY,EACZD,cAAc,EACdoQ,aAAa,EACbtQ,gBAAiB,KACjBuQ,WAAW,EACXC,eAAe,EACfzE,YAAa,EACbrE,YAAa,GACbtH,WAAY,GACZxD,aAAc,GACd6T,aAAa,EACblC,cAAc,EACdmC,mBAAmB,EACnB9F,uBAAuB,EACvBd,yBAAyB,EACzBK,uBAAuB,EACvBW,wBAAyB,EACzBE,qBAAsB,EACtBjB,oBAAqB,MAEvB,EAAKoC,aAAe,KACpB,EAAKM,UAAY,KACjB,EAAKC,MAAQ,KACb,EAAKE,SAAW,KAChB,EAAKjC,mBAAqB,EAAKA,mBAAmB9K,KAAxB,gBAC1B,EAAKuK,iBAAmB,EAAKA,iBAAiBvK,KAAtB,gBACxB,EAAK2N,eAAiB,EAAKA,eAAe3N,KAApB,gBA9BV,E,gEAqGO,IAAD,OAClBuM,UAAUC,aACPC,aAAa,CAAEC,OAAO,IACtBxE,MAAK,WACJnN,QAAQC,IAAI,0BACZ,EAAK0B,SAAS,CAAEgU,WAAW,OAE5BI,OAAM,WACL/V,QAAQC,IAAI,yBACZ,EAAK0B,SAAS,CAAEgU,WAAW,OAG/BzQ,KAAKvD,SAAS,CACZ+T,aAAa,EACbpQ,cAAc,EACdF,gBAAiB,KACjBI,WAAY,GACZsH,YAAa,KAIf9M,QAAQC,IAAR,sBACiBiF,KAAK/F,MAAMmQ,YAD5B,8BAGAwF,GAAOkB,GAAG,iBAAkB9Q,KAAK8J,wBACjC8F,GAAOkB,GAAG,iBAAkB9Q,KAAKkK,wBACjC0F,GAAOkB,GAAG,mBAAoB9Q,KAAK4K,0BACnCgF,GAAOkB,GAAG,oBAAqB9Q,KAAK+K,2BACpC6E,GAAOkB,GAAG,2BAA4B9Q,KAAKoL,0BAC3CzM,SAAS6Q,KAAKuB,iBAAiB,WAAY/Q,KAAKqQ,oB,2CAI5CrQ,KAAKhD,MAAM2T,cACwC,IAAjDlR,OAAOC,KAAKM,KAAK/F,MAAMwN,eAAe9H,QACxCK,KAAKwL,cAEPxL,KAAKvD,SAAS,CAAEkU,aAAa,KAE3B3Q,KAAKhD,MAAMmD,YAAcH,KAAKhD,MAAMqD,YACtCL,KAAKvD,SAAS,CACZ0D,YAAY,EACZE,YAAY,EACZ4L,YAAa,M,6CAOjBnR,QAAQC,IAAR,sBACiBiF,KAAK/F,MAAMmQ,YAD5B,8BAGAwF,GAAOoB,IAAI,iBAAkBhR,KAAK8J,wBAClC8F,GAAOoB,IAAI,iBAAkBhR,KAAKkK,wBAClC0F,GAAOoB,IAAI,mBAAoBhR,KAAK4K,0BACpCgF,GAAOoB,IAAI,oBAAqBhR,KAAK+K,2BACrC6E,GAAOoB,IAAI,2BAA4BhR,KAAKoL,0BAC5CzM,SAAS6Q,KAAKyB,oBAAoB,WAAYjR,KAAKqQ,oB,yCA+CnDvV,QAAQC,IAAI,iBACZmW,cAAclR,KAAKkM,OACdlM,KAAKhD,MAAMmD,aAGXH,KAAKhD,MAAMwT,aAOdxQ,KAAKvD,SAAS,CACZ4D,YAAY,EACZ4L,YAAa,EACb2E,mBAAmB,EACnBvG,uBAAuB,IAGzBrK,KAAK2M,UAAUc,iBAAiB,GAAGpR,OACnC2D,KAAK8M,SAASqE,mBAddnR,KAAKvD,SAAS,CACZ4D,YAAY,EACZ4L,YAAa,EACb5B,uBAAuB,O,qJAiB3BvP,QAAQC,IAAI,mBACuB,OAA/BiF,KAAKhD,MAAMkD,gBACb3E,MAAM,8BAENT,QAAQC,IAAI,mBAAqBiF,KAAKhD,MAAMkD,iBAC5CF,KAAKoM,kBACLpM,KAAKvD,UAAS,SAACO,GACb,MAAO,CACLoD,cAAc,EACdsQ,eAAe,EACfF,aAAa,O,oLAwCAhD,G,8EACnB1S,QAAQC,IAAI,mCACR4Q,EAAO,IAAIyF,KACb,CAAC5D,GADQ,0BAEUxN,KAAKhD,MAAMkD,gBAFrB,SAIPsI,EAAc6I,IAAIC,gBAAgB3F,GAClCjF,EAAU,EACd1G,KAAKvD,SAAS,CAAEmU,mBAAmB,MACZnR,OAAOC,KAAKM,KAAK/F,MAAMwN,eAAe9H,OAOxC,G,iCACH4R,YACd,cAACtM,EAAD,CACEuD,YAAaA,EACbb,gBAAiB3H,KAAKhD,MAAMkD,gBAC5BuH,cAAezH,KAAK/F,MAAMwN,cAC1BG,YAAa5H,KAAKhD,MAAM4K,cAE1B,CACEjF,MAAO,kBACP6O,eAAe,EACfC,YAAY,I,UAIA,WAdhB/K,E,gCAeE1G,KAAKvD,SAAS,CACZ+T,aAAa,EACbpQ,cAAc,I,4BAKG,EACvBJ,KAAKyL,WAAWzL,KAAKhD,MAAMkD,gBAAiByL,EADrB,MAC2CjF,GAClE1G,KAAKvD,SAAS,CACZ+T,aAAa,EACbpQ,cAAc,I,uIAuMR,IAAD,OACDsR,EAAqB1R,KAAK/F,MAAM0X,eAAiB,EACvD,OACE,gCACE,8BACG3R,KAAK/F,MAAMwN,eACZhI,OAAOC,KAAKM,KAAK/F,MAAMwN,eAAe9H,OAAS,EAC7CF,OAAOC,KAAKM,KAAK/F,MAAMwN,eAAe5D,KAAI,SAACnG,GACzC,IAAMkU,EAAY,EAAK3X,MAAMwN,cAAc/J,GAC3C,OACE,gCACE,8BACE,cAAC,EAAD,CACE4B,UAAWsS,EAAUC,WACrBnU,QAASA,EACTa,MAAOqT,EAAUrT,MACjB4B,WAAY,EAAKnD,MAAMmD,WACvBE,WAAY,EAAKrD,MAAMqD,WACvBD,aAAc,EAAKpD,MAAMoD,aACzBF,gBAAiB,EAAKlD,MAAMkD,gBAC5BhC,iBAAkB,EAAKA,iBACvB4B,WAAY,EAAKA,WACjBQ,WAAY,EAAKtD,MAAMsD,WACvBzC,iBAAkB,EAAKA,iBACvBJ,kBAAmB,EAAKA,kBACxBqU,cAAe,EAAK9U,MAAM8U,cAC1BhV,aAAc,EAAKE,MAAMF,aACzBuC,YAAa,EAAKA,YAClBE,YAAa,EAAKA,YAClB6D,iBAAkB,EAAKA,qBAIb,IADb3D,OAAOC,KAAK,EAAKzF,MAAMwN,cAAc/J,GAASa,OAC5CoB,QACD,qBAAKjE,MAAO,CAAEC,UAAW,SAAzB,SACE,uBACED,MAAO,CACL2G,WAAY,OACZ1G,UAAW,OACXoI,aAAc,QAEhBd,KAAK,OACLE,SAAU,SAACrE,GAAD,OACR,EAAKsE,iBAAiBtE,EAAEI,OAAOmE,MAAO3F,UAjChD,gBAAmBA,OA0CvB,qBAAKhC,MAAO,CAAEC,UAAW,YAG7B,wBACED,MAAO,CAAEC,UAAW,OAAQ0G,WAAY,MAAO0B,aAAc,QAC7D4E,UAAU,WACV/F,QAAS5C,KAAKwL,YAHhB,yBAOA,sBAAK9P,MAAO,CAAE4G,QAAS,QAAvB,UACE,mBAAG5G,MAAO,CAAEqI,aAAc,OAA1B,SACE,kDAED2N,GACC,wBACEhW,MAAO,CAAE2G,WAAY,QACrBO,QAAS5C,KAAKuL,mBACd1G,SACE7E,KAAKhD,MAAMmD,YACXH,KAAKhD,MAAM8N,uBACX9K,KAAKhD,MAAMgN,wBANf,SASGhK,KAAKhD,MAAM8N,sBAAwB,aAAe,iBAGtD4G,GACC,wBACE9O,QAAS5C,KAAKiQ,iBACdpL,UAAW7E,KAAKhD,MAAMmD,WAFxB,wBAODuR,GACC,wBACE9O,QAAS5C,KAAKsL,iBACdzG,SACE7E,KAAKhD,MAAMmD,YACXH,KAAKhD,MAAMgN,yBACXhK,KAAKhD,MAAM8N,sBALf,SAQG9K,KAAKhD,MAAMgN,wBAA0B,aAAe,eAGxD0H,GACC,wBACE9O,QAAS5C,KAAKoQ,cACdvL,UACG7E,KAAKhD,MAAM8N,wBACX9K,KAAKhD,MAAMgN,wBAJhB,4BAUkC,OAAnChK,KAAKhD,MAAMiN,qBAC6B,IAAvCjK,KAAKhD,MAAMgO,yBACT,sBAAKtP,MAAO,CAAE2G,WAAY,OAAQ1G,UAAW,QAA7C,UACGqE,KAAKhD,MAAMgO,wBADd,IAEGhL,KAAKhD,MAAMkO,qBAFd,SAGGlL,KAAKhD,MAAMiN,qBAAX,eACSjK,KAAKhD,MAAMiN,wBAG1BjK,KAAKhD,MAAM4T,mBACV,cAAC,EAAD,CAAY5L,KAAM,2BAGrBhF,KAAKhD,MAAMyT,WACV,mBAAG/U,MAAO,CAAEqI,aAAc,OAA1B,wDAKF,cAACC,EAAA,EAAD,CAASrB,MAAM,wBAAwBsB,OAAK,EAA5C,SACE,+BACE,cAACpB,EAAA,EAAD,CACEqB,eAAa,EACbpB,aAAW,SACXF,QAAS5C,KAAK6K,mBACdhG,SAAU7E,KAAKhD,MAAMmD,YAAcH,KAAKhD,MAAMyT,UAJhD,SAMGzQ,KAAKhD,MAAMmD,YAAcH,KAAKhD,MAAMyT,UACnC,cAAC,KAAD,CAA8B/U,MAAO,CAAEyI,SAAU,MAEjD,cAAC,KAAD,CACEzI,MAAO,CAAEyI,SAAU,IACnBC,MAAM,oBAMhB,cAACJ,EAAA,EAAD,CAASrB,MAAO3C,KAAKhD,MAAMmD,WAAa,kBAAoB,GAAI8D,OAAK,EAArE,SACE,+BACE,cAACpB,EAAA,EAAD,CACEqB,eAAa,EACbpB,aAAW,OACXF,QAAS5C,KAAKsK,iBACdzF,UAAW7E,KAAKhD,MAAMmD,WAJxB,SAME,cAAC,KAAD,CAAiBzE,MAAO,CAAEyI,SAAU,YAI1C,cAACH,EAAA,EAAD,CAASrB,MAAM,kBAAkBsB,OAAK,EAAtC,SACE,+BACE,cAACpB,EAAA,EAAD,CACEqB,eAAa,EACbpB,aAAW,OACXF,QAAS5C,KAAK+J,iBACdlF,SACE7E,KAAKhD,MAAMmD,YACsC,IAAjDV,OAAOC,KAAKM,KAAK/F,MAAMwN,eAAe9H,OAExCjE,MAAO,CAAE2G,WAAY,QARvB,SAUE,cAAC,KAAD,CAAsB3G,MAAO,CAAEyI,SAAU,YAGpC,IACX,sBAAKzI,MAAO,CAAE4G,QAAS,OAAQ3G,UAAW,SAA1C,UACE,sBACED,MAAO,CACL+I,SAAU,WACVpC,WAAY,QACZI,MAAO,SAJX,mBAQE,cAAC,IAAD,CACEjC,IAAK,EACLgB,IAAK,IACL8C,aAAc,IACdnB,SAAUnD,KAAKrD,kBAGnB,sBAAMjB,MAAO,CAAE2G,WAAY,OAAQ1G,UAAW,OAA9C,SACGqE,KAAK+N,cAAc/N,KAAKhD,MAAMiP,eAYjC,cAACjI,EAAA,EAAD,CACErB,MAAM,wCACNsB,OAAK,EACLvI,MAAO,CACL+I,SAAU,WACVpC,WAAY,QACZ1G,UAAW,SANf,SASE,+BACE,cAACkH,EAAA,EAAD,CACEqB,eAAa,EACbpB,aAAW,wCACXF,QAAS5C,KAAK0O,mBACdhT,MAAO,CACLqI,aAAc,SALlB,SAQE,cAAC,IAAD,CAAYrI,MAAO,CAAEyI,SAAU,eAKtCnE,KAAKhD,MAAM0T,eACV,sBACE/H,UAAU,QACVjN,MAAO,CACL+I,SAAU,WACVpC,WAAY,QACZ1G,UAAW,UALf,UAQE,cAAC,uBAAD,CACE0J,WAAS,EACTlI,SAAU,EACV4U,OAAQ,CAAC,CAAC,UAAW,IACrBC,KAAM,GACNzE,WAAY,WACV,IAAMxB,EAAYlL,KAAKmL,MAAQ,EAAKhP,MAAMiP,YAC1C,EAAKC,MAAQC,aAAY,WACvB,EAAK1P,SAAS,CAAEwP,YAAapL,KAAKmL,MAAQD,OAE5C,EAAKtP,SAAS,CAAEiU,eAAe,EAAOvQ,YAAY,KAVtD,SAaG,qBAAG8R,iBAEN,wBACErP,QAAS,WACP,EAAKnG,SAAS,CACZiU,eAAe,IAEjB,EAAKpG,oBAEP5O,MAAO,CAAEC,UAAW,OAAQoI,aAAc,QAP5C,0C,GAzwBMe,a,oBC4YHoN,G,kDAxZb,WAAYjY,GAAQ,IAAD,uBACjB,cAAMA,IA+BRkY,0BAA4B,SAAChI,GAC3BrP,QAAQC,IAAI,2CAA4CoP,EAAKiI,WAC7D,EAAK3V,SAAS,CAAE4V,YAAalI,EAAKiI,aAlCjB,EAqCnBE,sBAAwB,WACtBxX,QAAQC,IAAI,uCACZ,EAAKwX,WAvCY,EA0FnBC,gBAAkB,SAACC,GACjB3X,QAAQC,IAAI,uBAAyB0X,GAChB,OAAjBA,GAA0C,KAAjBA,GAG7BC,MAAM,gBAAkB,IAAIC,gBAAgB,CAAEF,aAAcA,KACzDxK,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC8K,GACL,IAAMC,EAASD,EAAIvD,KAAKwD,OACpBD,EAAIvD,KAAKwD,OAAOnR,QAAO,SAACkR,EAAKE,GAC3B,IAAMC,EAAkBD,EAAI,MAAUpR,QAAO,SAACkR,EAAKE,GAOjD,OANAF,EAAIE,EAAI,MAAY,CAClBE,cAAeF,EAAI,cACnB9R,GAAI8R,EAAI,GACRzU,QAASyU,EAAI,QACbvH,SAAUuH,EAAI,UAETF,IACN,IAKH,OAJAA,EAAIE,EAAI,IAAU,CAChB1U,MAAO2U,EACPrB,WAAYoB,EAAI,YAEXF,IACN,IACH,GACe,MAAfA,EAAID,QACN,EAAKrW,SAAS,CACZgW,aAAcA,EACdW,aAAcL,EAAIvD,KAAK4D,aACvBC,WAAYN,EAAIvD,KAAK8D,MAAMD,WAC3BE,WAAYR,EAAIvD,KAAKrO,GACrBqS,eAAgBR,QA5HP,EAsTnBT,QAAU,WACR,EAAKC,gBAAgB,EAAKxV,MAAMyV,eArThC,EAAKzV,MAAQ,CACXoW,aAAc,KACdC,WAAY,KACZE,WAAY,KACZC,eAAgB,KAChBf,aAAcxY,EAAMwZ,SAASC,SAASC,MAAM,KAAK9T,MACjD+T,gBAAgB,EAChBC,uBAAuB,EACvBxB,YAAa,IAEiB,YAA5B,EAAKrV,MAAMyV,eACb,EAAKzV,MAAMyV,aAAe,MAE5B,EAAKjH,YAAc,EAAKA,YAAYzL,KAAjB,gBACnB,EAAKR,YAAc,EAAKA,YAAYQ,KAAjB,gBACnB,EAAKV,YAAc,EAAKA,YAAYU,KAAjB,gBACnB,EAAK0L,WAAa,EAAKA,WAAW1L,KAAhB,gBAClB,EAAKD,WAAa,EAAKA,WAAWC,KAAhB,gBAElB,IAAMwK,EAAWC,KAAKC,MAAMzP,aAAa0P,QAAQ,gBAAgBzJ,KArBhD,OAsBjB,EAAKjE,MAAMqV,YAAc,CAAC9H,GAC1BzP,QAAQC,IAAI,+CACZ6U,GAAOC,KAAK,eAAgB,CAC1BC,QAAS,EAAK9S,MAAMyV,aACpBvC,KAAM3F,IA1BS,E,gEA6CjBvK,KAAKwS,gBAAgBxS,KAAKhD,MAAMyV,cAChC3X,QAAQC,IAAR,0CACA6U,GAAOkB,GAAG,oBAAqB9Q,KAAKmS,2BACpCvC,GAAOkB,GAAG,gBAAiB9Q,KAAKsS,yB,6CAIhCxX,QAAQC,IAAR,wCACmCiF,KAAKhD,MAAMoW,aAD9C,gBAGAxD,GAAOoB,IAAI,oBAAqBhR,KAAKmS,2BACrCvC,GAAOoB,IAAI,gBAAiBhR,KAAKsS,uBAEjC,IAAMwB,EAAc9Y,aAAa0P,QAAQ,eACzC,GAAIoJ,EAAa,CACfhZ,QAAQC,IAAI,gDACZ,IAAMwP,EAAWC,KAAKC,MAAMqJ,GAAa7S,KACzC2O,GAAOC,KAAK,gBAAiB,CAC3BC,QAAS9P,KAAKhD,MAAMyV,aACpBvC,KAAM3F,O,yCAKOtK,GACjB,IAAMyT,EAAW1T,KAAK/F,MAAMwZ,SAASC,SAASC,MAAM,KAAK9T,MAG1C,YAAb6T,GACa,OAAbA,GACA1T,KAAK/F,MAAMwZ,SAASC,WAAazT,EAAUwT,SAASC,SAEpD1T,KAAKwS,gBAAgBkB,GAEC,YAAbA,GAAsD,OAA5B1T,KAAKhD,MAAMyV,cAC9CzS,KAAKvD,SAAS,CACZgW,aAAc,KACdW,aAAc,KACdC,WAAY,KACZE,WAAY,KACZC,eAAgB,S,oKA8CpB1Y,QAAQC,IAAI,sB,SACagZ,YAAO,mB,QAA1BlC,E,WAEEmC,EAAW,IAAIC,UACZC,OAAO,aAAcrC,GAC9BmC,EAASE,OAAO,aAAclU,KAAKhD,MAAMuW,YAKzCb,MAAM,aAJiB,CACrB/N,OAAQ,OACR6K,KAAMwE,IAGL/L,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC8K,GACL,GAAmB,MAAfA,EAAID,OAAgB,CACtBhY,QAAQC,IAAI,mBACZ,IAAIoZ,EAAgB1U,OAAO2U,OAAO,GAAI,EAAKpX,MAAMwW,gBACjDW,EAAcpB,EAAIvD,KAAK9D,UAAY,CACjCvK,GAAIa,SAAS+Q,EAAIvD,KAAK9D,UACtB6H,WAAY,EAAKvW,MAAMqX,UACvB9V,MAAO,GACPsT,WAAYA,GAEd,EAAKpV,SAAS,CAAE+W,eAAgBW,IAChCvE,GAAOC,KAAK,2BAA4B,CACtCC,QAAS,EAAK9S,MAAMyV,oB,iLAOdtR,EAAIF,G,uFACpBnG,QAAQC,IAAI,kB,SACWgZ,YAAO,oBAAqB,CACjDzP,aAAcrD,I,QADVqT,E,WAIEN,EAAW,IAAIC,UACZC,OAAO,WAAY/S,GAC5B6S,EAASE,OAAO,WAAYI,GAK5B5B,MAAM,aAJiB,CACrB/N,OAAQ,MACR6K,KAAMwE,IAGL/L,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC8K,GACL,GAAmB,MAAfA,EAAID,OAAgB,CACtB,IAAIqB,EAAgB1U,OAAO2U,OAAO,GAAI,EAAKpX,MAAMwW,gBACjDW,EAAchT,GAAI0Q,WAAayC,EAC/B,EAAK7X,SAAS,CAAE+W,eAAgBW,IAChCvE,GAAOC,KAAK,2BAA4B,CACtCC,QAAS,EAAK9S,MAAMyV,oB,+KAOdtR,EAAIF,G,8FACCC,YAAQ,oCAAD,OACUD,EADV,MAE1B,gB,uBAGAjB,KAAKvD,SAAS,CAAEoX,uBAAuB,KACjCG,EAAW,IAAIC,UACZC,OAAO,WAAY/S,GAK5BuR,MAAM,aAJiB,CACrB/N,OAAQ,SACR6K,KAAMwE,IAGL/L,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC8K,GACL,GAAmB,MAAfA,EAAID,OAAgB,CACtB,IAAMqB,EAAgB1U,OAAO2U,OAAO,GAAI,EAAKpX,MAAMwW,gBASnD,cAROW,EAAchT,GACrB,EAAK1E,SAAS,CACZ+W,eAAgBW,EAChBN,uBAAuB,IAEzBjE,GAAOC,KAAK,2BAA4B,CACtCC,QAAS,EAAK9S,MAAMyV,gBAEf,EAET,EAAKhW,SAAS,CAAEoX,uBAAuB,Q,mBAGtC,G,0IAGEnI,EAAUC,EAAMC,EAAkBlF,GAAU,IAAD,OACpD5L,QAAQC,IAAI,wBAAyB2Q,GACrC1L,KAAKvD,SAAS,CAAEmX,gBAAgB,IAChC,IAAMI,EAAW,IAAIC,SACrBD,EAASE,OAAO,WAAYxI,GAC5BsI,EAASE,OAAO,OAAQvI,GACxBqI,EAASE,OAAO,UAAWxN,GAC3BsN,EAASE,OAAO,aAAa,IAAIrT,MAAO0T,oBAAsB,IAC9DP,EAASE,OAAO,mBAAoBtI,GAOpC8G,MAAM,YALiB,CACrB/N,OAAQ,OACR6K,KAAMwE,IAIL/L,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC8K,GACL,GAAmB,MAAfA,EAAID,OAAgB,CACtBhY,QAAQC,IAAI,gBAAiBgY,GAC7B,IAAIoB,EAAgB1U,OAAO2U,OAAO,GAAI,EAAKpX,MAAMwW,gBACjDW,EAAcnS,SAAS0J,IAAWnN,MAAMyD,SAAS+Q,EAAIvD,KAAKzN,OAAS,CACjEZ,GAAIa,SAAS+Q,EAAIvD,KAAK1D,SACtBJ,SAAU1J,SAAS0J,GACnBlN,QAASuU,EAAIvD,KAAKhR,QAClB2U,cAAe,IAAItS,KAAKkS,EAAIvD,KAAKgF,WAAWC,YAE9C,EAAKhY,SAAS,CACZ+W,eAAgBW,EAChBP,gBAAgB,IAElBhE,GAAOC,KAAK,2BAA4B,CACtCC,QAAS,EAAK9S,MAAMyV,oBAGtB,EAAKhW,SAAS,CAAEmX,gBAAgB,OAGnC/C,OAAM,SAACrV,GACND,MAAM,4DACNT,QAAQC,IAAIS,GACZ,EAAKiB,SAAS,CAAEmX,gBAAgB,S,iCAI3BlI,EAAUG,EAAaC,GAAU,IAAD,OACzC9L,KAAKvD,SAAS,CAAEoX,uBAAuB,IACvC,IAAMG,EAAW,IAAIC,SACrBD,EAASE,OAAO,UAAWpI,GAK3B4G,MAAM,YAJiB,CACrB/N,OAAQ,SACR6K,KAAMwE,IAGL/L,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC8K,GACL,GAAmB,MAAfA,EAAID,OAAgB,CACtB,IAAMqB,EAAgB1U,OAAO2U,OAAO,GAAI,EAAKpX,MAAMwW,uBAC5CW,EAAczI,GAAUnN,MAAMsN,GACrC,EAAKpP,SAAS,CACZ+W,eAAgBW,EAChBN,uBAAuB,IAEzBjE,GAAOC,KAAK,2BAA4B,CACtCC,QAAS,EAAK9S,MAAMyV,oBAGtB,EAAKhW,SAAS,CAAEoX,uBAAuB,OAG1ChD,OAAM,SAACrV,GACND,MAAM,4DACN,EAAKkB,SAAS,CAAEoX,uBAAuB,S,+BAS3C,IAAMa,EAAa1U,KAAK/F,MAAMwZ,SAASC,SAASC,MAAM,KAAK9T,MAG3D,OAAgC,OAA5BG,KAAKhD,MAAMoW,cAAwC,YAAfsB,EAC/B,6CAIP1U,KAAKhD,MAAMyV,cACI,YAAfiC,GACe,KAAfA,GACE,gCACE,sBACEhZ,MAAO,CACL4G,QAAS,OACTyB,aAAc,QACdpI,UAAW,QAJf,UAOE,+BACGqE,KAAKhD,MAAMoW,aACZ,cAACpP,EAAA,EAAD,CACErB,MAAM,8BACNsB,OAAK,EACL0Q,UAAU,QAHZ,SAKE,cAAC9R,EAAA,EAAD,CACEqB,eAAa,EACbpB,aAAW,OACXF,QAAS5C,KAAKuS,QACd7W,MAAO,CAAEC,UAAW,OAJtB,SAME,cAAC,KAAD,CAAiBD,MAAO,CAAEyI,SAAU,aAIzCnE,KAAKhD,MAAM4W,gBACV,qBAAKlY,MAAO,CAAEC,UAAW,QAAzB,SACE,cAAC,EAAD,CAAYqJ,KAAK,wBAGpBhF,KAAKhD,MAAM6W,uBACV,qBAAKnY,MAAO,CAAEC,UAAW,QAAzB,SACE,cAAC,EAAD,CAAYqJ,KAAK,qBAIvB,qBACEtJ,MAAO,CACL2G,WAAY,OACZ1G,UAAW,OACXoI,aAAc,QACdI,SAAU,QALd,SAQGnE,KAAKhD,MAAMqV,YAAYxO,KAAI,SAACqM,EAAM0E,GACjC,OACE,sBAEElZ,MAAO,CAAE4G,QAAS,eAAgB+B,YAAa,OAFjD,UAIE,qBACE9B,IAAI,wBACJC,IAAI,SACJC,MAAM,IACNC,OAAO,IACPhH,MAAO,CAAE2G,WAAY,SACpB,IACF6N,EAAM,MAXT,eACe0E,SAerB,qBAAKlZ,MAAO,CAAEC,UAAW,QAAzB,SACE,cAAC,GAAD,CACEyO,YAAapK,KAAKhD,MAAMoW,aACxBrD,YAAa/P,KAAKhD,MAAMyV,aACxBhL,cAAezH,KAAKhD,MAAMwW,eAC1B7B,eAAgB3R,KAAKhD,MAAMqV,YAAY1S,OACvC6S,gBAAiBxS,KAAKwS,gBACtBhH,YAAaxL,KAAKwL,YAClBjM,YAAaS,KAAKT,YAClBF,YAAaW,KAAKX,YAClBoM,WAAYzL,KAAKyL,WACjB3L,WAAYE,KAAKF,sB,GAhZTgF,aCiBP+P,G,uKAxBX,OACE,gCACE,0CACE7U,KAAK/F,MAAM6a,OAGX,gCACE,+DACA,+BACE,uGAIA,4FAC6D,aAVjE,0E,GANShQ,a,SCMbiQ,GAAwB,iBACxBC,GAAwB,iBACxB7Y,GAAU,CAAC4Y,GAAuBC,IAmEzB9C,OAjEf,SAAiBjY,GACf,IAAMgb,EAAUC,cADM,EAEsC9P,mBAAS,MAF/C,mBAEfrG,EAFe,KAESoW,EAFT,KAmBhBlW,EAAqB,SAACH,GAC1B,IAAMV,EAASU,EAAEI,OAAOC,UACpBf,IAAW2W,GACb9a,EAAMmb,cAAcnb,EAAMob,QAAQlU,GAAIlH,EAAMob,QAAQjC,cAC3ChV,IAAW4W,IACpB/a,EAAMqb,cAAcrb,EAAMob,QAAQlU,GAAIlH,EAAMob,QAAQjC,cAEtD+B,EAA0B,OAG5B,OACE,2CACYlb,EAAMob,QAAQjC,aAAc,IACtC,wBAAQxQ,QA5BK,WACfqS,EAAQ/S,KAAK,CACXwR,SAAS,YAAD,OAAczZ,EAAMob,QAAQ5C,cACpCzV,MAAO,CACLqY,QAASpb,EAAMob,QACfhC,WAAYpZ,EAAMoZ,WAClBkC,SAAUtb,EAAMsb,aAsBlB,uBACA,cAAC1S,EAAA,EAAD,CACEC,aAAW,OACXC,gBAAc,eACdC,gBAAc,OACdJ,QAtBqB,SAAC9D,GAC1BqW,EAA0BrW,EAAEE,gBAsBxBtD,MAAO,CAAE2G,WAAY,OALvB,SAOE,cAAC,IAAD,MAEF,cAACiB,EAAA,EAAD,CACEnC,GAAG,eACHoC,SAAUxE,EACVyE,aAAW,EACXC,KAAiC,OAA3B1E,EACN2E,QAASzE,EACT0E,WAAY,CACVjI,MAAO,CACLkI,UAAW,IACXnB,MAAO,SATb,SAaGtG,GAAQ0H,KAAI,SAACzF,GAAD,OACX,cAAC0F,EAAA,EAAD,CAAuBlB,QAAS3D,EAAhC,SACGb,GADYA,YCgHVoX,I,yDAzKb,WAAYvb,GAAQ,IAAD,8BACjB,cAAMA,IAiHR4E,mBAAqB,SAACC,GACpB,EAAKrC,SAAS,CAAEsC,uBAAwBD,EAAEE,iBAnHzB,EAsHnBC,mBAAqB,SAACH,GACpB,IAAMV,EAASU,EAAEI,OAAOC,UA3HA,iBA4HpBf,EACF,EAAKnE,MAAMwb,YAAY,EAAKxb,MAAMkH,GAAI,EAAKlH,MAAMgH,MA5H3B,iBA6Hb7C,GACT,EAAKnE,MAAMyb,YAAY,EAAKzb,MAAMkH,GAAI,EAAKlH,MAAMgH,MAEnD,EAAKxE,SAAS,CAAEsC,uBAAwB,QA3HxC,EAAK/B,MAAQ,CACX2Y,SAAU1b,EAAM0b,SAChB5W,uBAAwB,MAE1B,EAAK6W,iBAAmB,EAAKA,iBAAiB7V,KAAtB,gBACxB,EAAKuV,cAAgB,EAAKA,cAAcvV,KAAnB,gBACrB,EAAKqV,cAAgB,EAAKA,cAAcrV,KAAnB,gBARJ,E,+DAWAE,GACbD,KAAK/F,MAAM0b,WAAa1V,EAAU0V,UACpC3V,KAAKvD,SAAS,CAAEkZ,SAAU3V,KAAK/F,MAAM0b,a,kLAKZ5B,YAAO,qB,QAA5BX,E,WAEEY,EAAW,IAAIC,UACZC,OAAO,eAAgBd,GAChCY,EAASE,OAAO,WAAYlU,KAAK/F,MAAMkH,IAMvCuR,MAAM,eALiB,CACrB/N,OAAQ,OACR6K,KAAMwE,IAIL/L,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC8K,GACc,MAAfA,EAAID,SACN,EAAKrW,SAAS,CACZkZ,SAAU,EAAK3Y,MAAM2Y,SAASE,OAAO,CACnC,CACEzC,aAAcA,EACdjS,GAAI4R,EAAIvD,KAAK+D,WACbd,aAAcM,EAAIvD,KAAKiD,kBAI7B7C,GAAOC,KAAK,kC,mLAMF1O,EAAIF,G,8FACDC,YAAQ,oCAAD,OACUD,EADV,MAE1B,kB,iBAGM+S,EAAW,IAAIC,UACZC,OAAO,aAAc/S,GAK9BuR,MAAM,eAJiB,CACrB/N,OAAQ,SACR6K,KAAMwE,IAGL/L,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC8K,GACL,GAAmB,MAAfA,EAAID,OAAgB,CACtB,IAAMgD,EAAkB,YAAI,EAAK9Y,MAAM2Y,UAAUjO,QAC/C,SAACkN,GAAD,OAAOA,EAAEzT,KAAOA,KAElB,EAAK1E,SAAS,CACZkZ,SAAUG,IAEZlG,GAAOC,KAAK,kC,iLAMF1O,EAAIF,G,gGACC8S,YAAO,sBAAuB,CACnDzP,aAAcrD,I,QADVqT,E,WAIEN,EAAW,IAAIC,UACZC,OAAO,aAAc/S,GAC9B6S,EAASE,OAAO,WAAYI,GAM5B5B,MAAM,eALiB,CACrB/N,OAAQ,MACR6K,KAAMwE,IAIL/L,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC8K,GACL,GAAmB,MAAfA,EAAID,OAAgB,CACtB,IAAMgD,EAAkB,YACnB,EAAK9Y,MAAM2Y,UACd9R,KAAI,SAACkS,GAAD,OACJA,EAAY5U,KAAOA,EAAnB,6BACS4U,GADT,IACsB3C,aAAckB,IAChCyB,KAEN,EAAKtZ,SAAS,CACZkZ,SAAUG,IAEZlG,GAAOC,KAAK,kC,mIAoBZ,IAAD,OACHmG,EAAiBhW,KAAKhD,MAAM2Y,SAASM,MAAK,SAACtb,EAAGub,GAAJ,OAC5Cvb,EAAEwG,GAAK+U,EAAE/U,GAAK,GAAK,KAErB,OACE,sBAAKzF,MAAO,CAAEC,UAAW,OAAQoI,aAAc,SAA/C,UACE,wCACU/D,KAAK/F,MAAMgH,KAClB,KACD,wBAAQ2B,QAAS5C,KAAK4V,iBAAtB,0BAEF,qBAAKla,MAAO,CAAEC,UAAW,QAAzB,SACE,+BACGqE,KAAKhD,MAAM2Y,UAA2C,IAA/B3V,KAAKhD,MAAM2Y,SAAShW,QAC1C,mBACEgJ,UAAU,aACVjN,MAAO,CAAEC,UAAW,QAASoI,aAAc,QAF7C,sCAODiS,EAAenS,KAAI,SAACkS,EAAanB,GAAd,OAClB,8BACE,qBAAKlZ,MAAO,CAAEC,UAAW,QAASoI,aAAc,SAAhD,SACE,cAAC,GAAD,CACEsR,QAASU,EACT1C,WAAY,EAAKpZ,MAAMgH,KACvBsU,SAAU,EAAKtb,MAAMkH,GACrBiU,cAAe,EAAKA,cACpBE,cAAe,EAAKA,mBAP1B,kBAAqBV,mB,GAvJf9P,cCqFLqR,I,yDApFb,aAAe,IAAD,8BACZ,gBASFC,uBAAyB,WACvBtb,QAAQC,IAAI,wCACZ,EAAKwX,WAZO,EAyBd8D,YAAc,WACZ3D,MAAM,cAAe,CACnB/N,OAAQ,QAEPsD,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC3N,GACc,MAAfA,EAAIwY,QACN,EAAKrW,SAAS,CAAE6Z,OAAQhc,EAAIkV,KAAM+G,UAAU,QAlCtC,EAuCdhE,QAAU,WACR,EAAK8D,eAtCL,EAAKrZ,MAAQ,CACXsZ,OAAQ,GACRC,UAAU,GAEZ,EAAKF,cANO,E,gEAgBZvb,QAAQC,IAAI,+CACZ6U,GAAOkB,GAAG,iBAAkB9Q,KAAKoW,0B,6CAIjCtb,QAAQC,IAAI,+CACZ6U,GAAOoB,IAAI,iBAAkBhR,KAAKoW,0B,+BAqB1B,IAAD,OACP,OAAKpW,KAAKhD,MAAMuZ,SAId,sBAAK7a,MAAO,CAAEqI,aAAc,QAA5B,UACE,qBAAIrI,MAAO,CAAEqI,aAAc,SAA3B,qBAEE,cAACC,EAAA,EAAD,CAASrB,MAAM,0BAA0BsB,OAAK,EAAC0Q,UAAU,QAAzD,SACE,cAAC9R,EAAA,EAAD,CACEnH,MAAO,CAAEC,UAAW,QACpBuI,eAAa,EACbpB,aAAW,OACXF,QAAS5C,KAAKuS,QAJhB,SAME,cAAC,KAAD,CAAiB7W,MAAO,CAAEyI,SAAU,aAIzCnE,KAAKhD,MAAMsZ,QAAuC,IAA7BtW,KAAKhD,MAAMsZ,OAAO3W,QACtC,mBAAGjE,MAAO,CAAEC,UAAW,QAAU6a,MAAM,aAAvC,mCAIDxW,KAAKhD,MAAMsZ,QACVtW,KAAKhD,MAAMsZ,OAAOzS,KAAI,SAAC4S,EAAW7B,GAAZ,OACpB,8BACE,cAAC,GAAD,CACEzT,GAAIsV,EAAUtV,GACdF,KAAMwV,EAAUpD,WAChBsC,SAAUc,EAAUd,SACpBF,YAAa,EAAKA,YAClBC,YAAa,EAAKA,eANtB,gBAAmBd,UAxBlB,iD,GA9CU9P,cCYR4R,I,mNAnBbC,aAAe,WACb,EAAK1c,MAAM0c,aAAa,EAAK1c,MAAMkH,K,uDAInC,IAAMyV,GAAoB5W,KAAK/F,MAAM4c,kBACrC,OACE,8BACE,0CACW7W,KAAK/F,MAAMgH,KAAM,IACzB2V,GACC,wBAAQhU,QAAS5C,KAAK2W,aAAtB,6B,GAZS7R,c,OCSN,SAASgS,GAAsB7c,GAC5C,IAAMiL,EAASC,cADoC,EAGjBC,mBAAS,MAHQ,mBAG5C2R,EAH4C,KAGjCC,EAHiC,OAIb5R,mBAAS,MAJI,mBAI5C6R,EAJ4C,KAI/BC,EAJ+B,KAY7CC,EAAsB1X,OAAOC,KAAKzF,EAAMmd,OAAOvV,QAAO,SAACC,EAAKuV,GAKhE,OAJAvV,EAAII,KAAK,CACPtF,MAAOya,EACPhZ,MAAOpE,EAAMmd,MAAMC,KAEdvV,IACN,IAEH,OACE,gCACE,eAAC,IAAD,WACE,4EACA,qBACEpG,MAAO,CACLgH,OAAQ,IACRD,MAAO,KAHX,SAME,cAAC,IAAD,CACEtG,QAASgb,EACThU,SA1BQ,SAAC/E,GACjBtD,QAAQC,IAAI,YAAcqD,EAAOC,OACjC2Y,EAAa5Y,EAAOxB,OACpBsa,EAAe9Y,EAAOC,QAwBdqG,YAAY,uBAIlB,eAAC,IAAD,WACE,cAAC,IAAD,CACE9B,QAAS,WAEPsC,EAAOgE,MAAM,CAAC6N,EAAWE,KAH7B,gBAQA,cAAC,IAAD,CACErU,QAAS,WACPsC,EAAOgE,MAAM,CAAC6N,EAAWE,KAE3BhU,KAAM,QAJR,0BC3CR,IAAMqU,GAAsB,eACtBC,GAAsB,eACtBpb,GAAU,CAACmb,GAAqBC,IA4MvB/B,G,kDAzMb,WAAYvb,GAAQ,IAAD,8BACjB,cAAMA,IA8HR4E,mBAAqB,SAACC,GACpB,EAAKrC,SAAS,CAAEsC,uBAAwBD,EAAEE,iBAhIzB,EAmInBC,mBAAqB,SAACH,GACpB,IAAMV,EAASU,EAAEI,OAAOC,UACpBf,IAAWkZ,GACb,EAAKrd,MAAMwb,YAAY,EAAKxb,MAAMkH,GAAI,EAAKlH,MAAMgH,MACxC7C,IAAWmZ,IACpB,EAAKtd,MAAMyb,YAAY,EAAKzb,MAAMkH,GAAI,EAAKlH,MAAMgH,MAEnD,EAAKxE,SAAS,CAAEsC,uBAAwB,QAxIxC,EAAK/B,MAAQ,CACXwa,iBAAkB,GAClBzY,uBAAwB,MAE1B2T,MAAM,+BAAiC,EAAKzY,MAAMkH,GAAI,CAAEwD,OAAQ,QAC7DsD,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC3N,GACc,MAAfA,EAAIwY,QACN,EAAKrW,SAAS,CAAE+a,iBAAkBld,EAAIkV,UAG5C,EAAKiI,UAAY,EAAKA,UAAU1X,KAAf,gBACjB,EAAK4W,aAAe,EAAKA,aAAa5W,KAAlB,gBAhBH,E,+DAmBAE,GAAY,IAAD,OACxBD,KAAK/F,MAAMsY,UAAYtS,EAAUsS,SACnCG,MAAM,+BAAiC1S,KAAK/F,MAAMkH,GAAI,CAAEwD,OAAQ,QAC7DsD,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC3N,GACc,MAAfA,EAAIwY,QACN,EAAKrW,SAAS,CAAE+a,iBAAkBld,EAAIkV,Y,0KAO9C1U,QAAQC,IAAI,iB,SAEU2X,MAAM,aAAc,CAAE/N,OAAQ,QACjDsD,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC3N,GACL,OAAOA,EAAIkV,Q,cALXkI,E,gBASwBnG,YAC1B,cAACuF,GAAD,CAAuBM,MAAOM,IAC9B,CACE/U,MAAO,iBAAmB3C,KAAK/F,MAAMgH,KACrCuQ,eAAe,I,eAGGmG,KAPhBC,E,SAO+C,OAAlBA,E,+DAGFA,E,GAA1Bb,E,KAAWc,E,KAIhBd,GACAtX,OAAOC,KAAKM,KAAKhD,MAAMwa,kBAAkB3P,SAASkP,GAGlDxb,MAAM,GAAD,OAAIsc,EAAJ,0CAAiD7X,KAAK/F,MAAMgH,KAA5D,MACI8V,GAAac,KAChB7D,EAAW,IAAIC,UACZC,OAAO,WAAYlU,KAAK/F,MAAMkH,IACvC6S,EAASE,OAAO,UAAW6C,GAK3BrE,MAAM,qBAJiB,CACrB/N,OAAQ,OACR6K,KAAMwE,IAGL/L,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC8K,GACL,GAAmB,MAAfA,EAAID,OAAgB,CACtB,IAAMgF,EAAoBrY,OAAO2U,OAC/B,GACA,EAAKpX,MAAMwa,kBAEbM,EAAkBf,GAAac,EAC/B,EAAKpb,SAAS,CACZ+a,iBAAkBM,IAEpBlI,GAAOC,KAAK,gC,mLAMHwH,G,uFACjBvc,QAAQC,IAAI,sBAAuBsc,GAC7B9M,EAAWvK,KAAKhD,MAAMwa,iBAAiBH,G,SACxBnW,YAAQ,oCAAD,OACUqJ,EADV,mBAC6BvK,KAAK/F,MAAMgH,KADxC,MAE1B,iB,iBAGM+S,EAAW,IAAIC,UACZC,OAAO,WAAYlU,KAAK/F,MAAMkH,IACvC6S,EAASE,OAAO,UAAWmD,GAK3B3E,MAAM,qBAJiB,CACrB/N,OAAQ,SACR6K,KAAMwE,IAGL/L,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC8K,GACL,GAAmB,MAAfA,EAAID,OAAgB,CACtB,IAAMgF,EAAoBrY,OAAO2U,OAC/B,GACA,EAAKpX,MAAMwa,yBAENM,EAAkBT,GACzB,EAAK5a,SAAS,CACZ+a,iBAAkBM,IAEpBlI,GAAOC,KAAK,gC,sIAoBZ,IAAD,OACP,OACE,sBAAKnU,MAAO,CAAEqI,aAAc,SAA5B,UACE,oBAAGrI,MAAO,CAAEC,UAAW,OAAQoI,aAAc,SAA7C,oBACU/D,KAAK/F,MAAMgH,KAClB,KACD,wBAAQ2B,QAAS5C,KAAKyX,UAAtB,sBACA,cAAC5U,EAAA,EAAD,CACEC,aAAW,OACXC,gBAAc,aACdC,gBAAc,OACdJ,QAAS5C,KAAKnB,mBACdnD,MAAO,CAAE2G,WAAY,OALvB,SAOE,cAAC,IAAD,MAEF,cAACiB,EAAA,EAAD,CACEnC,GAAG,aACHoC,SAAUvD,KAAKhD,MAAM+B,uBACrByE,aAAW,EACXC,KAA4C,OAAtCzD,KAAKhD,MAAM+B,uBACjB2E,QAAS1D,KAAKf,mBACd0E,WAAY,CACVjI,MAAO,CACLkI,UAAW,IACXnB,MAAO,SATb,SAaGtG,GAAQ0H,KAAI,SAACzF,GAAD,OACX,cAAC0F,EAAA,EAAD,CAAuBlB,QAAS,EAAK3D,mBAArC,SACGb,GADYA,WAMrB,6BACGqB,OAAOC,KAAKM,KAAKhD,MAAMwa,kBAAkB3T,KAAI,SAACwT,GAC7C,IAAM9M,EAAW,EAAKvN,MAAMwa,iBAAiBH,GAC7C,OACE,8BACE,8BACE,cAAC,GAAD,CACElW,GAAIkW,EACJpW,KAAMsJ,EACNoM,aAAc,EAAKA,aACnBE,kBACsD,IAApDpX,OAAOC,KAAK,EAAK1C,MAAMwa,kBAAkB7X,YAPjD,iBAAoB0X,gB,GAtLdvS,aC4MLiT,G,kDAlNb,aAAe,IAAD,8BACZ,gBAcFC,qBAAuB,WACrBld,QAAQC,IAAI,sCACZ,EAAKwX,WAjBO,EAgCd8D,YAAc,WACZ3D,MAAM,cAAe,CACnB/N,OAAQ,QAEPsD,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC3N,GACc,MAAfA,EAAIwY,QACN,EAAKrW,SAAS,CAAE6Z,OAAQhc,EAAIkV,KAAM+G,UAAU,QAzCtC,EAiJdhE,QAAU,WACRzX,QAAQC,IAAI,qBACZ2X,MAAM,cAAe,CACnB/N,OAAQ,QAEPsD,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC3N,GACc,MAAfA,EAAIwY,OACN,EAAKrW,SAAS,CACZ6Z,OAAQhc,EAAIkV,KACZ+G,UAAU,EACVhE,QAAS,EAAKvV,MAAMuV,QAAU,IAGhC,EAAK9V,SAAS,CAAE8V,QAAS,EAAKvV,MAAMuV,QAAU,QA/JpD,EAAKvV,MAAQ,CACXsZ,OAAQ,GACRC,UAAU,EACVhE,QAAS,GAEX,EAAK8D,cACL,EAAK4B,eAAiB,EAAKA,eAAelY,KAApB,gBACtB,EAAK2V,YAAc,EAAKA,YAAY3V,KAAjB,gBACnB,EAAK0V,YAAc,EAAKA,YAAY1V,KAAjB,gBAVP,E,gEAuBZjF,QAAQC,IAAI,6CACZ6U,GAAOkB,GAAG,eAAgB9Q,KAAKgY,wB,6CAI/Bld,QAAQC,IAAI,6CACZ6U,GAAOoB,IAAI,eAAgBhR,KAAKgY,wB,uKAkBhCld,QAAQC,IAAI,uB,SACagZ,YAAO,mB,QAA1BV,E,WAEEW,EAAW,IAAIC,UACZC,OAAO,aAAcb,GAM9BX,MAAM,aALiB,CACrB/N,OAAQ,OACR6K,KAAMwE,IAIL/L,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC8K,GACc,MAAfA,EAAID,QACN,EAAKrW,SAAS,CACZ6Z,OAAQ,EAAKtZ,MAAMsZ,OAAOT,OAAO,CAC/B,CAAExC,WAAYA,EAAYlS,GAAI4R,EAAIvD,KAAK+F,SAAUI,SAAU,WAKlE9E,OAAM,SAACrV,GACND,MACE,oEACE8X,EACA,U,4KAMMlS,EAAIF,G,qFACpBnG,QAAQC,IAAI,kB,SACSmG,YAAQ,oCAAD,OACUD,EADV,MAE1B,gB,iBAGM+S,EAAW,IAAIC,UACZC,OAAO,WAAY/S,GAK5BuR,MAAM,aAJiB,CACrB/N,OAAQ,SACR6K,KAAMwE,IAGL/L,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC8K,GACL,GAAmB,MAAfA,EAAID,OAAgB,CACtB,IAAMoF,EAAgB,YAAI,EAAKlb,MAAMsZ,QAAQ5O,QAC3C,SAACkN,GAAD,OAAOA,EAAEzT,KAAOA,KAElB,EAAK1E,SAAS,CACZ6Z,OAAQ4B,IAEVtI,GAAOC,KAAK,gC,+KAMJ1O,EAAIF,G,uFACpBnG,QAAQC,IAAI,kB,SACWgZ,YAAO,oBAAqB,CACjDzP,aAAcrD,I,QADVqT,E,WAIEN,EAAW,IAAIC,UACZC,OAAO,WAAYI,GAC5BN,EAASE,OAAO,WAAY/S,GAM5BuR,MAAM,aALiB,CACrB/N,OAAQ,MACR6K,KAAMwE,IAIL/L,MAAK,SAAC2K,GAAD,OACJA,EAAKC,OAAO5K,MAAK,SAACkC,GAAD,MAAW,CAAE2I,OAAQF,EAAKE,OAAQtD,KAAMrF,SAE1DlC,MAAK,SAAC8K,GACL,GAAmB,MAAfA,EAAID,OAAgB,CACtB,IAAMoF,EAAgB,YAAI,EAAKlb,MAAMsZ,QAAQzS,KAAI,SAAC4S,GAAD,OAC/CA,EAAUtV,KAAOA,EAAjB,6BACSsV,GADT,IACoBpD,WAAYiB,IAC5BmC,KAEN,EAAKha,SAAS,CACZ6Z,OAAQ4B,IAEVtI,GAAOC,KAAK,gC,mIA2BZ,IAAD,OACP,OAAK7P,KAAKhD,MAAMuZ,SAId,gCACE,qBAAI7a,MAAO,CAAEqI,aAAc,SAA3B,6BAEE,cAACC,EAAA,EAAD,CAASrB,MAAM,wBAAwBsB,OAAK,EAAC0Q,UAAU,QAAvD,SACE,cAAC9R,EAAA,EAAD,CACEnH,MAAO,CAAEC,UAAW,QACpBuI,eAAa,EACbpB,aAAW,OACXF,QAAS5C,KAAKuS,QAJhB,SAME,cAAC,KAAD,CAAiB7W,MAAO,CAAEyI,SAAU,aAIzCnE,KAAKhD,MAAMsZ,QACVtW,KAAKhD,MAAMsZ,OAAOzS,KAAI,SAAC4S,EAAW7B,GAAZ,OACpB,8BACE,cAAC,GAAD,CACEzT,GAAIsV,EAAUtV,GACdF,KAAMwV,EAAUpD,WAChBsC,SAAUc,EAAUd,SACpBF,YAAa,EAAKA,YAClBC,YAAa,EAAKA,YAClBnD,QAAS,EAAKvV,MAAMuV,WAPxB,gBAAmBqC,OAWvB,wBACElZ,MAAO,CAAEC,UAAW,QACpBgN,UAAU,WACV/F,QAAS5C,KAAKiY,eAHhB,sCA9BK,iD,GAzKQnT,a,UCONqT,OAff,YAAkE,IAA/BrT,EAA8B,EAAzCsT,UAAsBtD,EAAmB,EAAnBA,OAAWuD,EAAQ,uCAC/D,OACE,cAAC,IAAD,6BACMA,GADN,IAEEC,OAAQ,SAACre,GAAD,OACK,IAAX6a,EACE,cAAChQ,EAAD,gBAAe7K,IAEf,cAAC,IAAD,CAAUse,GAAI,CAAE7E,SAAU,IAAK1W,MAAO,CAAEwb,KAAMve,EAAMwZ,kB,UCIjD7D,G,OAAS6I,GAAGte,yOAAYue,UAE/BzD,GAAU0D,cA2IDC,G,kDAxIb,aAAe,IAAD,8BACZ,gBAgCFC,sBAAwB,SAACC,GACvB,IAAMhF,EAAcgF,EAASC,WACvB/E,EAAW,IAAIC,SACrBD,EAASE,OAAO,iBAAkBJ,EAAYkF,UAC9ChF,EAASE,OAAO,eAAgBJ,EAAYmF,OAC5CjF,EAASE,OAAO,YAAaJ,EAAY7S,MAMzCyR,MAAM,cALiB,CACrB/N,OAAQ,OACR6K,KAAMwE,IAIL/L,MAAK,SAAC2K,GAAD,OAAUA,EAAKC,UACpB5K,MAAK,SAAC3N,GACLQ,QAAQC,IAAIT,EAAI4e,SAChBle,aAAaC,QAAQ,cAAeuP,KAAK2O,UAAUrF,IACnD9Y,aAAaC,QAAQ,kBAAkB,GACvC,EAAKwB,SAAS,CAAEqX,YAAaA,EAAasF,gBAAgB,QAlDlD,EAsDdC,uBAAyB,WACvB3G,MAAM,eAAgB,CAAE/N,OAAQ,SAC7BsD,MAAK,SAAC2K,GAAD,OAAUA,EAAKC,UACpB5K,MAAK,SAAC3N,GACLQ,QAAQC,IAAIT,EAAI4e,SAChBle,aAAase,QACb,EAAK7c,SAAS,CAAEqX,YAAa,GAAIsF,gBAAgB,QA1DrD,EAAKpc,MAAQ,CACX8W,YAAa,GACbsF,gBAAgB,GAJN,E,gEASsB,MAA9BnE,GAAQxB,SAASC,UACnBuB,GAAQsE,QAAQ,SAGlB,IAAIzF,EAActJ,KAAKC,MAAMzP,aAAa0P,QAAQ,gBAC9C0O,EAA4D,SAA3Cpe,aAAa0P,QAAQ,kBACtC0O,IAAmBpZ,KAAKhD,MAAMoc,gBAChCpZ,KAAKvD,SAAS,CACZqX,YAAaA,EACbsF,eAAgBA,M,yCAKHI,IAEdxZ,KAAKhD,MAAMoc,gBACZI,EAAUJ,gBACoB,MAA9BnE,GAAQxB,SAASC,UAEjBuB,GAAQsE,QAAQ,W,+BAqClB,IAAI7F,EAAWuB,GAAQxB,SAASC,SAChC,OACE,cAAC,IAAD,CAAYuB,QAASA,GAArB,SACE,gCACE,0CACA,sBAAKvZ,MAAO,CAAE+I,SAAU,WAAYsE,MAAO,GAAI0Q,IAAK,IAApD,WACIzZ,KAAKhD,MAAMoc,gBACX,cAAC,EAAD,CAAO/d,kBAAmB2E,KAAK6Y,wBAEhC7Y,KAAKhD,MAAMoc,gBACV,sBAAK1d,MAAO,CAAE4G,QAAS,QAAvB,UACE,8BACE,0CAAatC,KAAKhD,MAAM8W,YAAY4F,UAApC,SAEF,qBAAKhe,MAAO,CAAE2G,WAAY,OAA1B,SACE,cAAC,EAAD,CAAQtG,mBAAoBiE,KAAKqZ,iCAMzC,qBAAI1Q,UAAU,SAAd,UACE,6BACE,cAAC,IAAD,CAAS4P,GAAG,QAAZ,oBAEDvY,KAAKhD,MAAMoc,gBACV,6BACE,cAAC,IAAD,CAASb,GAAG,UAAZ,sBAGHvY,KAAKhD,MAAMoc,gBACV,6BACE,cAAC,IAAD,CAASb,GAAG,YAAZ,2BAKN,sBAAK5P,UAAU,UAAf,UACE,cAAC,IAAD,CAAOgR,OAAK,EAACC,KAAK,IAAlB,SACG5Z,KAAKhD,MAAMoc,gBAA+B,MAAb1F,EAC5B,cAAC,IAAD,CAAU6E,GAAI7E,IAEd,cAAC,GAAD,CAAMoB,OAAQ9U,KAAKhD,MAAMoc,mBAG7B,cAAC,IAAD,CAAOQ,KAAK,QAAZ,SACE,cAAC,GAAD,CAAM9E,OAAQ9U,KAAKhD,MAAMoc,mBAE3B,cAAC,GAAD,CACEQ,KAAK,YACLxB,UAAWjC,GACXrB,OAAQ9U,KAAKhD,MAAMoc,iBAErB,cAAC,GAAD,CACEQ,KAAK,UACLxB,UAAWL,GACXjD,OAAQ9U,KAAKhD,MAAMoc,iBAErB,cAAC,GAAD,CACEQ,KAAK,YACLxB,UAAWlG,GACX4C,OAAQ9U,KAAKhD,MAAMoc,6B,GAhIftU,a,OCdlB+U,IAASvB,OACP,cAAC,GAAD,IACA3Z,SAASC,eAAe,W","file":"static/js/main.884ee7ce.chunk.js","sourcesContent":["// source: https://github.com/Sivanesh-S/react-google-authentication/blob/master/src/components/Login.js\n\nimport React from \"react\";\n\nimport { GoogleLogin } from \"react-google-login\";\nimport { refreshTokenSetup } from \"../utils/refreshToken\";\n\nfunction Login(props) {\n  const onSuccess = (res) => {\n    // console.log(\"Login Success: currentUser:\", res.profileObj);\n    refreshTokenSetup(res);\n    props.onSuccessfulLogin(res);\n  };\n\n  const onFailure = (res) => {\n    console.log(\"Attempt to login failed. Error:\", res);\n    alert(\"Login error: \" + res.error + \". \");\n  };\n\n  return (\n    <div>\n      <GoogleLogin\n        clientId={process.env.REACT_APP_GOOGLE_CLIENT_ID}\n        buttonText=\"Login\"\n        onSuccess={onSuccess}\n        onFailure={onFailure}\n        cookiePolicy={\"single_host_origin\"}\n        style={{ marginTop: \"100px\" }}\n        isSignedIn={true}\n      />\n    </div>\n  );\n}\n\nexport default Login;\n","// source: https://github.com/Sivanesh-S/react-google-authentication/blob/master/src/utils/refreshToken.js\n\nexport const refreshTokenSetup = (res) => {\n  // Timing to renew access token\n  let refreshTiming = (res.tokenObj.expires_in || 3600 - 5 * 60) * 1000;\n\n  const refreshToken = async () => {\n    const newAuthRes = await res.reloadAuthResponse();\n    refreshTiming = (newAuthRes.expires_in || 3600 - 5 * 60) * 1000;\n    console.log(\"newAuthRes:\", newAuthRes);\n    // saveUserToken(newAuthRes.access_token);  <-- save new token\n    localStorage.setItem(\"authToken\", newAuthRes.id_token);\n\n    // Setup the other timer after the first one\n    setTimeout(refreshToken, refreshTiming);\n  };\n\n  // Setup first refresh timer\n  setTimeout(refreshToken, refreshTiming);\n};\n","import React from \"react\";\nimport { GoogleLogout } from \"react-google-login\";\n\nfunction Logout(props) {\n  const onSuccess = () => {\n    // console.log('Logged out successfully');\n    // alert(\"Logged out successfully ✌\");\n    props.onSuccessfulLogout();\n  };\n\n  return (\n    <div>\n      <GoogleLogout\n        clientId={process.env.REACT_APP_GOOGLE_CLIENT_ID}\n        buttonText=\"Logout\"\n        onLogoutSuccess={onSuccess}\n      ></GoogleLogout>\n    </div>\n  );\n}\n\nexport default Logout;\n","import React, { Component } from \"react\";\nimport \"./Track.css\";\nimport Dropdown from \"react-dropdown\";\nimport \"react-dropdown/style.css\";\nimport { Confirm } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\nimport Slider from \"rc-slider\";\nimport \"rc-slider/assets/index.css\";\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\nimport HeadsetRoundedIcon from \"@material-ui/icons/HeadsetRounded\";\nimport VolumeOffRoundedIcon from \"@material-ui/icons/VolumeOffRounded\";\n\nconst FILE_UPLOAD_OPTION = \"+ Upload File\";\nconst RENAME_TRACK_OPTION = \"Rename Track\";\nconst DELETE_TRACK_OPTION = \"Delete Track\";\n\nconst options = [FILE_UPLOAD_OPTION, RENAME_TRACK_OPTION, DELETE_TRACK_OPTION];\n\nclass Track extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selected: false,\n      playing: false,\n      muted: false,\n      s3URL: null,\n      selectedTake: null,\n      latestTake: 0,\n      soloing: false,\n      volume: 84.95,\n      threeDotsAnchorElement: null,\n    };\n    this.audioFile = null;\n    if (Object.keys(props.takes).length !== 0) {\n      const latestKey = Object.keys(props.takes).pop();\n      const url = props.takes[latestKey].s3_info;\n      if (url) {\n        this.state.s3URL = url;\n        this.state.selectedTake = latestKey;\n        this.audioFile = document.getElementById(\n          `audio-file-${this.props.trackId}`\n        );\n      }\n    }\n    this.deleteTake = this.deleteTake.bind(this);\n  }\n\n  componentDidMount() {\n    // if this track has takes and the page refreshed, select most recent take\n    if (Object.keys(this.props.takes).length !== 0) {\n      const latestKey = Object.keys(this.props.takes).pop();\n      const url = this.props.takes[latestKey].s3_info;\n      if (url) {\n        this.setState({\n          s3URL: url,\n          selectedTake: latestKey,\n          latestTake: latestKey,\n        });\n        this.audioFile = document.getElementById(\n          `audio-file-${this.props.trackId}`\n        );\n      }\n      // otherwise reset the take state\n    } else {\n      this.setState({\n        selectedTake: null,\n        s3URL: null,\n        latestTake: 0,\n      });\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    // set audio file\n    if (this.state.s3URL && this.audioFile === null) {\n      this.audioFile = document.getElementById(\n        `audio-file-${this.props.trackId}`\n      );\n    } else if (this.state.s3URL === null && this.audioFile !== null) {\n      this.audioFile = null;\n    }\n\n    // unselect selected track if a different track is selected\n    if (\n      this.state.selected &&\n      this.props.selectedTrackId !== this.props.trackId\n    ) {\n      this.setState({ selected: false });\n    }\n\n    // if no take is currently selected and # of states updated\n    if (\n      (this.state.selectedTake === null ||\n        this.state.latestTake !== Object.keys(this.props.takes).pop()) &&\n      Object.keys(this.props.takes).length !== 0\n    ) {\n      const latestKey = Object.keys(this.props.takes).pop();\n      const url = this.props.takes[latestKey].s3_info;\n      if (url) {\n        this.setState({\n          latestTake: latestKey,\n          selectedTake: latestKey,\n          s3URL: url,\n        });\n      }\n    } else if (Object.keys(this.props.takes).length === 0 && this.state.s3URL) {\n      this.setState({\n        selectedTake: null,\n        s3URL: null,\n        latestTake: 0,\n      });\n    }\n\n    // play non-selected track during recording or stop if DAW master controls indicate\n    if (\n      this.props.masterPlay &&\n      this.audioFile &&\n      !this.state.playing &&\n      (!this.state.selected ||\n        (this.state.selected && !this.props.masterRecord))\n    ) {\n      console.log(\n        `[TRACK: ${this.props.trackName}] playing: ${this.state.s3URL}`\n      );\n      this.audioFile.currentTime = 0;\n      this.audioFile.play();\n      this.setState({ playing: true });\n    } else if (this.props.masterStop && this.audioFile && this.state.playing) {\n      this.audioFile.pause();\n      this.setState({ playing: false });\n    }\n\n    // update soloing\n    if (\n      !this.state.soloing &&\n      this.props.soloTracks.length !== 0 &&\n      !this.state.muted &&\n      this.state.s3URL\n    ) {\n      this.audioFile.muted = true;\n      this.setState({\n        muted: true,\n      });\n    } else if (\n      this.props.soloTracks.length === 0 &&\n      this.state.muted &&\n      this.state.s3URL &&\n      prevProps.soloTracks.length !== 0\n    ) {\n      this.audioFile.muted = false;\n      this.setState({\n        muted: false,\n      });\n    }\n\n    if (\n      this.state.s3URL &&\n      prevProps.masterVolume !== this.props.masterVolume\n    ) {\n      this.audioFile.volume = Math.min(1, this.props.masterVolume);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.audioFile) {\n      this.audioFile.pause();\n    }\n  }\n\n  // playPauseAudio = () => {\n  //   if (this.state.playing) {\n  //     this.audioFile.pause();\n  //     this.setState({ playing: false });\n  //   } else {\n  //     this.audioFile.play();\n  //     this.setState({ playing: true });\n  //   }\n  // };\n\n  stop = () => {\n    this.audioFile.currentTime = 0;\n    this.audioFile.pause();\n    this.setState({ playing: false });\n  };\n\n  changeVolume = (value) => {\n    const volume = value;\n    this.audioFile.volume = (this.props.masterVolume / 100) * volume;\n    this.setState({ volume: volume });\n  };\n\n  seek = (value) => {\n    this.audioFile.currentTime = value;\n    this.audioFile.pause();\n    if (this.state.playing) {\n      this.audioFile.play();\n    }\n  };\n\n  fastForward = () => {\n    this.audioFile.pause();\n    const duration = this.audioFile.duration();\n    const currentSeek = this.audioFile.currentTime;\n    const forwardTo = currentSeek + 5;\n    if (forwardTo >= duration) {\n      this.audioFile.currentTime = 0;\n      this.audioFile.pause();\n      return;\n    }\n    console.log(\"ff: \" + currentSeek + \" -> \" + forwardTo);\n    this.audioFile.currentTime = forwardTo;\n    if (this.state.playing) {\n      this.audioFile.play();\n    }\n  };\n\n  rewind = () => {\n    this.audioFile.pause();\n    const currentSeek = this.audioFile.currentTime;\n    let backwardTo = currentSeek - 5;\n    if (backwardTo <= 0) {\n      backwardTo = 0;\n    }\n    console.log(\"rewind: \" + currentSeek + \" -> \" + backwardTo);\n    this.audioFile.currentTime = backwardTo;\n    if (this.state.playing) {\n      this.audioFile.play();\n    }\n  };\n\n  mute = () => {\n    this.props.updateMutedTracks(this.props.trackId);\n    this.audioFile.muted = !this.state.muted;\n    this.setState({\n      muted: !this.state.muted,\n    });\n  };\n\n  solo = () => {\n    this.props.updateSoloTracks(this.props.trackId);\n    if (!this.state.soloing) {\n      this.audioFile.muted = false;\n      this.setState({\n        soloing: true,\n        muted: false,\n      });\n    } else {\n      this.setState({\n        soloing: false,\n      });\n    }\n  };\n\n  selectToRecord = () => {\n    const updatedTrackId = !this.state.selected ? this.props.trackId : null;\n    this.props.setSelectedTrack(updatedTrackId);\n    this.setState({ selected: !this.state.selected });\n  };\n\n  _onSelect = (option) => {\n    console.log(\"Selected \" + option.label);\n    this.audioFile.currentTime = 0;\n    this.audioFile.pause();\n    const url = this.props.takes[option.value].s3_info;\n    this.setState({\n      playing: false,\n      selectedTake: option.value,\n      s3URL: url,\n    });\n    this.audioFile = document.getElementById(\n      `audio-file-${this.props.trackId}`\n    );\n  };\n\n  async deleteTake() {\n    console.log(\"deleting take\");\n    const targetTake = this.state.selectedTake;\n    const takeInfo = this.props.takes[targetTake];\n    let d;\n    if (takeInfo[\"date_uploaded\"].lastIndexOf(\" \") !== -1) {\n      d = new Date(\n        takeInfo[\"date_uploaded\"].substr(\n          0,\n          takeInfo[\"date_uploaded\"].lastIndexOf(\" \") + 1\n        )\n      );\n    } else {\n      d = new Date(takeInfo[\"date_uploaded\"]);\n    }\n    const formattedDateTime = d.toLocaleString(\"en-US\");\n\n    const name = `Take ${targetTake} - ${formattedDateTime}`;\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Take\"\n    );\n    if (result) {\n      if (this.audioFile) {\n        this.audioFile.currentTime = 0;\n        this.audioFile.pause();\n      }\n      await this.props.deleteTake(this.props.trackId, targetTake, takeInfo.id);\n\n      let newSelectedTake = null;\n      if (Object.keys(this.props.takes).length > 1) {\n        const takeCopy = Object.keys(this.props.takes);\n        takeCopy.splice(takeCopy.indexOf(targetTake), 1);\n        newSelectedTake = Math.max.apply(Math, takeCopy);\n        const newURL = this.props.takes[newSelectedTake].s3_info;\n        this.setState({\n          playing: false,\n          selectedTake: newSelectedTake,\n          s3URL: newURL,\n          latestTake: newSelectedTake,\n        });\n      } else {\n        console.log(\"unsetting audio file\");\n        this.setState({\n          playing: false,\n          selectedTake: newSelectedTake,\n          s3URL: null,\n          latestTake: 0,\n        });\n      }\n    }\n  }\n\n  clickThreeDotsMenu = (e) => {\n    this.setState({ threeDotsAnchorElement: e.currentTarget });\n  };\n\n  closeThreeDotsMenu = (e) => {\n    const option = e.target.innerText;\n    if (option === FILE_UPLOAD_OPTION) {\n      document.getElementById(`file-upload-${this.props.trackId}`).click();\n    } else if (option === RENAME_TRACK_OPTION) {\n      this.props.renameTrack(this.props.trackId, this.props.trackName);\n    } else if (option === DELETE_TRACK_OPTION) {\n      this.props.deleteTrack(this.props.trackId, this.props.trackName);\n    }\n    this.setState({ threeDotsAnchorElement: null });\n  };\n\n  render() {\n    let selectedKeyValue = { value: this.state.selectedTake };\n    const takeDropdownOptions = Object.keys(this.props.takes)\n      .reduce((acc, take) => {\n        if (parseInt(take) <= parseInt(this.state.latestTake)) {\n          const rawDate = this.props.takes[take][\"date_uploaded\"];\n          const d = new Date(rawDate);\n          const formattedDateTime = d.toLocaleString(\"en-US\");\n          if (take === this.state.selectedTake) {\n            selectedKeyValue[\"label\"] = `Take ${take} - ${formattedDateTime}`;\n          }\n          acc.push({\n            value: take,\n            label: `Take ${take} - ${formattedDateTime}`,\n          });\n        }\n        return acc;\n      }, [])\n      .reverse();\n\n    const buttonSelectText = this.state.selected\n      ? \"Unselect\"\n      : \"Select to Record\";\n\n    return (\n      <div style={{ marginLeft: \"5px\" }}>\n        <hr />\n        <div>\n          {this.state.selected ? (\n            <div style={{ display: \"inline-block\" }}>\n              <img\n                src=\"images/daw/selected.png\"\n                alt=\"selected\"\n                width=\"10\"\n                height=\"10\"\n              />{\" \"}\n              <b>Track: {this.props.trackName}</b>{\" \"}\n            </div>\n          ) : (\n            <div style={{ display: \"inline-block\" }}>\n              Track: {this.props.trackName}{\" \"}\n            </div>\n          )}\n          <button\n            title=\"Select/unselect track for recording\"\n            onClick={this.selectToRecord}\n            style={{ marginLeft: \"5px\" }}\n          >\n            {buttonSelectText}\n          </button>\n          <IconButton\n            aria-label=\"more\"\n            aria-controls=\"track-menu\"\n            aria-haspopup=\"true\"\n            onClick={this.clickThreeDotsMenu}\n            style={{ marginLeft: \"5px\" }}\n          >\n            <MoreHorizIcon />\n          </IconButton>\n          <input\n            type=\"file\"\n            id={`file-upload-${this.props.trackId}`}\n            hidden\n            onChange={(e) => {\n              this.props.handleFileUpload(e.target.files, this.props.trackId);\n            }}\n          />\n          <Menu\n            id=\"track-menu\"\n            anchorEl={this.state.threeDotsAnchorElement}\n            keepMounted\n            open={this.state.threeDotsAnchorElement !== null}\n            onClose={this.closeThreeDotsMenu}\n            PaperProps={{\n              style: {\n                maxHeight: 40 * 4.5,\n                width: \"20ch\",\n              },\n            }}\n          >\n            {options.map((option) => (\n              <MenuItem key={option} onClick={this.closeThreeDotsMenu}>\n                {option}\n              </MenuItem>\n            ))}\n          </Menu>\n        </div>\n        {this.state.s3URL && Object.keys(this.props.takes).length > 0 && (\n          <div style={{ marginBottom: \"18px\", marginTop: \"-12px\" }}>\n            <Tooltip title=\"Mute\" arrow>\n              <IconButton\n                disableRipple\n                aria-label=\"Mute this track\"\n                onClick={this.mute}\n                style={{ marginTop: \"5px\" }}\n              >\n                {this.state.muted ? (\n                  <VolumeOffRoundedIcon\n                    style={{ fontSize: 20 }}\n                    color=\"secondary\"\n                  />\n                ) : (\n                  <VolumeOffRoundedIcon style={{ fontSize: 20 }} />\n                )}\n              </IconButton>\n            </Tooltip>\n            <Tooltip title=\"Solo\" arrow>\n              <IconButton\n                disableRipple\n                aria-label=\"Solo this track\"\n                onClick={this.solo}\n                style={{ marginTop: \"5px\" }}\n              >\n                {this.state.soloing ? (\n                  <HeadsetRoundedIcon\n                    style={{ fontSize: 20 }}\n                    color=\"secondary\"\n                  />\n                ) : (\n                  <HeadsetRoundedIcon style={{ fontSize: 20 }} />\n                )}\n              </IconButton>\n            </Tooltip>\n            <div\n              style={{\n                display: \"inline-block\",\n                marginLeft: \"10px\",\n                marginRight: \"10px\",\n                width: \"55px\",\n              }}\n            >\n              Volume\n              <Slider\n                min={0}\n                max={100}\n                defaultValue={100}\n                onChange={this.changeVolume}\n              />\n            </div>\n\n            <audio\n              id={`audio-file-${this.props.trackId}`}\n              src={`${this.state.s3URL}?cacheblock=true`}\n              preload=\"auto\"\n              autobuffer=\"true\"\n            />\n\n            <div\n              style={{\n                marginLeft: \"20px\",\n                marginTop: \"10px\",\n                display: \"inline-flex\",\n                position: \"absolute\",\n                width: 310,\n              }}\n            >\n              <Dropdown\n                options={takeDropdownOptions}\n                onChange={this._onSelect}\n                value={selectedKeyValue}\n                placeholder=\"Select an option\"\n              />\n            </div>\n            <div\n              style={{\n                display: \"inline-flex\",\n                position: \"absolute\",\n                marginLeft: \"330px\",\n                marginTop: \"15px\",\n              }}\n            >\n              <form method=\"get\" action={`${this.state.s3URL}?cacheblock=true`}>\n                <button type=\"submit\">Download Take</button>\n              </form>\n              <button\n                disabled={this.props.masterPlay}\n                onClick={this.deleteTake}\n              >\n                Delete Take\n              </button>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default Track;\n","import React, { Component } from \"react\";\n\nclass LoadingGif extends Component {\n  render() {\n    return (\n      <div style={{ display: \"flex\", marginBottom: \"-8px\" }}>\n        <img\n          style={{\n            marginLeft: \"10px\",\n            marginRight: \"5px\",\n            marginTop: \"10px\",\n          }}\n          src=\"images/daw/loading.gif\"\n          alt=\"loading\"\n          width=\"32\"\n          height=\"32\"\n        />\n\n        <p>{` ${this.props.text}`}</p>\n      </div>\n    );\n  }\n}\n\nexport default LoadingGif;\n","import {\n  useDialog,\n  ModalContent,\n  ModalFooter,\n  ModalButton,\n  Confirm,\n} from \"react-st-modal\";\nimport { useState, useEffect, useCallback } from \"react\";\nimport \"./AlignRecording.css\";\nimport LoadingGif from \"./LoadingGif\";\nimport WaveSurfer from \"wavesurfer.js\";\nimport Draggable from \"react-draggable\";\nimport Crunker from \"crunker\"; // https://github.com/jackedgson/crunker\n\nexport default function AlignRecordingModalContent(props) {\n  const dialog = useDialog();\n\n  const [isPlaying, setPlaying] = useState(false);\n  const [playbackTimer, setPlaybackTimer] = useState(null);\n  const [delayPlaybackTimer, setDelayPlaybackTimer] = useState(null);\n  const [bgWaveSurfer, setBgWaveSurfer] = useState(null);\n  const [recWaveSurfer, setRecWaveSurfer] = useState(null);\n  const [loadedAudio, setLoadedAudio] = useState(false);\n  const [mixedBackingTrackURL, setMixedBackingTrackURL] = useState(null);\n\n  const [dragOffset, setDragOffset] = useState(0);\n  const [latencyMagnitude, setLatencyMagnitude] = useState(0);\n\n  const onStopDrag = useCallback((_, position) => {\n    console.log(\"stopped:\", position.x);\n    const latency = 12.5053 * position.x + 7.3617;\n    console.log(latency);\n    setDragOffset(position.x);\n    setLatencyMagnitude(latency);\n  }, []);\n\n  useEffect(() => {\n    setBgWaveSurfer(\n      WaveSurfer.create({\n        container: \"#bg_waveform\",\n        waveColor: \"#D9DCFF\",\n        progressColor: \"#4353ff\",\n        cursorColor: \"#4353ff\",\n        cursorWidth: 1,\n        height: 200,\n        width: 1000,\n        interact: false,\n        hideScrollbar: true,\n      })\n    );\n    setRecWaveSurfer(\n      WaveSurfer.create({\n        container: \"#rec_waveform\",\n        waveColor: \"#D9DCFF\",\n        progressColor: \"#4353ff\",\n        cursorColor: \"#4353ff\",\n        cursorWidth: 1,\n        height: 200,\n        width: 1000,\n        interact: false,\n        hideScrollbar: true,\n      })\n    );\n  }, []);\n\n  useEffect(() => {\n    if (bgWaveSurfer && recWaveSurfer && dialog && !dialog.isOpen) {\n      bgWaveSurfer.stop();\n      recWaveSurfer.stop();\n    }\n  }, [bgWaveSurfer, recWaveSurfer, loadedAudio, dialog]);\n\n  useEffect(() => {\n    if (bgWaveSurfer && recWaveSurfer && !loadedAudio) {\n      const crunker = new Crunker();\n      let nonRecordedTrackURLs = Object.keys(props.trackMetadata)\n        .filter((trackId) => {\n          // only include unmuted tracks that are: 1) not the recorded track and 2) have recordings\n          return (\n            trackId !== props.recordedTrackId &&\n            !props.mutedTracks.includes(trackId) &&\n            Object.keys(props.trackMetadata[trackId].takes).length > 0\n          );\n        })\n        .map((trackId) => {\n          // TODO: made executive decision to just pick latest track, but eventually need to fix how take state is stored so DAW Object can access it\n          const takeId = Object.keys(props.trackMetadata[trackId].takes).pop();\n          const audio_url =\n            props.trackMetadata[trackId].takes[takeId].s3_info +\n            \"?cacheblock=true\";\n          console.log(\"audio url:\" + audio_url);\n          return audio_url;\n        });\n      console.log(\n        \"audio alignment tool: # tracks stacked together = \" +\n          nonRecordedTrackURLs.length\n      );\n      // only combine audio if necessary\n      if (nonRecordedTrackURLs.length > 1) {\n        console.log(\"using crunker to combine recordings\");\n        crunker\n          .fetchAudio(...nonRecordedTrackURLs)\n          .then((buffers) => {\n            // => [AudioBuffer, AudioBuffer]\n            return crunker.mergeAudio(buffers);\n          })\n          .then((merged) => {\n            // => AudioBuffer\n            return crunker.export(merged, \"audio/mp3\");\n          })\n          .then((output) => {\n            // => {blob, element, url}\n            setMixedBackingTrackURL(output.url);\n            bgWaveSurfer.load(output.url);\n            recWaveSurfer.load(props.recordedURL);\n\n            bgWaveSurfer.setVolume(0.3);\n            recWaveSurfer.setVolume(0.3);\n\n            bgWaveSurfer.zoom(80);\n            recWaveSurfer.zoom(80);\n            setLoadedAudio(true);\n          });\n      } else {\n        console.log(\"using single track as backing track\");\n        setMixedBackingTrackURL(nonRecordedTrackURLs[0]);\n        bgWaveSurfer.load(nonRecordedTrackURLs[0]);\n        recWaveSurfer.load(props.recordedURL);\n\n        bgWaveSurfer.setVolume(0.3); // TODO\n        recWaveSurfer.setVolume(0.3);\n\n        bgWaveSurfer.zoom(80);\n        recWaveSurfer.zoom(80);\n        setLoadedAudio(true);\n      }\n    }\n  }, [bgWaveSurfer, recWaveSurfer, loadedAudio, props]); // TODO check\n\n  return (\n    <div className=\"outerDiv\">\n      <div>\n        <Draggable axis=\"x\" bounds={{ left: -285, right: 285 }}>\n          <div className=\"cursor\">\n            <div className=\"point\" />\n            <div className=\"startLine\" />\n          </div>\n        </Draggable>\n        <ModalContent>\n          {!loadedAudio ? (\n            <LoadingGif text={\"Preparing alignment tool...\"} />\n          ) : (\n            <p>\n              Drag your recording left/right to align it, and move the cursor\n              like a ruler to align peaks!\n            </p>\n          )}\n          <p>\n            <b>Backing Tracks</b>\n          </p>\n          <div id=\"bg_waveform\"></div>\n          <p>\n            <b>Recording</b>\n          </p>\n          <Draggable axis=\"x\" onStop={onStopDrag}>\n            <div id=\"rec_waveform\" style={{ marginLeft: \"-240px\" }}></div>\n          </Draggable>\n        </ModalContent>\n        <ModalFooter>\n          {/* <ModalButton\n            onClick={async () => {\n              console.log(\"downloading backing track\");\n              const link = document.createElement(\"a\");\n              link.href = mixedBackingTrackURL;\n              const d = new Date();\n              const datestring = `${d.getFullYear()}_${\n                d.getMonth() + 1\n              }_${d.getDate()}`;\n              const timestring = `${d.getHours()}_${d.getMinutes()}_${d.getDate()}_${\n                d.getHours() >= 12 ? \"PM\" : \"AM\"\n              }`;\n              const outputFilename = `backingtrackmix_${datestring}-${timestring}`;\n              link.setAttribute(\"download\", outputFilename);\n\n              document.body.appendChild(link); // Append to html link element page\n              link.click(); // Start download\n              link.parentNode.removeChild(link); // Clean up and remove the link\n            }}\n            type={\"light\"}\n          >\n            Download Backing\n          </ModalButton> */}\n          <ModalButton\n            onClick={async () => {\n              // Сlose the dialog and return the value\n              bgWaveSurfer.stop();\n              recWaveSurfer.stop();\n              clearTimeout(playbackTimer);\n              const result = await Confirm(\n                `Are you sure you want to scrap this recording?`,\n                \"Scrap Recording\"\n              );\n              if (result) {\n                console.log(\"scrapping recording\");\n                dialog.close(\"scrap\");\n              }\n            }}\n            type={\"danger\"}\n          >\n            Scrap Recording\n          </ModalButton>\n          <ModalButton\n            onClick={() => {\n              if (isPlaying) {\n                bgWaveSurfer.pause();\n                recWaveSurfer.pause();\n                clearTimeout(playbackTimer);\n                clearTimeout(delayPlaybackTimer);\n              } else {\n                console.log(\"offset:\", dragOffset);\n\n                bgWaveSurfer.params.scrollParent = false;\n                recWaveSurfer.params.scrollParent = false;\n\n                bgWaveSurfer.seekTo(0);\n                recWaveSurfer.seekAndCenter(3 / recWaveSurfer.getDuration());\n\n                if (dragOffset > 0) {\n                  console.log(\"[recorded early]: user wants to playback later\");\n                  console.log(latencyMagnitude);\n                  setPlaybackTimer(\n                    setTimeout(() => {\n                      setPlaying(false);\n                    }, 7000)\n                  );\n                  bgWaveSurfer.play(null, 7);\n                  setDelayPlaybackTimer(\n                    setTimeout(() => {\n                      recWaveSurfer.play(3, 10 - latencyMagnitude / 1000);\n                    }, latencyMagnitude)\n                  );\n                } else if (dragOffset < 0) {\n                  console.log(\n                    \"[recorded late]: user wants to playback earlier\"\n                  );\n                  const latency = -latencyMagnitude;\n                  console.log(latency);\n                  setPlaybackTimer(\n                    setTimeout(() => {\n                      setPlaying(false);\n                    }, 7000)\n                  );\n                  bgWaveSurfer.play(null, 7);\n                  recWaveSurfer.play(3 + latency / 1000, 10 + latency / 1000);\n                } else {\n                  setPlaybackTimer(\n                    setTimeout(() => {\n                      setPlaying(false);\n                    }, 7000)\n                  );\n                  bgWaveSurfer.play(null, 7);\n                  recWaveSurfer.play(3, 10);\n                }\n              }\n              setPlaying(!isPlaying);\n            }}\n          >\n            {!isPlaying ? \"Play\" : \"Stop\"}\n          </ModalButton>\n          <ModalButton\n            onClick={() => {\n              // Сlose the dialog and return the value\n              bgWaveSurfer.stop();\n              recWaveSurfer.stop();\n              clearTimeout(playbackTimer);\n              console.log(\"returning value:\", latencyMagnitude);\n              dialog.close(Math.round(latencyMagnitude));\n            }}\n          >\n            Submit\n          </ModalButton>\n        </ModalFooter>\n      </div>\n    </div>\n  );\n}\n","import React, { Component } from \"react\";\nimport \"./DAW.css\";\nimport Track from \"./Track\";\nimport LoadingGif from \"./LoadingGif\";\nimport { CountdownCircleTimer } from \"react-countdown-circle-timer\";\nimport { CustomDialog, Confirm } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\nimport AlignRecordingModalContent from \"./AlignRecording\";\nimport Slider from \"rc-slider\";\nimport \"rc-slider/assets/index.css\";\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport GetAppIcon from \"@material-ui/icons/GetApp\";\nimport PlayArrowRoundedIcon from \"@material-ui/icons/PlayArrowRounded\";\nimport StopRoundedIcon from \"@material-ui/icons/StopRounded\";\nimport FiberManualRecordRoundedIcon from \"@material-ui/icons/FiberManualRecordRounded\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport Crunker from \"crunker\";\n\nimport { socket } from \"../../../App\";\n\nconst AudioContext = window.AudioContext || window.webkitAudioContext;\nconst WebAudioRecorder = window.WebAudioRecorder; // https://github.com/higuma/web-audio-recorder-js\nconst crunker = new Crunker();\n\nclass DAW extends Component {\n  constructor() {\n    super();\n    this.state = {\n      masterPlay: false,\n      masterStop: false,\n      masterRecord: false,\n      isRecording: false,\n      selectedTrackId: null, // to record\n      isBlocked: true,\n      showCountdown: false,\n      runningTime: 0,\n      mutedTracks: [],\n      soloTracks: [],\n      masterVolume: 0.5,\n      initialLoad: true,\n      isRehearsing: false,\n      stopMicProcessing: false,\n      requestingGroupRecord: false,\n      requestingGroupPlayback: false,\n      receivedImmediateStop: false,\n      numGroupMembersPrepared: 1,\n      numGroupMembersTotal: 1,\n      preparedGroupAction: null,\n    };\n    this.audioContext = null;\n    this.gumStream = null;\n    this.input = null;\n    this.recorder = null;\n    this.toggleMasterRecord = this.toggleMasterRecord.bind(this);\n    this.toggleMasterStop = this.toggleMasterStop.bind(this);\n    this.stopMicrophone = this.stopMicrophone.bind(this);\n  }\n\n  // SOCKET IO LISTENERS:\n\n  beginGroupPlayListener = () => {\n    console.log(\"[SOCKET.IO] receiving begin group play\");\n    this.toggleMasterPlay();\n    this.setState({\n      requestingGroupPlayback: false,\n      preparedGroupAction: null,\n    });\n  };\n\n  beginGroupStopListener = (data) => {\n    console.log(\n      \"[SOCKET.IO] receiving begin group stop for \" + this.props.projectName\n    );\n    if (!this.state.receivedImmediateStop) {\n      this.setState({ receivedImmediateStop: true });\n      this.toggleMasterStop();\n      const username = JSON.parse(localStorage.getItem(\"userDetails\")).name;\n      if (typeof data.stopped_by === \"string\" && data.stopped_by !== username) {\n        alert(`${data.stopped_by} stopped!`);\n      }\n    }\n  };\n\n  beginGroupRecordListener = () => {\n    console.log(\"[SOCKET.IO] receiving begin group record\");\n    this.toggleMasterRecord();\n    this.setState({ requestingGroupRecord: false, preparedGroupAction: null });\n  };\n\n  updateNumPreparedListener = (data) => {\n    console.log(\"[SOCKET.IO] updating number of prepared group members\");\n    this.setState({\n      numGroupMembersPrepared: data.num_prepared,\n      numGroupMembersTotal: data.num_total,\n      preparedGroupAction: data.action,\n    });\n  };\n\n  notifyWaitingGroupMember = async (data) => {\n    console.log(\n      \"[SOCKET.IO] received request from group member \" +\n        data.requester +\n        \" to request \" +\n        data.action\n    );\n    const readyToJoin = await Confirm(\n      `${data.requester} wants to group ${data.action}. Ready to join?`,\n      \"Incoming Request\",\n      \"Yes\",\n      \"No\"\n    );\n    if (readyToJoin) {\n      console.log(`[SOCKET.IO] ready to join for ${data.action}!`);\n      if (data.action === \"play\") {\n        this.requestGroupPlay();\n      } else {\n        this.requestGroupRecord();\n      }\n    } else {\n      console.log(`[SOCKET.IO] not ready to join for ${data.action}...`);\n      this.setState({ preparedGroupAction: data.action });\n    }\n  };\n\n  // REACT MAIN FUNCTIONS:\n\n  componentDidMount() {\n    navigator.mediaDevices\n      .getUserMedia({ audio: true })\n      .then(() => {\n        console.log(\"mic permission granted\");\n        this.setState({ isBlocked: false });\n      })\n      .catch(() => {\n        console.log(\"MIC PERMISSIOM DENIED\");\n        this.setState({ isBlocked: true });\n      });\n\n    this.setState({\n      isRecording: false,\n      masterRecord: false,\n      selectedTrackId: null,\n      soloTracks: [],\n      mutedTracks: [],\n    });\n\n    // create socket io listeners + keyboard input (spacebar) listener\n    console.log(\n      `[SOCKET.IO] ${this.props.projectName} | creating DAW listeners`\n    );\n    socket.on(\"beginGroupPlay\", this.beginGroupPlayListener);\n    socket.on(\"beginGroupStop\", this.beginGroupStopListener);\n    socket.on(\"beginGroupRecord\", this.beginGroupRecordListener);\n    socket.on(\"updateNumPrepared\", this.updateNumPreparedListener);\n    socket.on(\"notifyWaitingGroupMember\", this.notifyWaitingGroupMember);\n    document.body.addEventListener(\"keypress\", this.createAnnotation);\n  }\n\n  componentDidUpdate() {\n    if (this.state.initialLoad) {\n      if (Object.keys(this.props.trackMetadata).length === 0) {\n        this.createTrack();\n      }\n      this.setState({ initialLoad: false });\n    }\n    if (this.state.masterPlay && this.state.masterStop) {\n      this.setState({\n        masterPlay: false,\n        masterStop: false,\n        runningTime: 0,\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    // remove socket io listeners + keyboard input (spacebar) listener\n    console.log(\n      `[SOCKET.IO] ${this.props.projectName} | removing DAW listeners`\n    );\n    socket.off(\"beginGroupPlay\", this.beginGroupPlayListener);\n    socket.off(\"beginGroupStop\", this.beginGroupStopListener);\n    socket.off(\"beginGroupRecord\", this.beginGroupRecordListener);\n    socket.off(\"updateNumPrepared\", this.updateNumPreparedListener);\n    socket.off(\"notifyWaitingGroupMember\", this.notifyWaitingGroupMember);\n    document.body.removeEventListener(\"keypress\", this.createAnnotation);\n  }\n\n  // TRACK OPERATIONS\n\n  createTrack = () => {\n    this.props.createTrack();\n  };\n\n  renameTrack = (id, name) => {\n    this.props.renameTrack(id, name);\n  };\n\n  deleteTrack = (id, name) => {\n    const successfulDelete = this.props.deleteTrack(id, name);\n    if (successfulDelete) {\n      this.setState({ selectedTrackId: null });\n    }\n  };\n\n  // TAKE OPERATIONS\n\n  createTake = (track_id, file, is_manual_upload, latency = 0) => {\n    this.props.createTake(track_id, file, is_manual_upload, latency);\n  };\n\n  deleteTake = (track_id, take_number, take_id) => {\n    this.props.deleteTake(track_id, take_number, take_id);\n  };\n\n  // PLAYBACK OPERATIONS\n\n  toggleMasterPlay = () => {\n    console.log(\"> master play\");\n    if (this.state.masterPlay) {\n      return;\n    }\n    this.setState((state) => {\n      const startTime = Date.now() - this.state.runningTime;\n      this.timer = setInterval(() => {\n        this.setState({ runningTime: Date.now() - startTime });\n      });\n      return { masterPlay: true };\n    });\n  };\n\n  toggleMasterStop() {\n    console.log(\"> master stop\");\n    clearInterval(this.timer);\n    if (!this.state.masterPlay) {\n      return;\n    }\n    if (!this.state.isRecording) {\n      this.setState({\n        masterStop: true,\n        runningTime: 0,\n        receivedImmediateStop: false,\n      });\n    } else {\n      this.setState({\n        masterStop: true,\n        runningTime: 0,\n        stopMicProcessing: true,\n        receivedImmediateStop: false,\n      });\n      //stop microphone access\n      this.gumStream.getAudioTracks()[0].stop();\n      this.recorder.finishRecording();\n    }\n  }\n\n  // https://codesandbox.io/s/v67oz43lm7?file=/src/index.js\n  async toggleMasterRecord() {\n    console.log(\"> master record\");\n    if (this.state.selectedTrackId === null) {\n      alert(\"Select a track to record!\");\n    } else {\n      console.log(\"recording track \" + this.state.selectedTrackId);\n      this.startMicrophone();\n      this.setState((state) => {\n        return {\n          masterRecord: true,\n          showCountdown: true,\n          isRecording: true,\n        };\n      });\n    }\n  }\n\n  startMicrophone = () => {\n    console.log(\"[RECORDING] start microphone\");\n    this.audioContext = new AudioContext();\n    navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {\n      console.log(\n        \"[RECORDING] getUserMedia() success, stream created, initializing WebAudioRecorder...\"\n      );\n      this.gumStream = stream;\n\n      /* use the stream */\n      this.input = this.audioContext.createMediaStreamSource(stream);\n\n      this.recorder = new WebAudioRecorder(this.input, {\n        workerDir: \"js/\", // must end with slash\n        encoding: \"mp3\",\n        numChannels: 2, //2 is the default, mp3 encoding supports only 2\n      });\n\n      this.recorder.setOptions({\n        timeLimit: 600,\n        encodeAfterRecord: true,\n        mp3: { bitRate: 256 },\n      });\n\n      this.recorder.onComplete = async (recorder, blob) => {\n        console.log(\"[RECORDING] encoding complete\");\n        this.gumStream.getAudioTracks()[0].stop();\n        await this.stopMicrophone(blob);\n      };\n\n      this.recorder.startRecording();\n    });\n  };\n\n  async stopMicrophone(blob) {\n    console.log(\"[RECORDING] stopping microphone\");\n    let file = new File(\n      [blob],\n      `recording_track_${this.state.selectedTrackId}.mp3`\n    );\n    let recordedURL = URL.createObjectURL(file);\n    let latency = 0; // in ms\n    this.setState({ stopMicProcessing: false });\n    const numTotalTracks = Object.keys(this.props.trackMetadata).length;\n    // const mutedTracks = this.state.mutedTracks.length;\n    // console.log(\n    //   \"stopping microphone, sending these muted tracks to alignment tool:\",\n    //   this.state.mutedTracks\n    // );\n    // only align track if there is more than 1 track\n    if (numTotalTracks > 1) {\n      latency = await CustomDialog(\n        <AlignRecordingModalContent\n          recordedURL={recordedURL}\n          recordedTrackId={this.state.selectedTrackId}\n          trackMetadata={this.props.trackMetadata}\n          mutedTracks={this.state.mutedTracks}\n        />,\n        {\n          title: \"Check Recording\",\n          showCloseIcon: true,\n          isCanClose: false,\n        }\n      );\n      // delete recording instead\n      if (latency === \"scrap\") {\n        this.setState({\n          isRecording: false,\n          masterRecord: false,\n        });\n        return;\n      }\n    }\n    const isManualUpload = false;\n    this.createTake(this.state.selectedTrackId, file, isManualUpload, latency);\n    this.setState({\n      isRecording: false,\n      masterRecord: false,\n    });\n  }\n\n  handleFileUpload = (files, targetId) => {\n    console.log(\"handling file upload for target track id\", targetId);\n    if (\n      files === null ||\n      files[0] === null ||\n      typeof files[0] === \"undefined\"\n    ) {\n      return;\n    }\n    if (/\\.(mp3|ogg|wav|flac|aac|aiff|m4a)$/i.test(files[0].name)) {\n      console.log(\"> validated file: \", files[0].name);\n      const isManualUpload = true;\n      this.createTake(targetId, files[0], isManualUpload);\n    } else {\n      alert(\n        \"Please upload valid audio file type (mp3, ogg, wav, flac, aac, aiff, m4a)\"\n      );\n      return;\n    }\n  };\n\n  setSelectedTrack = (id) => {\n    const newId = id !== null ? id : null;\n    console.log(\"selecting track to record: \" + newId);\n    this.setState({ selectedTrackId: newId });\n  };\n\n  formattedTime = (ms) => {\n    let minutes = Math.floor(ms / 60000);\n    let seconds = ((ms % 60000) / 1000).toFixed(2);\n    return minutes + \":\" + (seconds < 10 ? \"0\" : \"\") + seconds;\n  };\n\n  updateSoloTracks = (trackId) => {\n    let newSoloTracks = [...this.state.soloTracks];\n    let index = newSoloTracks.indexOf(trackId);\n\n    if (index !== -1) {\n      // remove\n      newSoloTracks.splice(index, 1);\n    } else {\n      // add\n      newSoloTracks.push(trackId);\n    }\n    console.log(\"new solo tracks:\", newSoloTracks);\n    this.setState({ soloTracks: newSoloTracks });\n  };\n\n  updateMutedTracks = (trackId) => {\n    let newMutedTracks = [...this.state.mutedTracks];\n    let index = newMutedTracks.indexOf(trackId);\n\n    if (index !== -1) {\n      // remove\n      newMutedTracks.splice(index, 1);\n    } else {\n      // add\n      newMutedTracks.push(trackId);\n    }\n    console.log(\"new muted tracks:\", newMutedTracks);\n    this.setState({ mutedTracks: newMutedTracks });\n  };\n\n  changeVolume = (value) => {\n    this.setState({ masterVolume: value / 100 });\n  };\n\n  rehearse = () => {\n    console.log(\"currently rehearsing:\", this.state.isRehearsing);\n    this.setState({\n      isRehearsing: !this.state.isRehearsing,\n    });\n  };\n\n  downloadMixedTrack = () => {\n    console.log(\"downloading track\");\n    let latestTakeURLs = Object.keys(this.props.trackMetadata)\n      .filter((trackId) => {\n        const numTakes = Object.keys(this.props.trackMetadata[trackId].takes)\n          .length;\n        return numTakes !== 0;\n      })\n      .map((trackId) => {\n        const takes = this.props.trackMetadata[trackId].takes;\n        const takeId = Object.keys(takes).pop();\n        console.log(takeId);\n        return takes[takeId].s3_info + \"?cacheblock=true\";\n      });\n    console.log(latestTakeURLs);\n    crunker\n      .fetchAudio(...latestTakeURLs)\n      .then((buffers) => {\n        return crunker.mergeAudio(buffers);\n      })\n      .then((merged) => {\n        return crunker.export(merged, \"audio/mp3\");\n      })\n      .then((output) => {\n        // https://stackoverflow.com/questions/50694881/how-to-download-file-in-react-js\n        const link = document.createElement(\"a\");\n        link.href = output.url;\n        const d = new Date();\n        const datestring = `${d.getFullYear()}_${\n          d.getMonth() + 1\n        }_${d.getDate()}`;\n        const timestring = `${d.getHours()}_${d.getMinutes()}_${d.getDate()}_${\n          d.getHours() >= 12 ? \"PM\" : \"AM\"\n        }`;\n        const outputFilename = `${this.props.projectName}_${datestring}-${timestring}`;\n        link.setAttribute(\"download\", outputFilename);\n\n        document.body.appendChild(link); // Append to html link element page\n        link.click(); // Start download\n        link.parentNode.removeChild(link); // Clean up and remove the link\n      });\n  };\n\n  requestGroupPlay = () => {\n    console.log(\"[SOCKET.IO] requesting group play\");\n    socket.emit(\n      \"prepare group play\",\n      {\n        channel: this.props.projectHash,\n      },\n      (shouldPlay) => {\n        if (shouldPlay) {\n          this.toggleMasterPlay();\n        } else {\n          this.setState({\n            requestingGroupPlayback: true,\n            preparedGroupAction: \"play\",\n          });\n        }\n      }\n    );\n  };\n\n  requestGroupStop = () => {\n    console.log(\"[SOCKET.IO] request immediate group stop\");\n    const username = JSON.parse(localStorage.getItem(\"userDetails\")).name;\n    socket.emit(\"immediate group stop\", {\n      channel: this.props.projectHash,\n      user: username,\n    });\n  };\n\n  // TODO: needs to send which track it chose to record and\n  // make sure there are no conflicts with other tracks\n  requestGroupRecord = () => {\n    console.log(\"[SOCKET.IO] request group record\");\n    if (this.state.selectedTrackId === null) {\n      alert(\"Select a track before requesting group record!\");\n    } else {\n      socket.emit(\n        \"prepare group record\",\n        {\n          channel: this.props.projectHash,\n        },\n        (shouldRecord) => {\n          if (shouldRecord) {\n            this.toggleMasterRecord();\n          } else {\n            this.setState({\n              requestingGroupRecord: true,\n              preparedGroupAction: \"record\",\n            });\n          }\n        }\n      );\n    }\n  };\n\n  cancelRequest = () => {\n    console.log(\"[SOCKET.IO] cancel current request\");\n    socket.emit(\"cancel request\", { channel: this.props.projectHash }, () => {\n      this.setState({\n        requestingGroupPlayback: false,\n        requestingGroupRecord: false,\n        preparedGroupAction: null,\n      });\n    });\n  };\n\n  // seek = (value) => {\n  //   console.log(\"seek:\", value);\n  // };\n\n  createAnnotation = (event) => {\n    if (event.keyCode === 32 && this.state.masterPlay) {\n      console.log(\n        \"SPACE BAR PRESS:\" + this.formattedTime(this.state.runningTime)\n      );\n    }\n  };\n\n  render() {\n    const otherMembersOnline = this.props.numOnlineUsers > 1;\n    return (\n      <div>\n        <div>\n          {this.props.trackMetadata &&\n          Object.keys(this.props.trackMetadata).length > 0 ? (\n            Object.keys(this.props.trackMetadata).map((trackId) => {\n              const trackInfo = this.props.trackMetadata[trackId];\n              return (\n                <div key={`track_${trackId}`}>\n                  <div>\n                    <Track\n                      trackName={trackInfo.track_name}\n                      trackId={trackId}\n                      takes={trackInfo.takes}\n                      masterPlay={this.state.masterPlay}\n                      masterStop={this.state.masterStop}\n                      masterRecord={this.state.masterRecord}\n                      selectedTrackId={this.state.selectedTrackId}\n                      setSelectedTrack={this.setSelectedTrack}\n                      deleteTake={this.deleteTake}\n                      soloTracks={this.state.soloTracks}\n                      updateSoloTracks={this.updateSoloTracks}\n                      updateMutedTracks={this.updateMutedTracks}\n                      claimedTracks={this.state.claimedTracks}\n                      masterVolume={this.state.masterVolume}\n                      renameTrack={this.renameTrack}\n                      deleteTrack={this.deleteTrack}\n                      handleFileUpload={this.handleFileUpload}\n                    />\n                  </div>\n                  {Object.keys(this.props.trackMetadata[trackId].takes)\n                    .length === 0 && (\n                    <div style={{ marginTop: \"-20px\" }}>\n                      <input\n                        style={{\n                          marginLeft: \"20px\",\n                          marginTop: \"25px\",\n                          marginBottom: \"20px\",\n                        }}\n                        type=\"file\"\n                        onChange={(e) =>\n                          this.handleFileUpload(e.target.files, trackId)\n                        }\n                      />\n                    </div>\n                  )}\n                </div>\n              );\n            })\n          ) : (\n            <div style={{ marginTop: \"10px\" }} />\n          )}\n        </div>\n        <button\n          style={{ marginTop: \"10px\", marginLeft: \"5px\", marginBottom: \"28px\" }}\n          className=\"stitched\"\n          onClick={this.createTrack}\n        >\n          + New Track\n        </button>\n        <div style={{ display: \"flex\" }}>\n          <p style={{ marginBottom: \"5px\" }}>\n            <b>Master Controls</b>\n          </p>\n          {otherMembersOnline && (\n            <button\n              style={{ marginLeft: \"10px\" }}\n              onClick={this.requestGroupRecord}\n              disabled={\n                this.state.masterPlay ||\n                this.state.requestingGroupRecord ||\n                this.state.requestingGroupPlayback\n              }\n            >\n              {this.state.requestingGroupRecord ? \"waiting...\" : \"group record\"}\n            </button>\n          )}\n          {otherMembersOnline && (\n            <button\n              onClick={this.requestGroupStop}\n              disabled={!this.state.masterPlay}\n            >\n              group stop\n            </button>\n          )}\n          {otherMembersOnline && (\n            <button\n              onClick={this.requestGroupPlay}\n              disabled={\n                this.state.masterPlay ||\n                this.state.requestingGroupPlayback ||\n                this.state.requestingGroupRecord\n              }\n            >\n              {this.state.requestingGroupPlayback ? \"waiting...\" : \"group play\"}\n            </button>\n          )}\n          {otherMembersOnline && (\n            <button\n              onClick={this.cancelRequest}\n              disabled={\n                !this.state.requestingGroupRecord &&\n                !this.state.requestingGroupPlayback\n              }\n            >\n              cancel request\n            </button>\n          )}\n          {this.state.preparedGroupAction !== null &&\n            this.state.numGroupMembersPrepared !== 0 && (\n              <div style={{ marginLeft: \"10px\", marginTop: \"10px\" }}>\n                {this.state.numGroupMembersPrepared}/\n                {this.state.numGroupMembersTotal} ready\n                {this.state.preparedGroupAction &&\n                  ` for ${this.state.preparedGroupAction}`}\n              </div>\n            )}\n          {this.state.stopMicProcessing && (\n            <LoadingGif text={\"Saving Recording...\"} />\n          )}\n        </div>\n        {this.state.isBlocked && (\n          <p style={{ marginBottom: \"5px\" }}>\n            Please allow access to your mic to record!\n          </p>\n        )}\n        {/* TODO: Live Monitoring */}\n        <Tooltip title=\"Record selected track\" arrow>\n          <span>\n            <IconButton\n              disableRipple\n              aria-label=\"Record\"\n              onClick={this.toggleMasterRecord}\n              disabled={this.state.masterPlay || this.state.isBlocked}\n            >\n              {this.state.masterPlay || this.state.isBlocked ? (\n                <FiberManualRecordRoundedIcon style={{ fontSize: 28 }} />\n              ) : (\n                <FiberManualRecordRoundedIcon\n                  style={{ fontSize: 28 }}\n                  color=\"secondary\"\n                />\n              )}\n            </IconButton>\n          </span>\n        </Tooltip>\n        <Tooltip title={this.state.masterPlay ? \"Stop all tracks\" : \"\"} arrow>\n          <span>\n            <IconButton\n              disableRipple\n              aria-label=\"Stop\"\n              onClick={this.toggleMasterStop}\n              disabled={!this.state.masterPlay}\n            >\n              <StopRoundedIcon style={{ fontSize: 35 }} />\n            </IconButton>\n          </span>\n        </Tooltip>\n        <Tooltip title=\"Play all tracks\" arrow>\n          <span>\n            <IconButton\n              disableRipple\n              aria-label=\"Play\"\n              onClick={this.toggleMasterPlay}\n              disabled={\n                this.state.masterPlay ||\n                Object.keys(this.props.trackMetadata).length === 0\n              }\n              style={{ marginLeft: \"-5px\" }}\n            >\n              <PlayArrowRoundedIcon style={{ fontSize: 35 }} />\n            </IconButton>\n          </span>\n        </Tooltip>{\" \"}\n        <div style={{ display: \"flex\", marginTop: \"-45px\" }}>\n          <div\n            style={{\n              position: \"relative\",\n              marginLeft: \"175px\",\n              width: \"100px\",\n            }}\n          >\n            Volume\n            <Slider\n              min={0}\n              max={100}\n              defaultValue={100}\n              onChange={this.changeVolume}\n            />\n          </div>\n          <span style={{ marginLeft: \"30px\", marginTop: \"5px\" }}>\n            {this.formattedTime(this.state.runningTime)}\n          </span>\n          {/* <div\n            style={{\n              position: \"absolute\",\n              marginLeft: \"395px\",\n              width: \"200px\",\n            }}\n          >\n            Seek\n            <Slider min={0} max={100} defaultValue={0} onChange={this.seek} />\n          </div> */}\n          <Tooltip\n            title=\"Download full track with latest takes\"\n            arrow\n            style={{\n              position: \"absolute\",\n              marginLeft: \"380px\",\n              marginTop: \"-10px\",\n            }}\n          >\n            <span>\n              <IconButton\n                disableRipple\n                aria-label=\"Download full track with latest takes\"\n                onClick={this.downloadMixedTrack}\n                style={{\n                  marginBottom: \"-10px\",\n                }}\n              >\n                <GetAppIcon style={{ fontSize: 30 }} />\n              </IconButton>\n            </span>\n          </Tooltip>\n        </div>\n        {this.state.showCountdown && (\n          <div\n            className=\"timer\"\n            style={{\n              position: \"absolute\",\n              marginLeft: \"500px\",\n              marginTop: \"-105px\",\n            }}\n          >\n            <CountdownCircleTimer\n              isPlaying\n              duration={3}\n              colors={[[\"#0f52bd\", 1]]}\n              size={90}\n              onComplete={() => {\n                const startTime = Date.now() - this.state.runningTime;\n                this.timer = setInterval(() => {\n                  this.setState({ runningTime: Date.now() - startTime });\n                });\n                this.setState({ showCountdown: false, masterPlay: true });\n              }}\n            >\n              {({ remainingTime }) => remainingTime}\n            </CountdownCircleTimer>\n            <button\n              onClick={() => {\n                this.setState({\n                  showCountdown: false,\n                });\n                this.toggleMasterStop();\n              }}\n              style={{ marginTop: \"10px\", marginBottom: \"10px\" }}\n            >\n              Ahh I'm not ready!\n            </button>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default DAW;\n","import React, { Component } from \"react\";\nimport DAW from \"./daw/DAW\";\nimport LoadingGif from \"./daw/LoadingGif\";\nimport { Prompt, Confirm } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\n\nimport SyncRoundedIcon from \"@material-ui/icons/SyncRounded\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\n\nimport { socket } from \"../../App\";\n\nclass Project extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      project_name: null,\n      group_name: null,\n      project_id: null,\n      track_metadata: null,\n      project_hash: props.location.pathname.split(\"/\").pop(),\n      isCreatingTake: false,\n      isDeletingTakeOrTrack: false,\n      onlineUsers: [],\n    };\n    if (this.state.project_hash === \"project\") {\n      this.state.project_hash = null;\n    }\n    this.createTrack = this.createTrack.bind(this);\n    this.deleteTrack = this.deleteTrack.bind(this);\n    this.renameTrack = this.renameTrack.bind(this);\n    this.createTake = this.createTake.bind(this);\n    this.deleteTake = this.deleteTake.bind(this);\n\n    const username = JSON.parse(localStorage.getItem(\"userDetails\")).name;\n    this.state.onlineUsers = [username];\n    console.log(\"[SOCKET.IO] sending request to JOIN project\");\n    socket.emit(\"join project\", {\n      channel: this.state.project_hash,\n      user: username,\n    });\n  }\n\n  // SOCKET IO LISTENERS:\n\n  updateOnlineUsersListener = (data) => {\n    console.log(\"[SOCKET.IO] receiving updateOnlineUsers:\", data.user_list);\n    this.setState({ onlineUsers: data.user_list });\n  };\n\n  updateProjectListener = () => {\n    console.log(\"[SOCKET.IO] receiving updateProject\");\n    this.refresh();\n  };\n\n  // REACT MAIN FUNCTIONS:\n\n  componentDidMount() {\n    this.retrieveProject(this.state.project_hash);\n    console.log(`[SOCKET.IO] creating project listeners`);\n    socket.on(\"updateOnlineUsers\", this.updateOnlineUsersListener);\n    socket.on(\"updateProject\", this.updateProjectListener);\n  }\n\n  componentWillUnmount() {\n    console.log(\n      `[SOCKET.IO] removing project (${this.state.project_name}) listeners`\n    );\n    socket.off(\"updateOnlineUsers\", this.updateOnlineUsersListener);\n    socket.off(\"updateProject\", this.updateProjectListener);\n\n    const userDetails = localStorage.getItem(\"userDetails\");\n    if (userDetails) {\n      console.log(\"[SOCKET.IO] sending request to LEAVE project\");\n      const username = JSON.parse(userDetails).name;\n      socket.emit(\"leave project\", {\n        channel: this.state.project_hash,\n        user: username,\n      });\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    const pathname = this.props.location.pathname.split(\"/\").pop();\n    // fetch project if last page was project search page\n    if (\n      pathname !== \"project\" &&\n      pathname !== null &&\n      this.props.location.pathname !== prevProps.location.pathname\n    ) {\n      this.retrieveProject(pathname);\n      // loaded project search page\n    } else if (pathname === \"project\" && this.state.project_hash !== null) {\n      this.setState({\n        project_hash: null,\n        project_name: null,\n        group_name: null,\n        project_id: null,\n        track_metadata: null,\n      });\n    }\n  }\n\n  retrieveProject = (project_hash) => {\n    console.log(\"retrieving project: \" + project_hash);\n    if (project_hash === null || project_hash === \"\") {\n      return;\n    }\n    fetch(\"/api/project?\" + new URLSearchParams({ project_hash: project_hash }))\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        const tracks = obj.body.tracks\n          ? obj.body.tracks.reduce((obj, item) => {\n              const formatted_takes = item[\"takes\"].reduce((obj, item) => {\n                obj[item[\"take\"]] = {\n                  date_uploaded: item[\"date_uploaded\"],\n                  id: item[\"id\"],\n                  s3_info: item[\"s3_info\"],\n                  track_id: item[\"track_id\"],\n                };\n                return obj;\n              }, {});\n              obj[item[\"id\"]] = {\n                takes: formatted_takes,\n                track_name: item[\"track_name\"],\n              };\n              return obj;\n            }, {})\n          : {};\n        if (obj.status === 200) {\n          this.setState({\n            project_hash: project_hash,\n            project_name: obj.body.project_name,\n            group_name: obj.body.group.group_name,\n            project_id: obj.body.id,\n            track_metadata: tracks,\n          });\n        }\n      });\n  };\n\n  async createTrack() {\n    console.log(\"creating new track\");\n    const track_name = await Prompt(\"Name Your Track\");\n    if (track_name) {\n      const formData = new FormData();\n      formData.append(\"track_name\", track_name);\n      formData.append(\"project_id\", this.state.project_id);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n      fetch(\"/api/track\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status !== 400) {\n            console.log(\"added new track\");\n            let updatedTracks = Object.assign({}, this.state.track_metadata);\n            updatedTracks[obj.body.track_id] = {\n              id: parseInt(obj.body.track_id),\n              project_id: this.state.projectId,\n              takes: {},\n              track_name: track_name,\n            };\n            this.setState({ track_metadata: updatedTracks });\n            socket.emit(\"broadcast update project\", {\n              channel: this.state.project_hash,\n            });\n          }\n        });\n    }\n  }\n\n  async renameTrack(id, name) {\n    console.log(\"renaming track\");\n    const new_name = await Prompt(\"Rename Your Track\", {\n      defaultValue: name,\n    });\n    if (new_name) {\n      const formData = new FormData();\n      formData.append(\"track_id\", id);\n      formData.append(\"new_name\", new_name);\n      const requestOptions = {\n        method: \"PUT\",\n        body: formData,\n      };\n      fetch(\"/api/track\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            let updatedTracks = Object.assign({}, this.state.track_metadata);\n            updatedTracks[id].track_name = new_name;\n            this.setState({ track_metadata: updatedTracks });\n            socket.emit(\"broadcast update project\", {\n              channel: this.state.project_hash,\n            });\n          }\n        });\n    }\n  }\n\n  async deleteTrack(id, name) {\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Track\"\n    );\n    if (result) {\n      this.setState({ isDeletingTakeOrTrack: true });\n      const formData = new FormData();\n      formData.append(\"track_id\", id);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/track\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedTracks = Object.assign({}, this.state.track_metadata);\n            delete updatedTracks[id];\n            this.setState({\n              track_metadata: updatedTracks,\n              isDeletingTakeOrTrack: false,\n            });\n            socket.emit(\"broadcast update project\", {\n              channel: this.state.project_hash,\n            });\n            return true;\n          }\n          this.setState({ isDeletingTakeOrTrack: false });\n        });\n    }\n    return false;\n  }\n\n  createTake(track_id, file, is_manual_upload, latency) {\n    console.log(\"creating new take for\", track_id);\n    this.setState({ isCreatingTake: true });\n    const formData = new FormData();\n    formData.append(\"track_id\", track_id);\n    formData.append(\"file\", file);\n    formData.append(\"latency\", latency);\n    formData.append(\"tz_offset\", new Date().getTimezoneOffset() / 60);\n    formData.append(\"is_manual_upload\", is_manual_upload);\n\n    const requestOptions = {\n      method: \"POST\",\n      body: formData,\n    };\n\n    fetch(\"/api/take\", requestOptions)\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        if (obj.status !== 400) {\n          console.log(\"CREATED TAKE:\", obj);\n          let updatedTracks = Object.assign({}, this.state.track_metadata);\n          updatedTracks[parseInt(track_id)].takes[parseInt(obj.body.take)] = {\n            id: parseInt(obj.body.take_id),\n            track_id: parseInt(track_id),\n            s3_info: obj.body.s3_info,\n            date_uploaded: new Date(obj.body.timestamp).toString(),\n          };\n          this.setState({\n            track_metadata: updatedTracks,\n            isCreatingTake: false,\n          });\n          socket.emit(\"broadcast update project\", {\n            channel: this.state.project_hash,\n          });\n        } else {\n          this.setState({ isCreatingTake: false });\n        }\n      })\n      .catch((error) => {\n        alert(\"Could not upload take due to server error (see console).\");\n        console.log(error);\n        this.setState({ isCreatingTake: false });\n      });\n  }\n\n  deleteTake(track_id, take_number, take_id) {\n    this.setState({ isDeletingTakeOrTrack: true });\n    const formData = new FormData();\n    formData.append(\"take_id\", take_id);\n    const requestOptions = {\n      method: \"DELETE\",\n      body: formData,\n    };\n    fetch(\"/api/take\", requestOptions)\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        if (obj.status === 200) {\n          const updatedTracks = Object.assign({}, this.state.track_metadata);\n          delete updatedTracks[track_id].takes[take_number];\n          this.setState({\n            track_metadata: updatedTracks,\n            isDeletingTakeOrTrack: false,\n          });\n          socket.emit(\"broadcast update project\", {\n            channel: this.state.project_hash,\n          });\n        } else {\n          this.setState({ isDeletingTakeOrTrack: false });\n        }\n      })\n      .catch((error) => {\n        alert(\"Could not delete take due to server error (see console).\");\n        this.setState({ isDeletingTakeOrTrack: false });\n      });\n  }\n\n  refresh = () => {\n    this.retrieveProject(this.state.project_hash);\n  };\n\n  render() {\n    const pathSuffix = this.props.location.pathname.split(\"/\").pop();\n\n    // show loading screen if have not retrieved data yet\n    if (this.state.project_name === null && pathSuffix !== \"project\") {\n      return <div>Loading...</div>;\n    }\n\n    return (\n      this.state.project_hash &&\n      pathSuffix !== \"project\" &&\n      pathSuffix !== \"\" && (\n        <div>\n          <div\n            style={{\n              display: \"flex\",\n              marginBottom: \"-17px\",\n              marginTop: \"-5px\",\n            }}\n          >\n            <h2>\n              {this.state.project_name}\n              <Tooltip\n                title=\"Refresh latest project info\"\n                arrow\n                placement=\"right\"\n              >\n                <IconButton\n                  disableRipple\n                  aria-label=\"Sync\"\n                  onClick={this.refresh}\n                  style={{ marginTop: \"0px\" }}\n                >\n                  <SyncRoundedIcon style={{ fontSize: 20 }} />\n                </IconButton>\n              </Tooltip>\n            </h2>\n            {this.state.isCreatingTake && (\n              <div style={{ marginTop: \"-5px\" }}>\n                <LoadingGif text=\"Uploading take...\" />\n              </div>\n            )}\n            {this.state.isDeletingTakeOrTrack && (\n              <div style={{ marginTop: \"-5px\" }}>\n                <LoadingGif text=\"Deleting...\" />\n              </div>\n            )}\n          </div>\n          <div\n            style={{\n              marginLeft: \"-5px\",\n              marginTop: \"10px\",\n              marginBottom: \"-10px\",\n              fontSize: \"12px\",\n            }}\n          >\n            {this.state.onlineUsers.map((user, i) => {\n              return (\n                <div\n                  key={`user_${i}`}\n                  style={{ display: \"inline-block\", marginRight: \"5px\" }}\n                >\n                  <img\n                    src=\"images/daw/online.png\"\n                    alt=\"online\"\n                    width=\"8\"\n                    height=\"8\"\n                    style={{ marginLeft: \"5px\" }}\n                  />{\" \"}\n                  {user}{\" \"}\n                </div>\n              );\n            })}\n          </div>\n          <div style={{ marginTop: \"20px\" }}>\n            <DAW\n              projectName={this.state.project_name}\n              projectHash={this.state.project_hash}\n              trackMetadata={this.state.track_metadata}\n              numOnlineUsers={this.state.onlineUsers.length}\n              retrieveProject={this.retrieveProject}\n              createTrack={this.createTrack}\n              deleteTrack={this.deleteTrack}\n              renameTrack={this.renameTrack}\n              createTake={this.createTake}\n              deleteTake={this.deleteTake}\n            />\n          </div>\n        </div>\n      )\n    );\n  }\n}\n\nexport default Project;\n","import React, { Component } from \"react\";\n\nclass Home extends Component {\n  render() {\n    return (\n      <div>\n        <h2>HOMEPAGE</h2>\n        {!this.props.authed ? (\n          <p>Login to get started! 🎶</p>\n        ) : (\n          <div>\n            <p> To get started on a project: </p>\n            <ol>\n              <li>\n                Click \"Groups\" to create a new rehearsal group and add group\n                members.\n              </li>\n              <li>\n                Click \"Projects\" to create a project and begin rehearsing!{\" \"}\n              </li>\n            </ol>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default Home;\n","import React, { useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\n\nconst RENAME_PROJECT_OPTION = \"Rename Project\";\nconst DELETE_PROJECT_OPTION = \"Delete Project\";\nconst options = [RENAME_PROJECT_OPTION, DELETE_PROJECT_OPTION];\n\nfunction Project(props) {\n  const history = useHistory();\n  const [threeDotsAnchorElement, setThreeDotsAnchorElement] = useState(null);\n\n  const rehearse = () => {\n    history.push({\n      pathname: `/project/${props.project.project_hash}`,\n      state: {\n        project: props.project,\n        group_name: props.group_name,\n        group_id: props.group_id,\n      },\n    });\n  };\n\n  const clickThreeDotsMenu = (e) => {\n    setThreeDotsAnchorElement(e.currentTarget);\n  };\n\n  const closeThreeDotsMenu = (e) => {\n    const option = e.target.innerText;\n    if (option === RENAME_PROJECT_OPTION) {\n      props.renameProject(props.project.id, props.project.project_name);\n    } else if (option === DELETE_PROJECT_OPTION) {\n      props.deleteProject(props.project.id, props.project.project_name);\n    }\n    setThreeDotsAnchorElement(null);\n  };\n\n  return (\n    <li>\n      Project: {props.project.project_name}{\" \"}\n      <button onClick={rehearse}>Rehearse!</button>\n      <IconButton\n        aria-label=\"more\"\n        aria-controls=\"project-menu\"\n        aria-haspopup=\"true\"\n        onClick={clickThreeDotsMenu}\n        style={{ marginLeft: \"5px\" }}\n      >\n        <MoreHorizIcon />\n      </IconButton>\n      <Menu\n        id=\"project-menu\"\n        anchorEl={threeDotsAnchorElement}\n        keepMounted\n        open={threeDotsAnchorElement !== null}\n        onClose={closeThreeDotsMenu}\n        PaperProps={{\n          style: {\n            maxHeight: 40 * 4.5,\n            width: \"20ch\",\n          },\n        }}\n      >\n        {options.map((option) => (\n          <MenuItem key={option} onClick={closeThreeDotsMenu}>\n            {option}\n          </MenuItem>\n        ))}\n      </Menu>\n    </li>\n  );\n}\n\nexport default Project;\n","import React, { Component } from \"react\";\nimport Project from \"./Project\";\nimport \"./Group.css\";\nimport { Prompt, Confirm } from \"react-st-modal\";\n\nimport { socket } from \"../../App\";\n\nconst RENAME_GROUP_OPTION = \"Rename Group\";\nconst DELETE_GROUP_OPTION = \"Delete Group\";\n\nclass Group extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      projects: props.projects,\n      threeDotsAnchorElement: null,\n    };\n    this.createNewProject = this.createNewProject.bind(this);\n    this.deleteProject = this.deleteProject.bind(this);\n    this.renameProject = this.renameProject.bind(this);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.projects !== prevProps.projects) {\n      this.setState({ projects: this.props.projects });\n    }\n  }\n\n  async createNewProject() {\n    const project_name = await Prompt(\"Name Your Project\");\n    if (project_name) {\n      const formData = new FormData();\n      formData.append(\"project_name\", project_name);\n      formData.append(\"group_id\", this.props.id);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n\n      fetch(\"/api/project\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status !== 400) {\n            this.setState({\n              projects: this.state.projects.concat([\n                {\n                  project_name: project_name,\n                  id: obj.body.project_id,\n                  project_hash: obj.body.project_hash,\n                },\n              ]),\n            });\n            socket.emit(\"broadcast update projects\");\n          }\n        });\n    }\n  }\n\n  async deleteProject(id, name) {\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Project\"\n    );\n    if (result) {\n      const formData = new FormData();\n      formData.append(\"project_id\", id);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/project\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedProjects = [...this.state.projects].filter(\n              (i) => i.id !== id\n            );\n            this.setState({\n              projects: updatedProjects,\n            });\n            socket.emit(\"broadcast update projects\");\n          }\n        });\n    }\n  }\n\n  async renameProject(id, name) {\n    const new_name = await Prompt(\"Rename Your Project\", {\n      defaultValue: name,\n    });\n    if (new_name) {\n      const formData = new FormData();\n      formData.append(\"project_id\", id);\n      formData.append(\"new_name\", new_name);\n      const requestOptions = {\n        method: \"PUT\",\n        body: formData,\n      };\n\n      fetch(\"/api/project\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedProjects = [\n              ...this.state.projects,\n            ].map((projectInfo) =>\n              projectInfo.id === id\n                ? { ...projectInfo, project_name: new_name }\n                : projectInfo\n            );\n            this.setState({\n              projects: updatedProjects,\n            });\n            socket.emit(\"broadcast update projects\");\n          }\n        });\n    }\n  }\n\n  clickThreeDotsMenu = (e) => {\n    this.setState({ threeDotsAnchorElement: e.currentTarget });\n  };\n\n  closeThreeDotsMenu = (e) => {\n    const option = e.target.innerText;\n    if (option === RENAME_GROUP_OPTION) {\n      this.props.renameGroup(this.props.id, this.props.name);\n    } else if (option === DELETE_GROUP_OPTION) {\n      this.props.deleteGroup(this.props.id, this.props.name);\n    }\n    this.setState({ threeDotsAnchorElement: null });\n  };\n\n  render() {\n    let sortedProjects = this.state.projects.sort((a, b) =>\n      a.id > b.id ? 1 : -1\n    );\n    return (\n      <div style={{ marginTop: \"25px\", marginBottom: \"-10px\" }}>\n        <p>\n          Group: {this.props.name}\n          {\"  \"}\n          <button onClick={this.createNewProject}>+ Project</button>\n        </p>\n        <div style={{ marginTop: \"20px\" }}>\n          <ul>\n            {this.state.projects && this.state.projects.length === 0 && (\n              <p\n                className=\"text-muted\"\n                style={{ marginTop: \"-10px\", marginBottom: \"20px\" }}\n              >\n                No projects created yet!\n              </p>\n            )}\n            {sortedProjects.map((projectInfo, i) => (\n              <div key={`project_${i}`}>\n                <div style={{ marginTop: \"-20px\", marginBottom: \"-10px\" }}>\n                  <Project\n                    project={projectInfo}\n                    group_name={this.props.name}\n                    group_id={this.props.id}\n                    renameProject={this.renameProject}\n                    deleteProject={this.deleteProject}\n                  />\n                </div>\n              </div>\n            ))}\n          </ul>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Group;\n","import React, { Component } from \"react\";\nimport Group from \"./Group\";\nimport \"./Projects.css\";\n\nimport SyncRoundedIcon from \"@material-ui/icons/SyncRounded\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\n\nimport { socket } from \"../../App\";\n\nclass Projects extends Component {\n  constructor() {\n    super();\n    this.state = {\n      groups: [],\n      isLoaded: false,\n    };\n    this.fetchGroups();\n  }\n\n  // SOCKET IO LISTENER:\n  updateProjectsListener = () => {\n    console.log(\"[SOCKET.IO] receiving updateProjects\");\n    this.refresh();\n  };\n\n  componentDidMount() {\n    console.log(\"[SOCKET.IO] creating Projects page listener\");\n    socket.on(\"updateProjects\", this.updateProjectsListener);\n  }\n\n  componentWillUnmount() {\n    console.log(\"[SOCKET.IO] removing Projects page listener\");\n    socket.off(\"updateProjects\", this.updateProjectsListener);\n  }\n\n  fetchGroups = () => {\n    fetch(\"/api/groups\", {\n      method: \"GET\",\n    })\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((res) => {\n        if (res.status !== 400) {\n          this.setState({ groups: res.body, isLoaded: true });\n        }\n      });\n  };\n\n  refresh = () => {\n    this.fetchGroups();\n  };\n\n  render() {\n    if (!this.state.isLoaded) {\n      return <div>Loading...</div>;\n    }\n    return (\n      <div style={{ marginBottom: \"10px\" }}>\n        <h2 style={{ marginBottom: \"-25px\" }}>\n          PROJECTS\n          <Tooltip title=\"Refresh latest projects\" arrow placement=\"right\">\n            <IconButton\n              style={{ marginTop: \"-3px\" }}\n              disableRipple\n              aria-label=\"Sync\"\n              onClick={this.refresh}\n            >\n              <SyncRoundedIcon style={{ fontSize: 25 }} />\n            </IconButton>\n          </Tooltip>\n        </h2>\n        {this.state.groups && this.state.groups.length === 0 && (\n          <p style={{ marginTop: \"20px\" }} class=\"text-muted\">\n            Create a group first!\n          </p>\n        )}\n        {this.state.groups &&\n          this.state.groups.map((groupInfo, i) => (\n            <div key={`group_${i}`}>\n              <Group\n                id={groupInfo.id}\n                name={groupInfo.group_name}\n                projects={groupInfo.projects}\n                renameGroup={this.renameGroup}\n                deleteGroup={this.deleteGroup}\n              />\n            </div>\n          ))}\n      </div>\n    );\n  }\n}\n\nexport default Projects;\n","import React, { Component } from \"react\";\n\nclass Member extends Component {\n  removeMember = () => {\n    this.props.removeMember(this.props.id);\n  };\n\n  render() {\n    const hideRemoveButton = !this.props.onlyMemberInGroup;\n    return (\n      <div>\n        <li>\n          Member: {this.props.name}{\" \"}\n          {hideRemoveButton && (\n            <button onClick={this.removeMember}>Remove</button>\n          )}\n        </li>\n      </div>\n    );\n  }\n}\n\nexport default Member;\n","import {\n  useDialog,\n  ModalContent,\n  ModalFooter,\n  ModalButton,\n} from \"react-st-modal\";\nimport { useState } from \"react\";\n\nimport Dropdown from \"react-dropdown\";\nimport \"react-dropdown/style.css\";\n\nexport default function AddMemberModalContent(props) {\n  const dialog = useDialog();\n\n  const [newUserId, setNewUserId] = useState(null);\n  const [newUserName, setNewUserName] = useState(null);\n\n  const _onSelect = (option) => {\n    console.log(\"Selected \" + option.label);\n    setNewUserId(option.value);\n    setNewUserName(option.label);\n  };\n\n  const userDropdownOptions = Object.keys(props.users).reduce((acc, userid) => {\n    acc.push({\n      value: userid,\n      label: props.users[userid],\n    });\n    return acc;\n  }, []);\n\n  return (\n    <div>\n      <ModalContent>\n        <p>The dropdown lists all members on JamNSync:</p>\n        <div\n          style={{\n            height: 250,\n            width: 300,\n          }}\n        >\n          <Dropdown\n            options={userDropdownOptions}\n            onChange={_onSelect}\n            placeholder=\"Select a name\"\n          />\n        </div>\n      </ModalContent>\n      <ModalFooter>\n        <ModalButton\n          onClick={() => {\n            // Сlose the dialog and return the value\n            dialog.close([newUserId, newUserName]);\n          }}\n        >\n          OK\n        </ModalButton>\n        <ModalButton\n          onClick={() => {\n            dialog.close([newUserId, newUserName]);\n          }}\n          type={\"light\"}\n        >\n          Cancel\n        </ModalButton>\n      </ModalFooter>\n    </div>\n  );\n}\n","import React, { Component } from \"react\";\nimport Member from \"./Member\";\nimport \"./Group.css\";\n\nimport { CustomDialog, Confirm } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\nimport AddMemberModalContent from \"./AddMemberModal\";\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\n\nimport { socket } from \"../../App\";\n\nconst RENAME_GROUP_OPTION = \"Rename Group\";\nconst DELETE_GROUP_OPTION = \"Delete Group\";\nconst options = [RENAME_GROUP_OPTION, DELETE_GROUP_OPTION];\n\nclass Group extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      group_membership: {},\n      threeDotsAnchorElement: null,\n    };\n    fetch(\"/api/group/members?group_id=\" + this.props.id, { method: \"GET\" })\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((res) => {\n        if (res.status !== 400) {\n          this.setState({ group_membership: res.body });\n        }\n      });\n    this.addMember = this.addMember.bind(this);\n    this.removeMember = this.removeMember.bind(this);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.refresh !== prevProps.refresh) {\n      fetch(\"/api/group/members?group_id=\" + this.props.id, { method: \"GET\" })\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((res) => {\n          if (res.status !== 400) {\n            this.setState({ group_membership: res.body });\n          }\n        });\n    }\n  }\n\n  async addMember() {\n    console.log(\"adding member\");\n    // find all users\n    let all_users = await fetch(\"/api/users\", { method: \"GET\" })\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((res) => {\n        return res.body;\n      });\n\n    // perform get request to retrieve all available\n    const newMemberInfo = await CustomDialog(\n      <AddMemberModalContent users={all_users} />,\n      {\n        title: \"Add Member to \" + this.props.name,\n        showCloseIcon: true,\n      }\n    );\n    if (newMemberInfo === undefined || newMemberInfo === null) {\n      return;\n    }\n    const [newUserId, newUsername] = newMemberInfo;\n    // perform post request to add user\n    // console.log(\"newUserId:\", newUserId, \"newUsername:\", newUsername);\n    if (\n      newUserId &&\n      Object.keys(this.state.group_membership).includes(newUserId)\n    ) {\n      // group member already exists\n      alert(`${newUsername} is already a member in group \"${this.props.name}\"`);\n    } else if (newUserId && newUsername) {\n      const formData = new FormData();\n      formData.append(\"group_id\", this.props.id);\n      formData.append(\"user_id\", newUserId);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n      fetch(\"/api/group/members\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedMembership = Object.assign(\n              {},\n              this.state.group_membership\n            );\n            updatedMembership[newUserId] = newUsername;\n            this.setState({\n              group_membership: updatedMembership,\n            });\n            socket.emit(\"broadcast update groups\");\n          }\n        });\n    }\n  }\n\n  async removeMember(userid) {\n    console.log(\"removing member id:\", userid);\n    const username = this.state.group_membership[userid];\n    const result = await Confirm(\n      `Are you sure you want to remove \"${username}\" from \"${this.props.name}\"?`,\n      \"Remove Member\"\n    );\n    if (result) {\n      const formData = new FormData();\n      formData.append(\"group_id\", this.props.id);\n      formData.append(\"user_id\", userid);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/group/members\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedMembership = Object.assign(\n              {},\n              this.state.group_membership\n            );\n            delete updatedMembership[userid];\n            this.setState({\n              group_membership: updatedMembership,\n            });\n            socket.emit(\"broadcast update groups\");\n          }\n        });\n    }\n  }\n\n  clickThreeDotsMenu = (e) => {\n    this.setState({ threeDotsAnchorElement: e.currentTarget });\n  };\n\n  closeThreeDotsMenu = (e) => {\n    const option = e.target.innerText;\n    if (option === RENAME_GROUP_OPTION) {\n      this.props.renameGroup(this.props.id, this.props.name);\n    } else if (option === DELETE_GROUP_OPTION) {\n      this.props.deleteGroup(this.props.id, this.props.name);\n    }\n    this.setState({ threeDotsAnchorElement: null });\n  };\n\n  render() {\n    return (\n      <div style={{ marginBottom: \"-10px\" }}>\n        <p style={{ marginTop: \"20px\", marginBottom: \"-20px\" }}>\n          Group: {this.props.name}\n          {\"  \"}\n          <button onClick={this.addMember}>+ Member</button>\n          <IconButton\n            aria-label=\"more\"\n            aria-controls=\"group-menu\"\n            aria-haspopup=\"true\"\n            onClick={this.clickThreeDotsMenu}\n            style={{ marginLeft: \"5px\" }}\n          >\n            <MoreHorizIcon />\n          </IconButton>\n          <Menu\n            id=\"group-menu\"\n            anchorEl={this.state.threeDotsAnchorElement}\n            keepMounted\n            open={this.state.threeDotsAnchorElement !== null}\n            onClose={this.closeThreeDotsMenu}\n            PaperProps={{\n              style: {\n                maxHeight: 40 * 4.5,\n                width: \"20ch\",\n              },\n            }}\n          >\n            {options.map((option) => (\n              <MenuItem key={option} onClick={this.closeThreeDotsMenu}>\n                {option}\n              </MenuItem>\n            ))}\n          </Menu>\n        </p>\n        <ul>\n          {Object.keys(this.state.group_membership).map((userid) => {\n            const username = this.state.group_membership[userid];\n            return (\n              <div key={`member_${userid}`}>\n                <div>\n                  <Member\n                    id={userid}\n                    name={username}\n                    removeMember={this.removeMember}\n                    onlyMemberInGroup={\n                      Object.keys(this.state.group_membership).length === 1\n                    }\n                  />\n                </div>\n              </div>\n            );\n          })}\n        </ul>\n      </div>\n    );\n  }\n}\n\nexport default Group;\n","import React, { Component } from \"react\";\nimport \"./Groups.css\";\nimport Group from \"./Group\";\nimport { Confirm, Prompt } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\n\nimport SyncRoundedIcon from \"@material-ui/icons/SyncRounded\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\n\nimport { socket } from \"../../App\";\n\nclass Groups extends Component {\n  constructor() {\n    super();\n    this.state = {\n      groups: [],\n      isLoaded: false,\n      refresh: 0,\n    };\n    this.fetchGroups();\n    this.createNewGroup = this.createNewGroup.bind(this);\n    this.deleteGroup = this.deleteGroup.bind(this);\n    this.renameGroup = this.renameGroup.bind(this);\n  }\n\n  // SOCKET IO LISTENERS:\n\n  updateGroupsListener = () => {\n    console.log(\"[SOCKET.IO] receiving updateGroups\");\n    this.refresh();\n  };\n\n  // REACT MAIN FUNCTIONS\n\n  componentDidMount() {\n    console.log(\"[SOCKET.IO] creating Groups page listener\");\n    socket.on(\"updateGroups\", this.updateGroupsListener);\n  }\n\n  componentWillUnmount() {\n    console.log(\"[SOCKET.IO] removing Groups page listener\");\n    socket.off(\"updateGroups\", this.updateGroupsListener);\n  }\n\n  fetchGroups = () => {\n    fetch(\"/api/groups\", {\n      method: \"GET\",\n    })\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((res) => {\n        if (res.status !== 400) {\n          this.setState({ groups: res.body, isLoaded: true });\n        }\n      });\n  };\n\n  async createNewGroup() {\n    console.log(\"creating new group!\");\n    const group_name = await Prompt(\"Name Your Group\");\n    if (group_name) {\n      const formData = new FormData();\n      formData.append(\"group_name\", group_name);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status !== 400) {\n            this.setState({\n              groups: this.state.groups.concat([\n                { group_name: group_name, id: obj.body.group_id, projects: [] },\n              ]),\n            });\n          }\n        })\n        .catch((error) => {\n          alert(\n            'Server Error: Group name taken, use a different name instead of \"' +\n              group_name +\n              '\"!'\n          );\n        });\n    }\n  }\n\n  async deleteGroup(id, name) {\n    console.log(\"deleting group\");\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Group\"\n    );\n    if (result) {\n      const formData = new FormData();\n      formData.append(\"group_id\", id);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedGroups = [...this.state.groups].filter(\n              (i) => i.id !== id\n            );\n            this.setState({\n              groups: updatedGroups,\n            });\n            socket.emit(\"broadcast update groups\");\n          }\n        });\n    }\n  }\n\n  async renameGroup(id, name) {\n    console.log(\"renaming group\");\n    const new_name = await Prompt(\"Rename Your Group\", {\n      defaultValue: name,\n    });\n    if (new_name) {\n      const formData = new FormData();\n      formData.append(\"new_name\", new_name);\n      formData.append(\"group_id\", id);\n      const requestOptions = {\n        method: \"PUT\",\n        body: formData,\n      };\n\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedGroups = [...this.state.groups].map((groupInfo) =>\n              groupInfo.id === id\n                ? { ...groupInfo, group_name: new_name }\n                : groupInfo\n            );\n            this.setState({\n              groups: updatedGroups,\n            });\n            socket.emit(\"broadcast update groups\");\n          }\n        });\n    }\n  }\n\n  refresh = () => {\n    console.log(\"refreshing groups\");\n    fetch(\"/api/groups\", {\n      method: \"GET\",\n    })\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((res) => {\n        if (res.status !== 400) {\n          this.setState({\n            groups: res.body,\n            isLoaded: true,\n            refresh: this.state.refresh + 1,\n          });\n        } else {\n          this.setState({ refresh: this.state.refresh + 1 });\n        }\n      });\n  };\n\n  render() {\n    if (!this.state.isLoaded) {\n      return <div>Loading...</div>;\n    }\n    return (\n      <div>\n        <h2 style={{ marginBottom: \"-30px\" }}>\n          REHEARSAL GROUPS\n          <Tooltip title=\"Refresh latest groups\" arrow placement=\"right\">\n            <IconButton\n              style={{ marginTop: \"-3px\" }}\n              disableRipple\n              aria-label=\"Sync\"\n              onClick={this.refresh}\n            >\n              <SyncRoundedIcon style={{ fontSize: 25 }} />\n            </IconButton>\n          </Tooltip>\n        </h2>\n        {this.state.groups &&\n          this.state.groups.map((groupInfo, i) => (\n            <div key={`group_${i}`}>\n              <Group\n                id={groupInfo.id}\n                name={groupInfo.group_name}\n                projects={groupInfo.projects}\n                renameGroup={this.renameGroup}\n                deleteGroup={this.deleteGroup}\n                refresh={this.state.refresh}\n              />\n            </div>\n          ))}\n        <button\n          style={{ marginTop: \"30px\" }}\n          className=\"stitched\"\n          onClick={this.createNewGroup}\n        >\n          + New Rehearsal Group\n        </button>\n      </div>\n    );\n  }\n}\n\nexport default Groups;\n","import React from \"react\";\nimport { Route, Redirect } from \"react-router-dom\";\n\nfunction PrivateRoute({ component: Component, authed, ...rest }) {\n  return (\n    <Route\n      {...rest}\n      render={(props) =>\n        authed === true ? (\n          <Component {...props} />\n        ) : (\n          <Redirect to={{ pathname: \"/\", state: { from: props.location } }} />\n        )\n      }\n    />\n  );\n}\n\nexport default PrivateRoute;\n","import React, { Component } from \"react\";\nimport { HashRouter, NavLink, Route } from \"react-router-dom\";\nimport { Redirect } from \"react-router\";\nimport { createHashHistory } from \"history\";\n\n// import Footer from \"./components/Footer\";\nimport Login from \"./components/Login\";\nimport Logout from \"./components/Logout\";\nimport Project from \"./routes/project/Project\";\nimport Home from \"./routes/home/Home\";\nimport Projects from \"./routes/projects/Projects\";\nimport Groups from \"./routes/groups/Groups\";\nimport PrivateRoute from \"./utils/components/PrivateRoute\";\n\nimport io from \"socket.io-client\";\nexport const socket = io(process.env.ROOT_URL);\n\nconst history = createHashHistory();\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.state = {\n      userDetails: {},\n      isUserLoggedIn: false,\n    };\n  }\n\n  componentDidMount() {\n    if (history.location.pathname === \"/\") {\n      history.replace(\"/home\");\n    }\n\n    let userDetails = JSON.parse(localStorage.getItem(\"userDetails\"));\n    let isUserLoggedIn = localStorage.getItem(\"isUserLoggedIn\") === \"true\";\n    if (isUserLoggedIn && !this.state.isUserLoggedIn) {\n      this.setState({\n        userDetails: userDetails,\n        isUserLoggedIn: isUserLoggedIn,\n      });\n    }\n  }\n\n  componentDidUpdate(prevState) {\n    if (\n      !this.state.isUserLoggedIn &&\n      prevState.isUserLoggedIn &&\n      history.location.pathname === \"/\"\n    ) {\n      history.replace(\"/home\");\n    }\n  }\n\n  handleSuccessfulLogin = (response) => {\n    const userDetails = response.profileObj;\n    const formData = new FormData();\n    formData.append(\"google_auth_id\", userDetails.googleId);\n    formData.append(\"google_email\", userDetails.email);\n    formData.append(\"user_name\", userDetails.name);\n    const requestOptions = {\n      method: \"POST\",\n      body: formData,\n    };\n\n    fetch(\"/auth/login\", requestOptions)\n      .then((resp) => resp.json())\n      .then((res) => {\n        console.log(res.message);\n        localStorage.setItem(\"userDetails\", JSON.stringify(userDetails));\n        localStorage.setItem(\"isUserLoggedIn\", true);\n        this.setState({ userDetails: userDetails, isUserLoggedIn: true });\n      });\n  };\n\n  handleSuccessfulLogout = () => {\n    fetch(\"/auth/logout\", { method: \"POST\" })\n      .then((resp) => resp.json())\n      .then((res) => {\n        console.log(res.message);\n        localStorage.clear();\n        this.setState({ userDetails: {}, isUserLoggedIn: false });\n      });\n  };\n\n  render() {\n    // default to groups page if no history, otherwise go to last page before refresh\n    let pathname = history.location.pathname;\n    return (\n      <HashRouter history={history}>\n        <div>\n          <h1>JamNSync</h1>\n          <div style={{ position: \"absolute\", right: 20, top: 35 }}>\n            {!this.state.isUserLoggedIn && (\n              <Login onSuccessfulLogin={this.handleSuccessfulLogin} />\n            )}\n            {this.state.isUserLoggedIn && (\n              <div style={{ display: \"flex\" }}>\n                <div>\n                  <p>Welcome, {this.state.userDetails.givenName}!</p>\n                </div>\n                <div style={{ marginLeft: \"5px\" }}>\n                  <Logout onSuccessfulLogout={this.handleSuccessfulLogout} />\n                </div>\n              </div>\n            )}\n          </div>\n\n          <ul className=\"header\">\n            <li>\n              <NavLink to=\"/home\">Home</NavLink>\n            </li>\n            {this.state.isUserLoggedIn && (\n              <li>\n                <NavLink to=\"/groups\">Groups</NavLink>\n              </li>\n            )}\n            {this.state.isUserLoggedIn && (\n              <li>\n                <NavLink to=\"/projects\">Projects</NavLink>\n              </li>\n            )}\n          </ul>\n\n          <div className=\"content\">\n            <Route exact path=\"/\">\n              {this.state.isUserLoggedIn && pathname !== \"/\" ? (\n                <Redirect to={pathname} />\n              ) : (\n                <Home authed={this.state.isUserLoggedIn} />\n              )}\n            </Route>\n            <Route path=\"/home\">\n              <Home authed={this.state.isUserLoggedIn} />\n            </Route>\n            <PrivateRoute\n              path=\"/projects\"\n              component={Projects}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              path=\"/groups\"\n              component={Groups}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              path=\"/project/\"\n              component={Project}\n              authed={this.state.isUserLoggedIn}\n            />\n          </div>\n        </div>\n      </HashRouter>\n    );\n  }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(\n  <App />,\n  document.getElementById(\"root\")\n);"],"sourceRoot":""}