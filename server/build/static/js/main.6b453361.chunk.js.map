{"version":3,"sources":["components/Login.js","utils/refreshToken.js","components/Logout.js","routes/project/daw/Track.js","routes/project/daw/LoadingGif.js","routes/project/daw/AlignRecording.js","routes/project/daw/DAW.js","routes/project/Project.js","routes/project/ProjectSearch.js","routes/home/Home.js","routes/projects/Project.js","routes/projects/Group.js","routes/projects/Projects.js","routes/groups/Member.js","routes/groups/AddMemberModal.js","routes/groups/Group.js","routes/groups/Groups.js","routes/temp-jitsi/EmbeddedJitsi.js","routes/temp-webaudio/Encoder.js","routes/temp-webaudio/WebAudio.js","routes/temp-webaudio/MicRecorder.js","utils/components/PrivateRoute.js","App.js","index.js"],"names":["Login","props","clientId","process","buttonText","onSuccess","res","refreshTiming","tokenObj","expires_in","refreshToken","a","reloadAuthResponse","newAuthRes","console","log","localStorage","setItem","id_token","setTimeout","refreshTokenSetup","onSuccessfulLogin","onFailure","alert","error","details","cookiePolicy","style","marginTop","isSignedIn","Logout","onLogoutSuccess","onSuccessfulLogout","FILE_UPLOAD_OPTION","RENAME_TRACK_OPTION","DELETE_TRACK_OPTION","options","Track","stop","audioFile","currentTime","pause","setState","playing","changeVolume","value","volume","masterVolume","seek","state","play","fastForward","duration","currentSeek","forwardTo","rewind","backwardTo","mute","muted","solo","updateSoloTracks","trackId","soloing","selectToRecord","updatedTrackId","selected","setSelectedTrack","_onSelect","option","label","url","takes","s3_info","selectedTake","s3URL","document","getElementById","clickThreeDotsMenu","e","threeDotsAnchorElement","currentTarget","closeThreeDotsMenu","target","innerText","click","renameTrack","trackName","deleteTrack","latestTake","Object","keys","length","latestKey","pop","deleteTake","bind","this","prevProps","selectedTrackId","masterPlay","masterRecord","masterStop","soloTracks","Math","min","targetTake","takeInfo","d","lastIndexOf","Date","substr","formattedDateTime","toLocaleString","name","Confirm","id","newSelectedTake","takeCopy","splice","indexOf","max","apply","newURL","selectedKeyValue","takeDropdownOptions","reduce","acc","take","parseInt","rawDate","push","reverse","marginLeft","display","src","alt","width","height","title","onClick","IconButton","aria-label","aria-controls","aria-haspopup","type","hidden","onChange","handleFileUpload","files","Menu","anchorEl","keepMounted","open","onClose","PaperProps","maxHeight","map","MenuItem","marginBottom","Tooltip","arrow","disableRipple","fontSize","color","controls","preload","autobuffer","placeholder","method","action","Component","LoadingGif","marginRight","text","AlignRecordingModalContent","dialog","useDialog","useState","isPlaying","setPlaying","bgWaveSurfer","setBgWaveSurfer","recWaveSurfer","setRecWaveSurfer","loadedAudio","setLoadedAudio","dragOffset","setDragOffset","latencyMagnitude","setLatencyMagnitude","onStopDrag","useCallback","_","position","x","latency","useEffect","WaveSurfer","create","container","waveColor","progressColor","cursorColor","cursorWidth","interact","hideScrollbar","isOpen","crunker","Crunker","nonRecordedTrackURLs","trackMetadata","filter","recordedTrackId","takeId","fetchAudio","then","buffers","mergeAudio","merged","export","output","load","recordedURL","setVolume","zoom","className","axis","bounds","left","right","onStop","params","scrollParent","seekTo","seekAndCenter","getDuration","close","round","AudioContext","window","webkitAudioContext","WebAudioRecorder","DAW","createTrack","createTake","track_id","file","is_manual_upload","take_number","take_id","toggleMasterPlay","startTime","now","runningTime","timer","setInterval","startMicrophone","audioContext","navigator","mediaDevices","getUserMedia","audio","stream","gumStream","input","createMediaStreamSource","recorder","workerDir","encoding","numChannels","setOptions","timeLimit","encodeAfterRecord","mp3","bitRate","onComplete","blob","getAudioTracks","stopMicrophone","startRecording","targetId","test","newId","formattedTime","ms","minutes","floor","seconds","toFixed","newSoloTracks","index","rehearse","isRehearsing","downloadMixedTrack","latestTakeURLs","link","createElement","href","datestring","getFullYear","getMonth","getDate","timestring","getHours","getMinutes","outputFilename","projectName","setAttribute","body","appendChild","parentNode","removeChild","isRecording","isBlocked","showCountdown","initialLoad","stopMicProcessing","toggleMasterRecord","toggleMasterStop","catch","clearInterval","finishRecording","File","URL","createObjectURL","CustomDialog","showCloseIcon","isCanClose","trackInfo","track_name","disabled","defaultValue","colors","size","remainingTime","Project","retrieveProject","project_hash","fetch","URLSearchParams","resp","json","data","status","obj","tracks","item","formatted_takes","date_uploaded","project_name","group_name","group","project_id","track_metadata","refresh","location","pathname","split","isCreatingTake","isDeletingTakeOrTrack","Prompt","formData","FormData","append","updatedTracks","assign","projectId","new_name","getTimezoneOffset","timestamp","toString","pathSuffix","placement","ProjectSearch","setProjectId","preventDefault","startsWith","history","err","Home","authed","RENAME_PROJECT_OPTION","DELETE_PROJECT_OPTION","useHistory","setThreeDotsAnchorElement","renameProject","project","deleteProject","group_id","Group","renameGroup","deleteGroup","projects","createNewProject","concat","updatedProjects","i","projectInfo","sortedProjects","sort","b","Projects","fetchGroups","groups","isLoaded","createNewGroup","updatedGroups","groupInfo","class","Member","removeMember","hideRemoveButton","onlyMemberInGroup","AddMemberModalContent","newUserId","setNewUserId","newUserName","setNewUserName","userDropdownOptions","users","userid","RENAME_GROUP_OPTION","DELETE_GROUP_OPTION","group_membership","addMember","all_users","newUsername","updatedMembership","username","Groups","EmbeddedJitsi","displayName","setDisplayName","roomName","setRoomName","password","setPassword","onCall","setOnCall","containerStyles","onMeetingEnd","loadingComponent","errorComponent","event","Encoder","config","sampleRate","mp3Encoder","Mp3Encoder","maxSamples","samplesMono","clearBuffer","dataBuffer","buffer","Int8Array","s","arrayBuffer","Float32Array","out","Int16Array","floatTo16BitPCM","convertBuffer","remaining","subarray","mp3buffer","encodeBuffer","appendToBuffer","flush","Mp3Recorder","getMediaStream","mediaRecorder","mediaChunks","mediaStream","activeStream","microphone","context","processor","createScriptProcessor","onaudioprocess","lameEncoder","encode","inputBuffer","getChannelData","connect","destination","disconnect","forEach","track","deviceId","exact","addMicrophoneListener","finalBuffer","finish","Promise","resolve","reject","Error","Blob","WebAudio","handleRecord","start","recording","handleStopRecord","getMp3","blobURL","recordings","chunks","deleteRecording","PrivateRoute","component","rest","render","to","from","createHashHistory","App","handleSuccessfulLogin","response","userDetails","profileObj","googleId","email","message","JSON","stringify","isUserLoggedIn","handleSuccessfulLogout","clear","replace","parse","getItem","prevState","top","givenName","path","ReactDOM"],"mappings":"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","file":"static/js/main.6b453361.chunk.js","sourcesContent":["// source: https://github.com/Sivanesh-S/react-google-authentication/blob/master/src/components/Login.js\n\nimport React from \"react\";\n\nimport { GoogleLogin } from \"react-google-login\";\nimport { refreshTokenSetup } from \"../utils/refreshToken\";\n\nfunction Login(props) {\n  const onSuccess = (res) => {\n    // console.log(\"Login Success: currentUser:\", res.profileObj);\n    refreshTokenSetup(res);\n    props.onSuccessfulLogin(res);\n  };\n\n  const onFailure = (res) => {\n    console.log(\"Attempt to login failed. Error:\", res);\n    alert(\"Error: \" + res.error + \". \" + res.details);\n  };\n\n  return (\n    <div>\n      <GoogleLogin\n        clientId={process.env.REACT_APP_GOOGLE_CLIENT_ID}\n        buttonText=\"Login\"\n        onSuccess={onSuccess}\n        onFailure={onFailure}\n        cookiePolicy={\"single_host_origin\"}\n        style={{ marginTop: \"100px\" }}\n        isSignedIn={true}\n      />\n    </div>\n  );\n}\n\nexport default Login;\n","// source: https://github.com/Sivanesh-S/react-google-authentication/blob/master/src/utils/refreshToken.js\n\nexport const refreshTokenSetup = (res) => {\n  // Timing to renew access token\n  let refreshTiming = (res.tokenObj.expires_in || 3600 - 5 * 60) * 1000;\n\n  const refreshToken = async () => {\n    const newAuthRes = await res.reloadAuthResponse();\n    refreshTiming = (newAuthRes.expires_in || 3600 - 5 * 60) * 1000;\n    console.log(\"newAuthRes:\", newAuthRes);\n    // saveUserToken(newAuthRes.access_token);  <-- save new token\n    localStorage.setItem(\"authToken\", newAuthRes.id_token);\n\n    // Setup the other timer after the first one\n    setTimeout(refreshToken, refreshTiming);\n  };\n\n  // Setup first refresh timer\n  setTimeout(refreshToken, refreshTiming);\n};\n","import React from \"react\";\nimport { GoogleLogout } from \"react-google-login\";\n\nfunction Logout(props) {\n  const onSuccess = () => {\n    // console.log('Logged out successfully');\n    // alert(\"Logged out successfully \");\n    props.onSuccessfulLogout();\n  };\n\n  return (\n    <div>\n      <GoogleLogout\n        clientId={process.env.REACT_APP_GOOGLE_CLIENT_ID}\n        buttonText=\"Logout\"\n        onLogoutSuccess={onSuccess}\n      ></GoogleLogout>\n    </div>\n  );\n}\n\nexport default Logout;\n","import React, { Component } from \"react\";\nimport \"./Track.css\";\nimport Dropdown from \"react-dropdown\";\nimport \"react-dropdown/style.css\";\nimport { Confirm } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\nimport HeadsetRoundedIcon from \"@material-ui/icons/HeadsetRounded\";\nimport VolumeOffRoundedIcon from \"@material-ui/icons/VolumeOffRounded\";\n\nconst FILE_UPLOAD_OPTION = \"+ Upload File\";\nconst RENAME_TRACK_OPTION = \"Rename Track\";\nconst DELETE_TRACK_OPTION = \"Delete Track\";\n\nconst options = [FILE_UPLOAD_OPTION, RENAME_TRACK_OPTION, DELETE_TRACK_OPTION];\n\nclass Track extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selected: false,\n      playing: false,\n      muted: false,\n      s3URL: null,\n      selectedTake: null,\n      latestTake: 0,\n      soloing: false,\n      volume: 84.95,\n      threeDotsAnchorElement: null,\n    };\n    this.audioFile = null;\n    if (Object.keys(props.takes).length !== 0) {\n      const latestKey = Object.keys(props.takes).pop();\n      const url = props.takes[latestKey].s3_info;\n      if (url) {\n        this.state.s3URL = url;\n        this.state.selectedTake = latestKey;\n        this.audioFile = document.getElementById(\n          `audio-file-${this.props.trackId}`\n        );\n      }\n    }\n    this.deleteTake = this.deleteTake.bind(this);\n  }\n\n  componentDidMount() {\n    // if this track has takes and the page refreshed, select most recent take\n    if (Object.keys(this.props.takes).length !== 0) {\n      const latestKey = Object.keys(this.props.takes).pop();\n      const url = this.props.takes[latestKey].s3_info;\n      if (url) {\n        this.setState({\n          s3URL: url,\n          selectedTake: latestKey,\n          latestTake: latestKey,\n        });\n        this.audioFile = document.getElementById(\n          `audio-file-${this.props.trackId}`\n        );\n      }\n      // otherwise reset the take state\n    } else {\n      this.setState({\n        selectedTake: null,\n        s3URL: null,\n        latestTake: 0,\n      });\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    // set audio file\n    if (this.state.s3URL && this.audioFile === null) {\n      this.audioFile = document.getElementById(\n        `audio-file-${this.props.trackId}`\n      );\n    } else if (this.state.s3URL === null && this.audioFile !== null) {\n      this.audioFile = null;\n    }\n\n    // unselect selected track if a different track is selected\n    if (\n      this.state.selected &&\n      this.props.selectedTrackId !== this.props.trackId\n    ) {\n      this.setState({ selected: false });\n    }\n\n    // if no take is currently selected and # of states updated\n    if (\n      (this.state.selectedTake === null ||\n        this.state.latestTake !== Object.keys(this.props.takes).pop()) &&\n      Object.keys(this.props.takes).length !== 0\n    ) {\n      const latestKey = Object.keys(this.props.takes).pop();\n      const url = this.props.takes[latestKey].s3_info;\n      if (url) {\n        this.setState({\n          latestTake: latestKey,\n          selectedTake: latestKey,\n          s3URL: url,\n        });\n      }\n    } else if (Object.keys(this.props.takes).length === 0 && this.state.s3URL) {\n      this.setState({\n        selectedTake: null,\n        s3URL: null,\n        latestTake: 0,\n      });\n    }\n\n    // play non-selected track during recording or stop if DAW master controls indicate\n    if (\n      this.props.masterPlay &&\n      this.audioFile &&\n      !this.state.playing &&\n      (!this.state.selected ||\n        (this.state.selected && !this.props.masterRecord))\n    ) {\n      console.log(`[${this.props.trackName}] playing 1: ${this.state.s3URL}`);\n      this.audioFile.currentTime = 0;\n      this.audioFile.play();\n      this.setState({ playing: true });\n    } else if (this.props.masterStop && this.audioFile && this.state.playing) {\n      this.audioFile.pause();\n      this.setState({ playing: false });\n    }\n\n    // update soloing\n    if (\n      !this.state.soloing &&\n      this.props.soloTracks.length !== 0 &&\n      !this.state.muted &&\n      this.state.s3URL\n    ) {\n      this.audioFile.muted = true;\n      this.setState({\n        muted: true,\n      });\n    } else if (\n      this.props.soloTracks.length === 0 &&\n      this.state.muted &&\n      this.state.s3URL &&\n      prevProps.soloTracks.length !== 0\n    ) {\n      this.audioFile.muted = false;\n      this.setState({\n        muted: false,\n      });\n    }\n\n    if (\n      this.state.s3URL &&\n      prevProps.masterVolume !== this.props.masterVolume\n    ) {\n      console.log(this.audioFile.volume);\n      console.log(this.props.masterVolume);\n      this.audioFile.volume = Math.min(1, this.props.masterVolume);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.audioFile) {\n      this.audioFile.pause();\n    }\n  }\n\n  // playPauseAudio = () => {\n  //   if (this.state.playing) {\n  //     this.audioFile.pause();\n  //     this.setState({ playing: false });\n  //   } else {\n  //     this.audioFile.play();\n  //     this.setState({ playing: true });\n  //   }\n  // };\n\n  stop = () => {\n    this.audioFile.currentTime = 0;\n    this.audioFile.pause();\n    this.setState({ playing: false });\n  };\n\n  changeVolume = (value) => {\n    // convert linear 1->100 to log 1->100 via f(n) = 50 * log(n)\n    // const volume = Math.max(0, 40 * Math.log10(value));\n    //   Math.max(0, (1 - Math.log(value) / Math.log(0.5)) / 9.5) * 100;\n    const volume = value;\n    this.audioFile.volume = (this.props.masterVolume * volume) / 80;\n    this.setState({ volume: volume });\n  };\n\n  seek = (value) => {\n    this.audioFile.currentTime = value;\n    this.audioFile.pause();\n    if (this.state.playing) {\n      this.audioFile.play();\n    }\n  };\n\n  fastForward = () => {\n    this.audioFile.pause();\n    const duration = this.audioFile.duration();\n    const currentSeek = this.audioFile.currentTime;\n    const forwardTo = currentSeek + 5;\n    if (forwardTo >= duration) {\n      this.audioFile.currentTime = 0;\n      this.audioFile.pause();\n      return;\n    }\n    console.log(\"ff: \" + currentSeek + \" -> \" + forwardTo);\n    this.audioFile.currentTime = forwardTo;\n    if (this.state.playing) {\n      this.audioFile.play();\n    }\n  };\n\n  rewind = () => {\n    this.audioFile.pause();\n    const currentSeek = this.audioFile.currentTime;\n    let backwardTo = currentSeek - 5;\n    if (backwardTo <= 0) {\n      backwardTo = 0;\n    }\n    console.log(\"rewind: \" + currentSeek + \" -> \" + backwardTo);\n    this.audioFile.currentTime = backwardTo;\n    if (this.state.playing) {\n      this.audioFile.play();\n    }\n  };\n\n  mute = () => {\n    this.audioFile.muted = !this.state.muted;\n    this.setState({\n      muted: !this.state.muted,\n    });\n  };\n\n  solo = () => {\n    this.props.updateSoloTracks(this.props.trackId);\n    if (!this.state.soloing) {\n      this.audioFile.muted = false;\n      this.setState({\n        soloing: true,\n        muted: false,\n      });\n    } else {\n      this.setState({\n        soloing: false,\n      });\n    }\n  };\n\n  selectToRecord = () => {\n    const updatedTrackId = !this.state.selected ? this.props.trackId : null;\n    this.props.setSelectedTrack(updatedTrackId);\n    this.setState({ selected: !this.state.selected });\n  };\n\n  _onSelect = (option) => {\n    console.log(\"Selected \" + option.label);\n    this.audioFile.currentTime = 0;\n    this.audioFile.pause();\n    const url = this.props.takes[option.value].s3_info;\n    this.setState({\n      playing: false,\n      selectedTake: option.value,\n      s3URL: url,\n    });\n    this.audioFile = document.getElementById(\n      `audio-file-${this.props.trackId}`\n    );\n  };\n\n  async deleteTake() {\n    console.log(\"deleting take\");\n    const targetTake = this.state.selectedTake;\n    const takeInfo = this.props.takes[targetTake];\n    let d;\n    if (takeInfo[\"date_uploaded\"].lastIndexOf(\" \") !== -1) {\n      d = new Date(\n        takeInfo[\"date_uploaded\"].substr(\n          0,\n          takeInfo[\"date_uploaded\"].lastIndexOf(\" \") + 1\n        )\n      );\n    } else {\n      d = new Date(takeInfo[\"date_uploaded\"]);\n    }\n    const formattedDateTime = d.toLocaleString(\"en-US\");\n\n    const name = `Take ${targetTake} - ${formattedDateTime}`;\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Take\"\n    );\n    if (result) {\n      if (this.audioFile) {\n        this.audioFile.currentTime = 0;\n        this.audioFile.pause();\n      }\n      await this.props.deleteTake(this.props.trackId, targetTake, takeInfo.id);\n\n      let newSelectedTake = null;\n      if (Object.keys(this.props.takes).length > 1) {\n        const takeCopy = Object.keys(this.props.takes);\n        takeCopy.splice(takeCopy.indexOf(targetTake), 1);\n        newSelectedTake = Math.max.apply(Math, takeCopy);\n        const newURL = this.props.takes[newSelectedTake].s3_info;\n        this.setState({\n          playing: false,\n          selectedTake: newSelectedTake,\n          s3URL: newURL,\n          latestTake: newSelectedTake,\n        });\n      } else {\n        console.log(\"unsetting audio file\");\n        this.setState({\n          playing: false,\n          selectedTake: newSelectedTake,\n          s3URL: null,\n          latestTake: 0,\n        });\n      }\n    }\n  }\n\n  clickThreeDotsMenu = (e) => {\n    this.setState({ threeDotsAnchorElement: e.currentTarget });\n  };\n\n  closeThreeDotsMenu = (e) => {\n    const option = e.target.innerText;\n    if (option === FILE_UPLOAD_OPTION) {\n      document.getElementById(`file-upload-${this.props.trackId}`).click();\n    } else if (option === RENAME_TRACK_OPTION) {\n      this.props.renameTrack(this.props.trackId, this.props.trackName);\n    } else if (option === DELETE_TRACK_OPTION) {\n      this.props.deleteTrack(this.props.trackId, this.props.trackName);\n    }\n    this.setState({ threeDotsAnchorElement: null });\n  };\n\n  render() {\n    let selectedKeyValue = { value: this.state.selectedTake };\n    const takeDropdownOptions = Object.keys(this.props.takes)\n      .reduce((acc, take) => {\n        if (parseInt(take) <= parseInt(this.state.latestTake)) {\n          const rawDate = this.props.takes[take][\"date_uploaded\"];\n          const d = new Date(rawDate);\n          const formattedDateTime = d.toLocaleString(\"en-US\");\n          if (take === this.state.selectedTake) {\n            selectedKeyValue[\"label\"] = `Take ${take} - ${formattedDateTime}`;\n          }\n          acc.push({\n            value: take,\n            label: `Take ${take} - ${formattedDateTime}`,\n          });\n        }\n        return acc;\n      }, [])\n      .reverse();\n    return (\n      <div style={{ marginLeft: \"5px\" }}>\n        <hr />\n        <div>\n          {this.state.selected ? (\n            <div style={{ display: \"inline-block\" }}>\n              <img\n                src=\"images/daw/selected.png\"\n                alt=\"selected\"\n                width=\"10\"\n                height=\"10\"\n              />{\" \"}\n              <b>Track: {this.props.trackName}</b>{\" \"}\n            </div>\n          ) : (\n            <div style={{ display: \"inline-block\" }}>\n              Track: {this.props.trackName}{\" \"}\n            </div>\n          )}\n          <button\n            title=\"Select/unselect track for recording\"\n            onClick={this.selectToRecord}\n            style={{ marginLeft: \"5px\" }}\n          >\n            {this.state.selected ? \"Unselect\" : \"Select to Record\"}\n          </button>\n          <IconButton\n            aria-label=\"more\"\n            aria-controls=\"track-menu\"\n            aria-haspopup=\"true\"\n            onClick={this.clickThreeDotsMenu}\n            style={{ marginLeft: \"5px\" }}\n          >\n            <MoreHorizIcon />\n          </IconButton>\n          <input\n            type=\"file\"\n            id={`file-upload-${this.props.trackId}`}\n            hidden\n            onChange={(e) => {\n              this.props.handleFileUpload(e.target.files, this.props.trackId);\n            }}\n          />\n          <Menu\n            id=\"track-menu\"\n            anchorEl={this.state.threeDotsAnchorElement}\n            keepMounted\n            open={this.state.threeDotsAnchorElement !== null}\n            onClose={this.closeThreeDotsMenu}\n            PaperProps={{\n              style: {\n                maxHeight: 40 * 4.5,\n                width: \"20ch\",\n              },\n            }}\n          >\n            {options.map((option) => (\n              <MenuItem key={option} onClick={this.closeThreeDotsMenu}>\n                {option}\n              </MenuItem>\n            ))}\n          </Menu>\n        </div>\n        {this.state.s3URL && Object.keys(this.props.takes).length > 0 && (\n          <div style={{ marginBottom: \"18px\" }}>\n            <Tooltip title=\"Mute\" arrow>\n              <IconButton\n                disableRipple\n                aria-label=\"Mute this track\"\n                onClick={this.mute}\n                style={{ marginTop: \"-12px\" }}\n              >\n                {this.state.muted ? (\n                  <VolumeOffRoundedIcon\n                    style={{ fontSize: 20 }}\n                    color=\"secondary\"\n                  />\n                ) : (\n                  <VolumeOffRoundedIcon style={{ fontSize: 20 }} />\n                )}\n              </IconButton>\n            </Tooltip>\n            <Tooltip title=\"Solo\" arrow>\n              <IconButton\n                disableRipple\n                aria-label=\"Solo this track\"\n                onClick={this.solo}\n                style={{ marginTop: \"-12px\" }}\n              >\n                {this.state.soloing ? (\n                  <HeadsetRoundedIcon\n                    style={{ fontSize: 20 }}\n                    color=\"secondary\"\n                  />\n                ) : (\n                  <HeadsetRoundedIcon style={{ fontSize: 20 }} />\n                )}\n              </IconButton>\n            </Tooltip>\n            {/* <div\n              style={{\n                display: \"inline-block\",\n                marginLeft: \"10px\",\n                marginRight: \"10px\",\n                width: \"55px\",\n              }}\n            >\n              Volume\n              <Slider\n                min={0}\n                max={80}\n                defaultValue={40}\n                onChange={this.changeVolume}\n              />\n            </div> */}\n\n            <audio\n              style={{\n                display: \"inline-flex\",\n                marginLeft: \"10px\",\n                marginBottom: \"-7px\",\n              }}\n              id={`audio-file-${this.props.trackId}`}\n              src={this.state.s3URL}\n              controls\n              preload=\"auto\"\n              autobuffer=\"true\"\n            />\n\n            <div\n              style={{\n                marginLeft: \"10px\",\n                display: \"inline-flex\",\n                width: 310,\n              }}\n            >\n              <Dropdown\n                options={takeDropdownOptions}\n                onChange={this._onSelect}\n                value={selectedKeyValue}\n                placeholder=\"Select an option\"\n              />\n            </div>\n            <div style={{ display: \"inline-flex\" }}>\n              <form method=\"get\" action={this.state.s3URL}>\n                <button type=\"submit\">Download Take</button>\n              </form>\n              <button onClick={this.deleteTake}>Delete Take</button>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default Track;\n","import React, { Component } from \"react\";\n\nclass LoadingGif extends Component {\n  render() {\n    return (\n      <div style={{ display: \"flex\", marginBottom: \"-8px\" }}>\n        <img\n          style={{\n            marginLeft: \"10px\",\n            marginRight: \"5px\",\n            marginTop: \"10px\",\n          }}\n          src=\"images/daw/loading.gif\"\n          alt=\"loading\"\n          width=\"32\"\n          height=\"32\"\n        />\n\n        <p>{` ${this.props.text}`}</p>\n      </div>\n    );\n  }\n}\n\nexport default LoadingGif;\n","import {\n  useDialog,\n  ModalContent,\n  ModalFooter,\n  ModalButton,\n} from \"react-st-modal\";\nimport { useState, useEffect, useCallback } from \"react\";\nimport \"./AlignRecording.css\";\nimport LoadingGif from \"./LoadingGif\";\nimport WaveSurfer from \"wavesurfer.js\";\nimport Draggable from \"react-draggable\";\nimport Crunker from \"crunker\"; // https://github.com/jackedgson/crunker\n\nexport default function AlignRecordingModalContent(props) {\n  const dialog = useDialog();\n\n  const [isPlaying, setPlaying] = useState(false);\n  const [bgWaveSurfer, setBgWaveSurfer] = useState(null);\n  const [recWaveSurfer, setRecWaveSurfer] = useState(null);\n  const [loadedAudio, setLoadedAudio] = useState(false);\n\n  const [dragOffset, setDragOffset] = useState(0);\n  const [latencyMagnitude, setLatencyMagnitude] = useState(0);\n\n  const onStopDrag = useCallback((_, position) => {\n    console.log(\"stopped:\", position.x);\n    const latency = 12.5053 * position.x + 7.3617;\n    console.log(latency);\n    setDragOffset(position.x);\n    setLatencyMagnitude(latency);\n  }, []);\n\n  useEffect(() => {\n    setBgWaveSurfer(\n      WaveSurfer.create({\n        container: \"#bg_waveform\",\n        waveColor: \"#D9DCFF\",\n        progressColor: \"#4353FF\",\n        cursorColor: \"#4353FF\",\n        cursorWidth: 1,\n        height: 200,\n        width: 1000,\n        interact: false,\n        hideScrollbar: true,\n      })\n    );\n    setRecWaveSurfer(\n      WaveSurfer.create({\n        container: \"#rec_waveform\",\n        waveColor: \"#D9DCFF\",\n        progressColor: \"#4353FF\",\n        cursorColor: \"#4353FF\",\n        cursorWidth: 1,\n        height: 200,\n        width: 1000,\n        interact: false,\n        hideScrollbar: true,\n      })\n    );\n  }, []);\n\n  useEffect(() => {\n    if (bgWaveSurfer && recWaveSurfer && dialog && !dialog.isOpen) {\n      bgWaveSurfer.stop();\n      recWaveSurfer.stop();\n    }\n  }, [bgWaveSurfer, recWaveSurfer, loadedAudio, dialog]);\n\n  useEffect(() => {\n    // console.log(\"loading recordings\");\n    // console.log(props.recordedURL, props.recordedTrackId, props.trackMetadata);\n    if (bgWaveSurfer && recWaveSurfer && !loadedAudio) {\n      const crunker = new Crunker();\n      let nonRecordedTrackURLs = Object.keys(props.trackMetadata)\n        .filter((trackId) => {\n          return trackId !== props.recordedTrackId;\n        })\n        .map((trackId) => {\n          // TODO: made executive decision to just pick latest track, but eventually need to fix how take state is stored so DAW Object can access it\n          const takeId = Object.keys(props.trackMetadata[trackId].takes).pop();\n          const audio_url = props.trackMetadata[trackId].takes[takeId].s3_info;\n          return audio_url;\n        });\n      console.log(nonRecordedTrackURLs);\n      crunker\n        .fetchAudio(...nonRecordedTrackURLs)\n        .then((buffers) => {\n          // => [AudioBuffer, AudioBuffer]\n          return crunker.mergeAudio(buffers);\n        })\n        .then((merged) => {\n          // => AudioBuffer\n          return crunker.export(merged, \"audio/mp3\");\n        })\n        .then((output) => {\n          // => {blob, element, url}\n          bgWaveSurfer.load(output.url);\n          recWaveSurfer.load(props.recordedURL);\n\n          bgWaveSurfer.setVolume(0.3);\n          recWaveSurfer.setVolume(0.2);\n\n          bgWaveSurfer.zoom(80);\n          recWaveSurfer.zoom(80);\n          setLoadedAudio(true);\n        });\n    }\n  }, [bgWaveSurfer, recWaveSurfer, loadedAudio, props]); // TODO check\n\n  return (\n    <div className=\"outerDiv\">\n      <div>\n        <Draggable axis=\"x\" bounds={{ left: -285, right: 285 }}>\n          <div className=\"cursor\">\n            <div className=\"point\" />\n            <div className=\"startLine\" />\n          </div>\n        </Draggable>\n        <ModalContent>\n          {!loadedAudio ? (\n            <LoadingGif text={\"Preparing alignment tool...\"} />\n          ) : (\n            <p>\n              Drag your recording left/right to align it, and move the red\n              cursor as a ruler to align peaks!\n            </p>\n          )}\n          <p>\n            <b>Backing Tracks</b>\n          </p>\n          <div id=\"bg_waveform\"></div>\n          <p>\n            <b>Recording</b>\n          </p>\n          <Draggable axis=\"x\" onStop={onStopDrag}>\n            <div id=\"rec_waveform\" style={{ marginLeft: \"-240px\" }}></div>\n          </Draggable>\n        </ModalContent>\n        <ModalFooter>\n          <ModalButton\n            onClick={() => {\n              if (isPlaying) {\n                bgWaveSurfer.pause();\n                recWaveSurfer.pause();\n              } else {\n                console.log(\"offset:\", dragOffset);\n\n                bgWaveSurfer.params.scrollParent = false;\n                recWaveSurfer.params.scrollParent = false;\n\n                bgWaveSurfer.seekTo(0);\n                recWaveSurfer.seekAndCenter(3 / recWaveSurfer.getDuration());\n\n                if (dragOffset > 0) {\n                  console.log(\"[recorded early]: user wants to playback later\");\n                  console.log(latencyMagnitude);\n                  bgWaveSurfer.play(null, 15);\n                  setTimeout(() => {\n                    recWaveSurfer.play(3, 10 - latencyMagnitude / 1000);\n                  }, latencyMagnitude);\n                } else if (dragOffset < 0) {\n                  console.log(\n                    \"[recorded late]: user wants to playback earlier\"\n                  );\n                  const latency = -latencyMagnitude;\n                  console.log(latency);\n                  bgWaveSurfer.play(null, 7);\n                  recWaveSurfer.play(3 + latency / 1000, 10 + latency / 1000);\n                  // setLatencyMagnitude(latency);\n                } else {\n                  bgWaveSurfer.play(null, 7);\n                  recWaveSurfer.play(3, 10);\n                }\n              }\n              setPlaying(!isPlaying);\n            }}\n          >\n            {!isPlaying ? \"Play\" : \"Stop\"}\n          </ModalButton>\n          <ModalButton\n            onClick={() => {\n              // lose the dialog and return the value\n              bgWaveSurfer.stop();\n              recWaveSurfer.stop();\n              console.log(\"returning value:\", latencyMagnitude);\n              dialog.close(Math.round(latencyMagnitude));\n            }}\n          >\n            Submit\n          </ModalButton>\n        </ModalFooter>\n      </div>\n    </div>\n  );\n}\n","import React, { Component } from \"react\";\nimport \"./DAW.css\";\nimport Track from \"./Track\";\nimport LoadingGif from \"./LoadingGif\";\nimport { CountdownCircleTimer } from \"react-countdown-circle-timer\";\nimport { CustomDialog } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\nimport AlignRecordingModalContent from \"./AlignRecording\";\nimport Slider from \"rc-slider\";\nimport \"rc-slider/assets/index.css\";\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport GetAppIcon from \"@material-ui/icons/GetApp\";\nimport PlayArrowRoundedIcon from \"@material-ui/icons/PlayArrowRounded\";\nimport StopRoundedIcon from \"@material-ui/icons/StopRounded\";\nimport FiberManualRecordRoundedIcon from \"@material-ui/icons/FiberManualRecordRounded\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport Crunker from \"crunker\";\n\nconst AudioContext = window.AudioContext || window.webkitAudioContext;\nconst WebAudioRecorder = window.WebAudioRecorder; // https://github.com/higuma/web-audio-recorder-js\nconst crunker = new Crunker();\n\nclass DAW extends Component {\n  constructor() {\n    super();\n    this.state = {\n      masterPlay: false,\n      masterStop: false,\n      masterRecord: false,\n      isRecording: false,\n      selectedTrackId: null, // to record\n      isBlocked: true,\n      showCountdown: false,\n      runningTime: 0,\n      soloTracks: [],\n      masterVolume: 0.5,\n      initialLoad: true,\n      isRehearsing: false,\n      stopMicProcessing: false,\n    };\n    this.audioContext = null;\n    this.gumStream = null;\n    this.input = null;\n    this.recorder = null;\n    this.toggleMasterRecord = this.toggleMasterRecord.bind(this);\n    this.toggleMasterStop = this.toggleMasterStop.bind(this);\n    this.stopMicrophone = this.stopMicrophone.bind(this);\n  }\n\n  componentDidUpdate() {\n    if (this.state.initialLoad) {\n      if (Object.keys(this.props.trackMetadata).length === 0) {\n        this.createTrack();\n      }\n      this.setState({ initialLoad: false });\n    }\n    if (this.state.masterPlay && this.state.masterStop) {\n      this.setState({\n        masterPlay: false,\n        masterStop: false,\n        runningTime: 0,\n      });\n    }\n  }\n\n  componentDidMount() {\n    console.log(\"reloading DAW\");\n    navigator.mediaDevices\n      .getUserMedia({ audio: true })\n      .then(() => {\n        console.log(\"mic permission granted\");\n        this.setState({ isBlocked: false });\n      })\n      .catch(() => {\n        console.log(\"MIC PERMISSIOM DENIED\");\n        this.setState({ isBlocked: true });\n      });\n\n    this.setState({\n      isRecording: false,\n      masterRecord: false,\n      selectedTrackId: null,\n      soloTracks: [],\n    });\n  }\n\n  // TRACK OPERATIONS\n\n  createTrack = () => {\n    this.props.createTrack();\n  };\n\n  renameTrack = (id, name) => {\n    this.props.renameTrack(id, name);\n  };\n\n  deleteTrack = (id, name) => {\n    const successfulDelete = this.props.deleteTrack(id, name);\n    if (successfulDelete) {\n      // if deleted a selected track, reset selected track\n      this.setState({ selectedTrackId: null });\n    }\n  };\n\n  // TAKE OPERATIONS\n\n  createTake = (track_id, file, is_manual_upload, latency = 0) => {\n    this.props.createTake(track_id, file, is_manual_upload, latency);\n  };\n\n  deleteTake = (track_id, take_number, take_id) => {\n    this.props.deleteTake(track_id, take_number, take_id);\n  };\n\n  // PLAYBACK OPERATIONS\n\n  toggleMasterPlay = () => {\n    console.log(\"> master play\");\n    this.setState((state) => {\n      const startTime = Date.now() - this.state.runningTime;\n      this.timer = setInterval(() => {\n        this.setState({ runningTime: Date.now() - startTime });\n      });\n      return { masterPlay: true };\n    });\n  };\n\n  async toggleMasterStop() {\n    console.log(\"> master stop\");\n    if (!this.state.masterPlay) {\n      return;\n    }\n    clearInterval(this.timer);\n    if (!this.state.isRecording) {\n      this.setState({\n        masterStop: true,\n        runningTime: 0,\n      });\n    } else {\n      this.setState({\n        masterStop: true,\n        runningTime: 0,\n        stopMicProcessing: true,\n      });\n      //stop microphone access\n      this.gumStream.getAudioTracks()[0].stop();\n      this.recorder.finishRecording();\n    }\n  }\n\n  // https://codesandbox.io/s/v67oz43lm7?file=/src/index.js\n  async toggleMasterRecord() {\n    console.log(\"> master record\");\n    if (this.state.selectedTrackId === null) {\n      alert(\"Select a track to record!\");\n    } else {\n      console.log(\"recording track \" + this.state.selectedTrackId);\n      this.startMicrophone();\n      this.setState((state) => {\n        return {\n          masterRecord: true,\n          showCountdown: true,\n          isRecording: true,\n        };\n      });\n    }\n  }\n\n  startMicrophone = () => {\n    console.log(\"begin start recording\");\n    this.audioContext = new AudioContext();\n    navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {\n      console.log(\n        \"getUserMedia() success, stream created, initializing WebAudioRecorder...\"\n      );\n      this.gumStream = stream;\n\n      /* use the stream */\n      this.input = this.audioContext.createMediaStreamSource(stream);\n\n      this.recorder = new WebAudioRecorder(this.input, {\n        workerDir: \"js/\", // must end with slash\n        encoding: \"mp3\",\n        numChannels: 2, //2 is the default, mp3 encoding supports only 2\n      });\n\n      this.recorder.setOptions({\n        timeLimit: 600,\n        encodeAfterRecord: true,\n        mp3: { bitRate: 320 },\n      });\n\n      this.recorder.onComplete = async (recorder, blob) => {\n        console.log(\"encoding complete\");\n        this.gumStream.getAudioTracks()[0].stop();\n        await this.stopMicrophone(blob);\n      };\n\n      this.recorder.startRecording();\n    });\n  };\n\n  async stopMicrophone(blob) {\n    console.log(\"stopping microphone with blob\", blob);\n    let file = new File(\n      [blob],\n      `recording_track_${this.state.selectedTrackId}.mp3`\n    );\n    let recordedURL = URL.createObjectURL(file);\n    let latency = 0; // in ms\n    this.setState({ stopMicProcessing: false });\n    if (Object.keys(this.props.trackMetadata).length > 1) {\n      latency = await CustomDialog(\n        <AlignRecordingModalContent\n          recordedURL={recordedURL}\n          recordedTrackId={this.state.selectedTrackId}\n          trackMetadata={this.props.trackMetadata}\n        />,\n        {\n          title: \"Check Recording\",\n          showCloseIcon: true,\n          isCanClose: false,\n        }\n      );\n      console.log(\"latency:\", latency);\n    }\n    const isManualUpload = false;\n    this.createTake(this.state.selectedTrackId, file, isManualUpload, latency);\n    this.setState({\n      isRecording: false,\n      masterRecord: false,\n    });\n  }\n\n  handleFileUpload = (files, targetId) => {\n    console.log(\"handling file upload for target track id\", targetId);\n    if (\n      files === null ||\n      files[0] === null ||\n      typeof files[0] === \"undefined\"\n    ) {\n      return;\n    }\n    if (/\\.(mp3|ogg|wav|flac|aac|aiff|m4a)$/i.test(files[0].name)) {\n      console.log(\"> validated file: \", files[0].name);\n      const isManualUpload = true;\n      this.createTake(targetId, files[0], isManualUpload);\n    } else {\n      alert(\n        \"Please upload valid audio file type (mp3, ogg, wav, flac, aac, aiff, m4a)\"\n      );\n      return;\n    }\n  };\n\n  setSelectedTrack = (id) => {\n    const newId = id !== null ? id : null;\n    console.log(\"selecting track to record: \" + newId);\n    this.setState({ selectedTrackId: newId });\n  };\n\n  formattedTime = (ms) => {\n    let minutes = Math.floor(ms / 60000);\n    let seconds = ((ms % 60000) / 1000).toFixed(2);\n    return minutes + \":\" + (seconds < 10 ? \"0\" : \"\") + seconds;\n  };\n\n  updateSoloTracks = (trackId) => {\n    let newSoloTracks = [...this.state.soloTracks];\n    let index = newSoloTracks.indexOf(trackId);\n\n    if (index !== -1) {\n      // remove\n      newSoloTracks.splice(index, 1);\n    } else {\n      // add\n      newSoloTracks.push(trackId);\n    }\n    console.log(\"new solo tracks:\", newSoloTracks);\n    this.setState({ soloTracks: newSoloTracks });\n  };\n\n  changeVolume = (value) => {\n    this.setState({ masterVolume: value / 100 });\n  };\n\n  rehearse = () => {\n    console.log(\"currently rehearsing:\", this.state.isRehearsing);\n    this.setState({\n      isRehearsing: !this.state.isRehearsing,\n    });\n  };\n\n  downloadMixedTrack = () => {\n    console.log(\"downloading track\");\n    let latestTakeURLs = Object.keys(this.props.trackMetadata)\n      .filter((trackId) => {\n        const numTakes = Object.keys(this.props.trackMetadata[trackId].takes)\n          .length;\n        return numTakes !== 0;\n      })\n      .map((trackId) => {\n        const takes = this.props.trackMetadata[trackId].takes;\n        const takeId = Object.keys(takes).pop();\n        console.log(takeId);\n        return takes[takeId].s3_info;\n      });\n    console.log(latestTakeURLs);\n    crunker\n      .fetchAudio(...latestTakeURLs)\n      .then((buffers) => {\n        return crunker.mergeAudio(buffers);\n      })\n      .then((merged) => {\n        return crunker.export(merged, \"audio/mp3\");\n      })\n      .then((output) => {\n        // https://stackoverflow.com/questions/50694881/how-to-download-file-in-react-js\n        const link = document.createElement(\"a\");\n        link.href = output.url;\n        const d = new Date();\n        const datestring = `${d.getFullYear()}_${\n          d.getMonth() + 1\n        }_${d.getDate()}`;\n        const timestring = `${d.getHours()}_${d.getMinutes()}_${d.getDate()}_${\n          d.getHours() >= 12 ? \"PM\" : \"AM\"\n        }`;\n        const outputFilename = `${this.props.projectName}_${datestring}-${timestring}`;\n        link.setAttribute(\"download\", outputFilename);\n\n        document.body.appendChild(link); // Append to html link element page\n        link.click(); // Start download\n        link.parentNode.removeChild(link); // Clean up and remove the link\n      });\n  };\n\n  render() {\n    return (\n      <div>\n        <div>\n          {this.props.trackMetadata &&\n          Object.keys(this.props.trackMetadata).length > 0 ? (\n            Object.keys(this.props.trackMetadata).map((trackId) => {\n              const trackInfo = this.props.trackMetadata[trackId];\n              return (\n                <div key={`track_${trackId}`}>\n                  <div>\n                    <Track\n                      trackName={trackInfo.track_name}\n                      trackId={trackId}\n                      takes={trackInfo.takes}\n                      masterPlay={this.state.masterPlay}\n                      masterStop={this.state.masterStop}\n                      masterRecord={this.state.masterRecord}\n                      selectedTrackId={this.state.selectedTrackId}\n                      setSelectedTrack={this.setSelectedTrack}\n                      deleteTake={this.deleteTake}\n                      soloTracks={this.state.soloTracks}\n                      updateSoloTracks={this.updateSoloTracks}\n                      masterVolume={this.state.masterVolume}\n                      renameTrack={this.renameTrack}\n                      deleteTrack={this.deleteTrack}\n                      handleFileUpload={this.handleFileUpload}\n                    />\n                  </div>\n                  {Object.keys(this.props.trackMetadata[trackId].takes)\n                    .length === 0 && (\n                    <div style={{ marginTop: \"-20px\" }}>\n                      <input\n                        style={{\n                          marginLeft: \"20px\",\n                          marginTop: \"25px\",\n                          marginBottom: \"20px\",\n                        }}\n                        type=\"file\"\n                        onChange={(e) =>\n                          this.handleFileUpload(e.target.files, trackId)\n                        }\n                      />\n                    </div>\n                  )}\n                </div>\n              );\n            })\n          ) : (\n            <div style={{ marginTop: \"10px\" }} />\n          )}\n        </div>\n        <button\n          style={{ marginTop: \"10px\", marginLeft: \"5px\", marginBottom: \"28px\" }}\n          className=\"stitched\"\n          onClick={this.createTrack}\n        >\n          + New Track\n        </button>\n        <div style={{ display: \"flex\" }}>\n          <p style={{ marginBottom: \"5px\" }}>\n            <b>Master Controls</b>\n          </p>\n          {this.state.stopMicProcessing && (\n            <LoadingGif text={\"Saving Recording...\"} />\n          )}\n        </div>\n        {this.state.isBlocked && (\n          <p style={{ marginBottom: \"5px\" }}>\n            Please allow access to your mic to record!\n          </p>\n        )}\n        {/* TODO: Live Monitoring, Rehearse */}\n        <Tooltip title=\"Record selected track\" arrow>\n          <span>\n            <IconButton\n              disableRipple\n              aria-label=\"Record\"\n              onClick={this.toggleMasterRecord}\n              disabled={this.state.masterPlay || this.state.isBlocked}\n            >\n              {this.state.masterPlay || this.state.isBlocked ? (\n                <FiberManualRecordRoundedIcon style={{ fontSize: 28 }} />\n              ) : (\n                <FiberManualRecordRoundedIcon\n                  style={{ fontSize: 28 }}\n                  color=\"secondary\"\n                />\n              )}\n            </IconButton>\n          </span>\n        </Tooltip>\n        <Tooltip title={this.state.masterPlay ? \"Stop all tracks\" : \"\"} arrow>\n          <span>\n            <IconButton\n              disableRipple\n              aria-label=\"Stop\"\n              onClick={this.toggleMasterStop}\n              disabled={!this.state.masterPlay}\n            >\n              <StopRoundedIcon style={{ fontSize: 35 }} />\n            </IconButton>\n          </span>\n        </Tooltip>\n        <Tooltip title=\"Play all tracks\" arrow>\n          <span>\n            <IconButton\n              disableRipple\n              aria-label=\"Play\"\n              onClick={this.toggleMasterPlay}\n              disabled={\n                this.state.masterPlay ||\n                Object.keys(this.props.trackMetadata).length === 0\n              }\n              style={{ marginLeft: \"-5px\" }}\n            >\n              <PlayArrowRoundedIcon style={{ fontSize: 35 }} />\n            </IconButton>\n          </span>\n        </Tooltip>{\" \"}\n        {this.formattedTime(this.state.runningTime)}\n        <div style={{ display: \"flex\", marginTop: \"-45px\" }}>\n          <div\n            style={{\n              position: \"relative\",\n              marginLeft: \"245px\",\n              width: \"100px\",\n            }}\n          >\n            Volume\n            <Slider\n              min={0}\n              max={100}\n              defaultValue={100}\n              onChange={this.changeVolume}\n            />\n          </div>\n          <Tooltip\n            title=\"Download full track with latest takes\"\n            arrow\n            style={{ marginLeft: \"10px\", marginTop: \"-10px\" }}\n          >\n            <span>\n              <IconButton\n                disableRipple\n                aria-label=\"Download full track with latest takes\"\n                onClick={this.downloadMixedTrack}\n                style={{\n                  marginBottom: \"-10px\",\n                }}\n              >\n                <GetAppIcon style={{ fontSize: 30 }} />\n              </IconButton>\n            </span>\n          </Tooltip>\n        </div>\n        {this.state.showCountdown && (\n          <div\n            className=\"timer\"\n            style={{\n              position: \"absolute\",\n              marginLeft: \"440px\",\n              marginTop: \"-105px\",\n            }}\n          >\n            <CountdownCircleTimer\n              isPlaying\n              duration={3}\n              colors={[[\"#0f52bd\", 1]]}\n              size={90}\n              onComplete={() => {\n                const startTime = Date.now() - this.state.runningTime;\n                this.timer = setInterval(() => {\n                  this.setState({ runningTime: Date.now() - startTime });\n                });\n                this.setState({ showCountdown: false, masterPlay: true });\n              }}\n            >\n              {({ remainingTime }) => remainingTime}\n            </CountdownCircleTimer>\n            <button\n              onClick={() => {\n                this.setState({\n                  showCountdown: false,\n                });\n                this.toggleMasterStop();\n              }}\n              style={{ marginTop: \"10px\", marginBottom: \"10px\" }}\n            >\n              Ahh I'm not ready!\n            </button>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default DAW;\n","import React, { Component } from \"react\";\nimport DAW from \"./daw/DAW\";\nimport LoadingGif from \"./daw/LoadingGif\";\nimport { Prompt, Confirm } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\n\nimport SyncRoundedIcon from \"@material-ui/icons/SyncRounded\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\n\nclass Project extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      project_name: null,\n      group_name: null,\n      project_id: null,\n      track_metadata: null,\n      project_hash: props.location.pathname.split(\"/\").pop(),\n      isCreatingTake: false,\n      isDeletingTakeOrTrack: false,\n    };\n    if (this.state.project_hash === \"project\") {\n      this.state.project_hash = null;\n    }\n    this.createTrack = this.createTrack.bind(this);\n    this.deleteTrack = this.deleteTrack.bind(this);\n    this.renameTrack = this.renameTrack.bind(this);\n    this.createTake = this.createTake.bind(this);\n    this.deleteTake = this.deleteTake.bind(this);\n  }\n\n  componentDidMount() {\n    this.retrieveProject(this.state.project_hash);\n  }\n\n  componentDidUpdate(prevProps) {\n    const pathname = this.props.location.pathname.split(\"/\").pop();\n    // fetch project if last page was project search page\n    if (\n      pathname !== \"project\" &&\n      pathname !== null &&\n      this.props.location.pathname !== prevProps.location.pathname\n    ) {\n      this.retrieveProject(pathname);\n      // loaded project search page\n    } else if (pathname === \"project\" && this.state.project_hash !== null) {\n      this.setState({\n        project_hash: null,\n        project_name: null,\n        group_name: null,\n        project_id: null,\n        track_metadata: null,\n      });\n    }\n  }\n\n  retrieveProject = (project_hash) => {\n    console.log(\"retrieving project: \" + project_hash);\n    if (project_hash === null || project_hash === \"\") {\n      return;\n    }\n    fetch(\"/api/project?\" + new URLSearchParams({ project_hash: project_hash }))\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        const tracks = obj.body.tracks\n          ? obj.body.tracks.reduce((obj, item) => {\n              const formatted_takes = item[\"takes\"].reduce((obj, item) => {\n                obj[item[\"take\"]] = {\n                  date_uploaded: item[\"date_uploaded\"],\n                  id: item[\"id\"],\n                  s3_info: item[\"s3_info\"],\n                  track_id: item[\"track_id\"],\n                };\n                return obj;\n              }, {});\n              obj[item[\"id\"]] = {\n                takes: formatted_takes,\n                track_name: item[\"track_name\"],\n              };\n              return obj;\n            }, {})\n          : {};\n        if (obj.status === 200) {\n          this.setState({\n            project_hash: project_hash,\n            project_name: obj.body.project_name,\n            group_name: obj.body.group.group_name,\n            project_id: obj.body.id,\n            track_metadata: tracks,\n          });\n        }\n      });\n  };\n\n  async createTrack() {\n    console.log(\"creating new track\");\n    const track_name = await Prompt(\"Name Your Track\");\n    if (track_name) {\n      const formData = new FormData();\n      formData.append(\"track_name\", track_name);\n      formData.append(\"project_id\", this.state.project_id);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n      fetch(\"/api/track\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status !== 400) {\n            console.log(\"added new track\");\n            let updatedTracks = Object.assign({}, this.state.track_metadata);\n            updatedTracks[obj.body.track_id] = {\n              id: parseInt(obj.body.track_id),\n              project_id: this.state.projectId,\n              takes: {},\n              track_name: track_name,\n            };\n            this.setState({ track_metadata: updatedTracks });\n          }\n        });\n    }\n  }\n\n  async renameTrack(id, name) {\n    console.log(\"renaming track\");\n    const new_name = await Prompt(\"Rename Your Track\", {\n      defaultValue: name,\n    });\n    if (new_name) {\n      const formData = new FormData();\n      formData.append(\"track_id\", id);\n      formData.append(\"new_name\", new_name);\n      const requestOptions = {\n        method: \"PUT\",\n        body: formData,\n      };\n      fetch(\"/api/track\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            let updatedTracks = Object.assign({}, this.state.track_metadata);\n            updatedTracks[id].track_name = new_name;\n            this.setState({ track_metadata: updatedTracks });\n          }\n        });\n    }\n  }\n\n  async deleteTrack(id, name) {\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Track\"\n    );\n    if (result) {\n      this.setState({ isDeletingTakeOrTrack: true });\n      const formData = new FormData();\n      formData.append(\"track_id\", id);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/track\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedTracks = Object.assign({}, this.state.track_metadata);\n            delete updatedTracks[id];\n            this.setState({\n              track_metadata: updatedTracks,\n              isDeletingTakeOrTrack: false,\n            });\n            return true;\n          }\n          this.setState({ isDeletingTakeOrTrack: false });\n        });\n    }\n    return false;\n  }\n\n  createTake(track_id, file, is_manual_upload, latency) {\n    console.log(\"creating new take for\", track_id);\n    this.setState({ isCreatingTake: true });\n    const formData = new FormData();\n    formData.append(\"track_id\", track_id);\n    formData.append(\"file\", file);\n    formData.append(\"latency\", latency);\n    formData.append(\"tz_offset\", new Date().getTimezoneOffset() / 60);\n    formData.append(\"is_manual_upload\", is_manual_upload);\n\n    const requestOptions = {\n      method: \"POST\",\n      body: formData,\n    };\n\n    fetch(\"/api/take\", requestOptions)\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        if (obj.status !== 400) {\n          console.log(\"CREATED TAKE:\", obj);\n          let updatedTracks = Object.assign({}, this.state.track_metadata);\n          updatedTracks[parseInt(track_id)].takes[parseInt(obj.body.take)] = {\n            id: parseInt(obj.body.take_id),\n            track_id: parseInt(track_id),\n            s3_info: obj.body.s3_info,\n            date_uploaded: new Date(obj.body.timestamp).toString(),\n          };\n          this.setState({\n            track_metadata: updatedTracks,\n            isCreatingTake: false,\n          });\n        } else {\n          this.setState({ isCreatingTake: false });\n        }\n      })\n      .catch((error) => {\n        alert(\"Could not upload take due to server error (see console).\");\n        console.log(error);\n        this.setState({ isCreatingTake: false });\n      });\n  }\n\n  deleteTake(track_id, take_number, take_id) {\n    this.setState({ isDeletingTakeOrTrack: true });\n    const formData = new FormData();\n    formData.append(\"take_id\", take_id);\n    const requestOptions = {\n      method: \"DELETE\",\n      body: formData,\n    };\n    fetch(\"/api/take\", requestOptions)\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        if (obj.status === 200) {\n          const updatedTracks = Object.assign({}, this.state.track_metadata);\n          delete updatedTracks[track_id].takes[take_number];\n          this.setState({\n            track_metadata: updatedTracks,\n            isDeletingTakeOrTrack: false,\n          });\n        } else {\n          this.setState({ isDeletingTakeOrTrack: false });\n        }\n      });\n  }\n\n  refresh = () => {\n    console.log(\"refreshing project\");\n    this.retrieveProject(this.state.project_hash);\n  };\n\n  render() {\n    const pathSuffix = this.props.location.pathname.split(\"/\").pop();\n\n    // show loading screen if have not retrieved data yet\n    if (this.state.project_name === null && pathSuffix !== \"project\") {\n      return <div>Loading...</div>;\n    }\n\n    return (\n      this.state.project_hash &&\n      pathSuffix !== \"project\" &&\n      pathSuffix !== \"\" && (\n        <div>\n          <div\n            style={{\n              display: \"flex\",\n              marginBottom: \"-17px\",\n              marginTop: \"-5px\",\n            }}\n          >\n            <h2>\n              {this.state.project_name}\n              <Tooltip\n                title=\"Refresh latest project info\"\n                arrow\n                placement=\"right\"\n              >\n                <IconButton\n                  disableRipple\n                  aria-label=\"Sync\"\n                  onClick={this.refresh}\n                  style={{ marginTop: \"0px\" }}\n                >\n                  <SyncRoundedIcon style={{ fontSize: 20 }} />\n                </IconButton>\n              </Tooltip>\n            </h2>\n            {this.state.isCreatingTake && (\n              <div style={{ marginTop: \"-5px\" }}>\n                <LoadingGif text=\"Uploading take...\" />\n              </div>\n            )}\n            {this.state.isDeletingTakeOrTrack && (\n              <div style={{ marginTop: \"-5px\" }}>\n                <LoadingGif text=\"Deleting...\" />\n              </div>\n            )}\n          </div>\n          <div style={{ marginTop: \"20px\" }}>\n            <DAW\n              projectName={this.state.project_name}\n              trackMetadata={this.state.track_metadata}\n              retrieveProject={this.retrieveProject}\n              createTrack={this.createTrack}\n              deleteTrack={this.deleteTrack}\n              renameTrack={this.renameTrack}\n              createTake={this.createTake}\n              deleteTake={this.deleteTake}\n            />\n          </div>\n        </div>\n      )\n    );\n  }\n}\n\nexport default Project;\n","import React, { useState } from \"react\";\n\n// mimics Zoom's search functionality (i.e. if you enter mit.zoom.us/j/ without any ID)\nfunction ProjectSearch(props) {\n  const [projectId, setProjectId] = useState(\"\");\n\n  const searchProject = (e) => {\n    console.log(\"projectId\", projectId);\n    e.preventDefault();\n    fetch(\"/api/project?\" + new URLSearchParams({ project_hash: projectId }))\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        console.log(obj);\n        if (obj.status === 200) {\n          props.history.push(`/project/${projectId}`);\n        }\n      })\n      .catch(function (err) {\n        alert(\"Cannot find project ID or URL: \" + projectId, err);\n      });\n  };\n\n  const handleChange = (e) => {\n    e.preventDefault();\n    // parse project id out of url\n    if (e.target.value.startsWith(\"http\")) {\n      setProjectId(e.target.value.split(\"/\").pop());\n    } else {\n      setProjectId(e.target.value);\n    }\n  };\n\n  return (\n    <div>\n      <h2>Find a Project</h2>\n      <br></br>\n      <form style={{ marginLeft: 10 }}>\n        <input\n          style={{ width: 250 }}\n          type=\"text\"\n          value={projectId}\n          onChange={handleChange}\n          placeholder=\"Enter Project ID or URL\"\n        ></input>\n        <input type=\"submit\" hidden></input>\n        <button onClick={searchProject}>Go!</button>\n      </form>\n    </div>\n  );\n}\n\nexport default ProjectSearch;\n","import React, { Component } from \"react\";\n\nclass Home extends Component {\n  render() {\n    return (\n      <div>\n        <h2>HOMEPAGE</h2>\n        {!this.props.authed ? (\n          <p>Login to get started! </p>\n        ) : (\n          <p>\n            Click on \"Groups\" to create a rehearsal group first, then \"Projects\"\n            to create a project.{\" \"}\n          </p>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default Home;\n","import React, { useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\n\nconst RENAME_PROJECT_OPTION = \"Rename Project\";\nconst DELETE_PROJECT_OPTION = \"Delete Project\";\nconst options = [RENAME_PROJECT_OPTION, DELETE_PROJECT_OPTION];\n\nfunction Project(props) {\n  const history = useHistory();\n  const [threeDotsAnchorElement, setThreeDotsAnchorElement] = useState(null);\n\n  const rehearse = () => {\n    history.push({\n      pathname: `/project/${props.project.project_hash}`,\n      state: {\n        project: props.project,\n        group_name: props.group_name,\n        group_id: props.group_id,\n      },\n    });\n  };\n\n  const clickThreeDotsMenu = (e) => {\n    setThreeDotsAnchorElement(e.currentTarget);\n  };\n\n  const closeThreeDotsMenu = (e) => {\n    const option = e.target.innerText;\n    if (option === RENAME_PROJECT_OPTION) {\n      props.renameProject(props.project.id, props.project.project_name);\n    } else if (option === DELETE_PROJECT_OPTION) {\n      props.deleteProject(props.project.id, props.project.project_name);\n    }\n    setThreeDotsAnchorElement(null);\n  };\n\n  return (\n    <li>\n      Project: {props.project.project_name}{\" \"}\n      <button onClick={rehearse}>Rehearse!</button>\n      <IconButton\n        aria-label=\"more\"\n        aria-controls=\"project-menu\"\n        aria-haspopup=\"true\"\n        onClick={clickThreeDotsMenu}\n        style={{ marginLeft: \"5px\" }}\n      >\n        <MoreHorizIcon />\n      </IconButton>\n      <Menu\n        id=\"project-menu\"\n        anchorEl={threeDotsAnchorElement}\n        keepMounted\n        open={threeDotsAnchorElement !== null}\n        onClose={closeThreeDotsMenu}\n        PaperProps={{\n          style: {\n            maxHeight: 40 * 4.5,\n            width: \"20ch\",\n          },\n        }}\n      >\n        {options.map((option) => (\n          <MenuItem key={option} onClick={closeThreeDotsMenu}>\n            {option}\n          </MenuItem>\n        ))}\n      </Menu>\n    </li>\n  );\n}\n\nexport default Project;\n","import React, { Component } from \"react\";\nimport Project from \"./Project\";\nimport \"./Group.css\";\nimport { Prompt, Confirm } from \"react-st-modal\";\n\nconst RENAME_GROUP_OPTION = \"Rename Group\";\nconst DELETE_GROUP_OPTION = \"Delete Group\";\n\nclass Group extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      projects: props.projects,\n      threeDotsAnchorElement: null,\n    };\n    this.createNewProject = this.createNewProject.bind(this);\n    this.deleteProject = this.deleteProject.bind(this);\n    this.renameProject = this.renameProject.bind(this);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.projects !== prevProps.projects) {\n      this.setState({ projects: this.props.projects });\n    }\n  }\n\n  async createNewProject() {\n    const project_name = await Prompt(\"Name Your Project\");\n    if (project_name) {\n      const formData = new FormData();\n      formData.append(\"project_name\", project_name);\n      formData.append(\"group_id\", this.props.id);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n\n      fetch(\"/api/project\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status !== 400) {\n            this.setState({\n              projects: this.state.projects.concat([\n                {\n                  project_name: project_name,\n                  id: obj.body.project_id,\n                  project_hash: obj.body.project_hash,\n                },\n              ]),\n            });\n          }\n        });\n    }\n  }\n\n  async deleteProject(id, name) {\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Project\"\n    );\n    if (result) {\n      const formData = new FormData();\n      formData.append(\"project_id\", id);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/project\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedProjects = [...this.state.projects].filter(\n              (i) => i.id !== id\n            );\n            this.setState({\n              projects: updatedProjects,\n            });\n          }\n        });\n    }\n  }\n\n  async renameProject(id, name) {\n    const new_name = await Prompt(\"Rename Your Project\", {\n      defaultValue: name,\n    });\n    if (new_name) {\n      const formData = new FormData();\n      formData.append(\"project_id\", id);\n      formData.append(\"new_name\", new_name);\n      const requestOptions = {\n        method: \"PUT\",\n        body: formData,\n      };\n\n      fetch(\"/api/project\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedProjects = [\n              ...this.state.projects,\n            ].map((projectInfo) =>\n              projectInfo.id === id\n                ? { ...projectInfo, project_name: new_name }\n                : projectInfo\n            );\n            this.setState({\n              projects: updatedProjects,\n            });\n          }\n        });\n    }\n  }\n\n  clickThreeDotsMenu = (e) => {\n    this.setState({ threeDotsAnchorElement: e.currentTarget });\n  };\n\n  closeThreeDotsMenu = (e) => {\n    const option = e.target.innerText;\n    if (option === RENAME_GROUP_OPTION) {\n      this.props.renameGroup(this.props.id, this.props.name);\n    } else if (option === DELETE_GROUP_OPTION) {\n      this.props.deleteGroup(this.props.id, this.props.name);\n    }\n    this.setState({ threeDotsAnchorElement: null });\n  };\n\n  render() {\n    let sortedProjects = this.state.projects.sort((a, b) =>\n      a.id > b.id ? 1 : -1\n    );\n    return (\n      <div style={{ marginTop: \"25px\", marginBottom: \"-10px\" }}>\n        <p>\n          Group: {this.props.name}\n          {\"  \"}\n          <button onClick={this.createNewProject}>+ Project</button>\n        </p>\n        <div style={{ marginTop: \"20px\" }}>\n          <ul>\n            {this.state.projects && this.state.projects.length === 0 && (\n              <p\n                className=\"text-muted\"\n                style={{ marginTop: \"-10px\", marginBottom: \"20px\" }}\n              >\n                No projects created yet!\n              </p>\n            )}\n            {sortedProjects.map((projectInfo, i) => (\n              <div key={`project_${i}`}>\n                <div style={{ marginTop: \"-20px\", marginBottom: \"-10px\" }}>\n                  <Project\n                    project={projectInfo}\n                    group_name={this.props.name}\n                    group_id={this.props.id}\n                    renameProject={this.renameProject}\n                    deleteProject={this.deleteProject}\n                  />\n                </div>\n              </div>\n            ))}\n          </ul>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Group;\n","import React, { Component } from \"react\";\nimport Group from \"./Group\";\nimport \"./Projects.css\";\nimport { Confirm, Prompt } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\n\nimport SyncRoundedIcon from \"@material-ui/icons/SyncRounded\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\n\nclass Projects extends Component {\n  constructor() {\n    super();\n    this.state = {\n      groups: [],\n      isLoaded: false,\n    };\n    this.fetchGroups();\n    this.createNewGroup = this.createNewGroup.bind(this);\n    this.deleteGroup = this.deleteGroup.bind(this);\n    this.renameGroup = this.renameGroup.bind(this);\n  }\n\n  fetchGroups = () => {\n    fetch(\"/api/groups\", {\n      method: \"GET\",\n    })\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((res) => {\n        if (res.status !== 400) {\n          this.setState({ groups: res.body, isLoaded: true });\n        }\n      });\n  };\n\n  async createNewGroup() {\n    console.log(\"creating new group!\");\n    const group_name = await Prompt(\"Name Your Group\");\n    if (group_name) {\n      const formData = new FormData();\n      formData.append(\"group_name\", group_name);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status !== 400) {\n            this.setState({\n              groups: this.state.groups.concat([\n                { group_name: group_name, id: obj.body.group_id, projects: [] },\n              ]),\n            });\n          }\n        });\n    }\n  }\n\n  async deleteGroup(id, name) {\n    console.log(\"deleting group\");\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Group\"\n    );\n    if (result) {\n      const formData = new FormData();\n      formData.append(\"group_id\", id);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedGroups = [...this.state.groups].filter(\n              (i) => i.id !== id\n            );\n            this.setState({\n              groups: updatedGroups,\n            });\n          }\n        });\n    }\n  }\n\n  async renameGroup(id, name) {\n    console.log(\"renaming group\");\n    const new_name = await Prompt(\"Rename Your Group\", {\n      defaultValue: name,\n    });\n    if (new_name) {\n      const formData = new FormData();\n      formData.append(\"new_name\", new_name);\n      formData.append(\"group_id\", id);\n      const requestOptions = {\n        method: \"PUT\",\n        body: formData,\n      };\n\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedGroups = [...this.state.groups].map((groupInfo) =>\n              groupInfo.id === id\n                ? { ...groupInfo, group_name: new_name }\n                : groupInfo\n            );\n            this.setState({\n              groups: updatedGroups,\n            });\n          }\n        });\n    }\n  }\n\n  refresh = () => {\n    console.log(\"refreshing\");\n    this.fetchGroups();\n  };\n\n  render() {\n    if (!this.state.isLoaded) {\n      return <div>Loading...</div>;\n    }\n    return (\n      <div style={{ marginBottom: \"10px\" }}>\n        <h2 style={{ marginBottom: \"-25px\" }}>\n          PROJECTS\n          <Tooltip title=\"Refresh latest projects\" arrow placement=\"right\">\n            <IconButton\n              style={{ marginTop: \"-3px\" }}\n              disableRipple\n              aria-label=\"Sync\"\n              onClick={this.refresh}\n            >\n              <SyncRoundedIcon style={{ fontSize: 25 }} />\n            </IconButton>\n          </Tooltip>\n        </h2>\n        {this.state.groups && this.state.groups.length === 0 && (\n          <p style={{ marginTop: \"20px\" }} class=\"text-muted\">\n            Create a group first!\n          </p>\n        )}\n        {this.state.groups &&\n          this.state.groups.map((groupInfo, i) => (\n            <div key={`group_${i}`}>\n              <Group\n                id={groupInfo.id}\n                name={groupInfo.group_name}\n                projects={groupInfo.projects}\n                renameGroup={this.renameGroup}\n                deleteGroup={this.deleteGroup}\n              />\n            </div>\n          ))}\n      </div>\n    );\n  }\n}\n\nexport default Projects;\n","import React, { Component } from \"react\";\n\nclass Member extends Component {\n  removeMember = () => {\n    this.props.removeMember(this.props.id);\n  };\n\n  render() {\n    const hideRemoveButton = !this.props.onlyMemberInGroup;\n    return (\n      <div>\n        <li>\n          Member: {this.props.name}{\" \"}\n          {hideRemoveButton && (\n            <button onClick={this.removeMember}>Remove</button>\n          )}\n        </li>\n      </div>\n    );\n  }\n}\n\nexport default Member;\n","import {\n  useDialog,\n  ModalContent,\n  ModalFooter,\n  ModalButton,\n} from \"react-st-modal\";\nimport { useState } from \"react\";\n\nimport Dropdown from \"react-dropdown\";\nimport \"react-dropdown/style.css\";\n\nexport default function AddMemberModalContent(props) {\n  const dialog = useDialog();\n\n  const [newUserId, setNewUserId] = useState(null);\n  const [newUserName, setNewUserName] = useState(null);\n\n  const _onSelect = (option) => {\n    console.log(\"Selected \" + option.label);\n    setNewUserId(option.value);\n    setNewUserName(option.label);\n  };\n\n  const userDropdownOptions = Object.keys(props.users).reduce((acc, userid) => {\n    acc.push({\n      value: userid,\n      label: props.users[userid],\n    });\n    return acc;\n  }, []);\n\n  return (\n    <div>\n      <ModalContent>\n        <p>The dropdown lists all members on JamNSync:</p>\n        <div\n          style={{\n            height: 250,\n            width: 300,\n          }}\n        >\n          <Dropdown\n            options={userDropdownOptions}\n            onChange={_onSelect}\n            placeholder=\"Select a name\"\n          />\n        </div>\n      </ModalContent>\n      <ModalFooter>\n        <ModalButton\n          onClick={() => {\n            // lose the dialog and return the value\n            dialog.close([newUserId, newUserName]);\n          }}\n        >\n          OK\n        </ModalButton>\n        <ModalButton\n          onClick={() => {\n            dialog.close([newUserId, newUserName]);\n          }}\n          type={\"light\"}\n        >\n          Cancel\n        </ModalButton>\n      </ModalFooter>\n    </div>\n  );\n}\n","import React, { Component } from \"react\";\nimport Member from \"./Member\";\nimport \"./Group.css\";\n\nimport { CustomDialog, Confirm } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\nimport AddMemberModalContent from \"./AddMemberModal\";\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\n\nconst RENAME_GROUP_OPTION = \"Rename Group\";\nconst DELETE_GROUP_OPTION = \"Delete Group\";\nconst options = [RENAME_GROUP_OPTION, DELETE_GROUP_OPTION];\n\nclass Group extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      group_membership: {},\n      threeDotsAnchorElement: null,\n    };\n    fetch(\"/api/group/members?group_id=\" + this.props.id, { method: \"GET\" })\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((res) => {\n        if (res.status !== 400) {\n          this.setState({ group_membership: res.body });\n        }\n      });\n    this.addMember = this.addMember.bind(this);\n    this.removeMember = this.removeMember.bind(this);\n    // this.getAllUsers = this.getAllUsers.bind(this);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.refresh !== prevProps.refresh) {\n      fetch(\"/api/group/members?group_id=\" + this.props.id, { method: \"GET\" })\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((res) => {\n          if (res.status !== 400) {\n            this.setState({ group_membership: res.body });\n          }\n        });\n    }\n  }\n\n  async addMember() {\n    console.log(\"adding member\");\n    // find all users\n    let all_users = await fetch(\"/api/users\", { method: \"GET\" })\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((res) => {\n        console.log(res);\n        return res.body;\n      });\n\n    console.log(all_users);\n    // perform get request to retrieve all available\n    const [newUserId, newUsername] = await CustomDialog(\n      <AddMemberModalContent users={all_users} />,\n      {\n        title: \"Add Member to \" + this.props.name,\n        showCloseIcon: true,\n      }\n    );\n    // perform post request to add user\n    // console.log(\"newUserId:\", newUserId, \"newUsername:\", newUsername);\n    if (newUserId && newUsername) {\n      const formData = new FormData();\n      formData.append(\"group_id\", this.props.id);\n      formData.append(\"user_id\", newUserId);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n      fetch(\"/api/group/members\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedMembership = Object.assign(\n              {},\n              this.state.group_membership\n            );\n            updatedMembership[newUserId] = newUsername;\n            this.setState({\n              group_membership: updatedMembership,\n            });\n          }\n        });\n    }\n  }\n\n  async removeMember(userid) {\n    console.log(\"removing member id:\", userid);\n    const username = this.state.group_membership[userid];\n    const result = await Confirm(\n      `Are you sure you want to remove \"${username}\" from \"${this.props.name}\"?`,\n      \"Remove Member\"\n    );\n    if (result) {\n      const formData = new FormData();\n      formData.append(\"group_id\", this.props.id);\n      formData.append(\"user_id\", userid);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/group/members\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedMembership = Object.assign(\n              {},\n              this.state.group_membership\n            );\n            delete updatedMembership[userid];\n            this.setState({\n              group_membership: updatedMembership,\n            });\n          }\n        });\n    }\n  }\n\n  clickThreeDotsMenu = (e) => {\n    this.setState({ threeDotsAnchorElement: e.currentTarget });\n  };\n\n  closeThreeDotsMenu = (e) => {\n    const option = e.target.innerText;\n    if (option === RENAME_GROUP_OPTION) {\n      this.props.renameGroup(this.props.id, this.props.name);\n    } else if (option === DELETE_GROUP_OPTION) {\n      this.props.deleteGroup(this.props.id, this.props.name);\n    }\n    this.setState({ threeDotsAnchorElement: null });\n  };\n\n  render() {\n    return (\n      <div style={{ marginBottom: \"-10px\" }}>\n        <p style={{ marginTop: \"20px\", marginBottom: \"-20px\" }}>\n          Group: {this.props.name}\n          {\"  \"}\n          <button onClick={this.addMember}>+ Member</button>\n          <IconButton\n            aria-label=\"more\"\n            aria-controls=\"group-menu\"\n            aria-haspopup=\"true\"\n            onClick={this.clickThreeDotsMenu}\n            style={{ marginLeft: \"5px\" }}\n          >\n            <MoreHorizIcon />\n          </IconButton>\n          <Menu\n            id=\"group-menu\"\n            anchorEl={this.state.threeDotsAnchorElement}\n            keepMounted\n            open={this.state.threeDotsAnchorElement !== null}\n            onClose={this.closeThreeDotsMenu}\n            PaperProps={{\n              style: {\n                maxHeight: 40 * 4.5,\n                width: \"20ch\",\n              },\n            }}\n          >\n            {options.map((option) => (\n              <MenuItem key={option} onClick={this.closeThreeDotsMenu}>\n                {option}\n              </MenuItem>\n            ))}\n          </Menu>\n        </p>\n        <ul>\n          {Object.keys(this.state.group_membership).map((userid) => {\n            const username = this.state.group_membership[userid];\n            return (\n              <div key={`member_${userid}`}>\n                <div>\n                  <Member\n                    id={userid}\n                    name={username}\n                    removeMember={this.removeMember}\n                    onlyMemberInGroup={\n                      Object.keys(this.state.group_membership).length === 1\n                    }\n                  />\n                </div>\n              </div>\n            );\n          })}\n        </ul>\n      </div>\n    );\n  }\n}\n\nexport default Group;\n","import React, { Component } from \"react\";\nimport \"./Groups.css\";\nimport Group from \"./Group\";\nimport { Confirm, Prompt } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\n\nimport SyncRoundedIcon from \"@material-ui/icons/SyncRounded\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\n\nclass Groups extends Component {\n  constructor() {\n    super();\n    this.state = {\n      groups: [],\n      isLoaded: false,\n      refresh: 0,\n    };\n    this.fetchGroups();\n    this.createNewGroup = this.createNewGroup.bind(this);\n    this.deleteGroup = this.deleteGroup.bind(this);\n    this.renameGroup = this.renameGroup.bind(this);\n  }\n\n  fetchGroups = () => {\n    fetch(\"/api/groups\", {\n      method: \"GET\",\n    })\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((res) => {\n        if (res.status !== 400) {\n          this.setState({ groups: res.body, isLoaded: true });\n        }\n      });\n  };\n\n  async createNewGroup() {\n    console.log(\"creating new group!\");\n    const group_name = await Prompt(\"Name Your Group\");\n    if (group_name) {\n      const formData = new FormData();\n      formData.append(\"group_name\", group_name);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status !== 400) {\n            this.setState({\n              groups: this.state.groups.concat([\n                { group_name: group_name, id: obj.body.group_id, projects: [] },\n              ]),\n            });\n          }\n        })\n        .catch((error) => {\n          alert(\n            'Server Error: Group name taken, use a different name instead of \"' +\n              group_name +\n              '\"!'\n          );\n        });\n    }\n  }\n\n  async deleteGroup(id, name) {\n    console.log(\"deleting group\");\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Group\"\n    );\n    if (result) {\n      const formData = new FormData();\n      formData.append(\"group_id\", id);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedGroups = [...this.state.groups].filter(\n              (i) => i.id !== id\n            );\n            this.setState({\n              groups: updatedGroups,\n            });\n          }\n        });\n    }\n  }\n\n  async renameGroup(id, name) {\n    console.log(\"renaming group\");\n    const new_name = await Prompt(\"Rename Your Group\", {\n      defaultValue: name,\n    });\n    if (new_name) {\n      const formData = new FormData();\n      formData.append(\"new_name\", new_name);\n      formData.append(\"group_id\", id);\n      const requestOptions = {\n        method: \"PUT\",\n        body: formData,\n      };\n\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedGroups = [...this.state.groups].map((groupInfo) =>\n              groupInfo.id === id\n                ? { ...groupInfo, group_name: new_name }\n                : groupInfo\n            );\n            this.setState({\n              groups: updatedGroups,\n            });\n          }\n        });\n    }\n  }\n\n  refresh = () => {\n    console.log(\"refreshing groups\");\n    fetch(\"/api/groups\", {\n      method: \"GET\",\n    })\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((res) => {\n        if (res.status !== 400) {\n          this.setState({\n            groups: res.body,\n            isLoaded: true,\n            refresh: this.state.refresh + 1,\n          });\n        } else {\n          this.setState({ refresh: this.state.refresh + 1 });\n        }\n      });\n  };\n\n  render() {\n    if (!this.state.isLoaded) {\n      return <div>Loading...</div>;\n    }\n    return (\n      <div>\n        <h2 style={{ marginBottom: \"-30px\" }}>\n          REHEARSAL GROUPS\n          <Tooltip title=\"Refresh latest groups\" arrow placement=\"right\">\n            <IconButton\n              style={{ marginTop: \"-3px\" }}\n              disableRipple\n              aria-label=\"Sync\"\n              onClick={this.refresh}\n            >\n              <SyncRoundedIcon style={{ fontSize: 25 }} />\n            </IconButton>\n          </Tooltip>\n        </h2>\n        {this.state.groups &&\n          this.state.groups.map((groupInfo, i) => (\n            <div key={`group_${i}`}>\n              <Group\n                id={groupInfo.id}\n                name={groupInfo.group_name}\n                projects={groupInfo.projects}\n                renameGroup={this.renameGroup}\n                deleteGroup={this.deleteGroup}\n                refresh={this.state.refresh}\n              />\n            </div>\n          ))}\n        <button\n          style={{ marginTop: \"30px\" }}\n          className=\"stitched\"\n          onClick={this.createNewGroup}\n        >\n          + New Rehearsal Group\n        </button>\n      </div>\n    );\n  }\n}\n\nexport default Groups;\n","import React, { useState } from \"react\";\nimport { Jutsu } from \"react-jutsu\";\n\n// https://github.com/this-fifo/jutsu\nexport const EmbeddedJitsi = () => {\n  const [displayName, setDisplayName] = useState(\"\");\n  const [roomName, setRoomName] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [onCall, setOnCall] = useState(false);\n\n  const handleClick = (event) => {\n    event.preventDefault();\n    if (roomName && displayName) setOnCall(true);\n  };\n\n  return (\n    <div>\n      <h2>Jitsi</h2>\n      <br />\n      {onCall ? (\n        <Jutsu\n          containerStyles={{ width: \"800px\", height: \"400px\" }}\n          roomName={roomName}\n          displayName={displayName}\n          password={password}\n          onMeetingEnd={() => console.log(\"Meeting has ended\")}\n          loadingComponent={<p>Loading ...</p>}\n          errorComponent={<p>Oops, something went wrong</p>}\n        />\n      ) : (\n        <form>\n          <p>Create a Room</p>\n          <input\n            id=\"room\"\n            type=\"text\"\n            placeholder=\"Room Name\"\n            value={roomName}\n            onChange={(e) => setRoomName(e.target.value)}\n          />\n          <input\n            id=\"name\"\n            type=\"text\"\n            placeholder=\"Name\"\n            value={displayName}\n            onChange={(e) => setDisplayName(e.target.value)}\n          />\n          <input\n            id=\"password\"\n            type=\"text\"\n            placeholder=\"Password (optional)\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n          />\n          <button onClick={handleClick} type=\"submit\">\n            Start / Join\n          </button>\n        </form>\n      )}\n    </div>\n  );\n};\n","import { Mp3Encoder } from \"lamejs\";\n\nclass Encoder {\n  constructor(config) {\n    this.config = {\n      sampleRate: 44100,\n      bitRate: 128,\n    };\n\n    Object.assign(this.config, config);\n\n    this.mp3Encoder = new Mp3Encoder(\n      1,\n      this.config.sampleRate,\n      this.config.bitRate\n    );\n\n    // Audio is processed by frames of 1152 samples per audio channel\n    // http://lame.sourceforge.net/tech-FAQ.txt\n    this.maxSamples = 1152;\n\n    this.samplesMono = null;\n    this.clearBuffer();\n  }\n\n  /**\n   * Clear active buffer\n   */\n  clearBuffer() {\n    this.dataBuffer = [];\n  }\n\n  /**\n   * Append new audio buffer to current active buffer\n   * @param {Buffer} buffer\n   */\n  appendToBuffer(buffer) {\n    this.dataBuffer.push(new Int8Array(buffer));\n  }\n\n  /**\n   * Float current data to 16 bits PCM\n   * @param {Float32Array} input\n   * @param {Int16Array} output\n   */\n  floatTo16BitPCM(input, output) {\n    for (let i = 0; i < input.length; i++) {\n      const s = Math.max(-1, Math.min(1, input[i]));\n      output[i] = s < 0 ? s * 0x8000 : s * 0x7fff;\n    }\n  }\n\n  /**\n   * Convert buffer to proper format\n   * @param {Array} arrayBuffer\n   */\n  convertBuffer(arrayBuffer) {\n    const data = new Float32Array(arrayBuffer);\n    const out = new Int16Array(arrayBuffer.length);\n    this.floatTo16BitPCM(data, out);\n\n    return out;\n  }\n\n  /**\n   * Encode and append current buffer to dataBuffer\n   * @param {Array} arrayBuffer\n   */\n  encode(arrayBuffer) {\n    this.samplesMono = this.convertBuffer(arrayBuffer);\n    let remaining = this.samplesMono.length;\n\n    for (let i = 0; remaining >= 0; i += this.maxSamples) {\n      const left = this.samplesMono.subarray(i, i + this.maxSamples);\n      const mp3buffer = this.mp3Encoder.encodeBuffer(left);\n      this.appendToBuffer(mp3buffer);\n      remaining -= this.maxSamples;\n    }\n  }\n\n  /**\n   * Return full dataBuffer\n   */\n  finish() {\n    this.appendToBuffer(this.mp3Encoder.flush());\n\n    return this.dataBuffer;\n  }\n}\n\nexport default Encoder;\n","import React, { Component } from \"react\";\nimport MicRecorder from \"./MicRecorder\";\n\nconst audioType = \"audio/mp3\";\nconst Mp3Recorder = new MicRecorder({ bitRate: 128 });\n\nclass WebAudio extends Component {\n  constructor() {\n    super();\n    this.state = {\n      recording: false,\n      recordings: [],\n    };\n    // this.clearBuffer();\n  }\n\n  // componentDidMount() {\n  //   navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {\n  //     this.mediaRecorder = new MediaRecorder(stream);\n  //     this.chunks = [];\n  //     this.mediaRecorder.ondataavailable = (e) => {\n  //       if (e.data && e.data.size > 0) {\n  //         this.chunks.push(e.data);\n  //       }\n  //     };\n  //   });\n  // }\n\n  // /**\n  //  * Clear active buffer\n  //  */\n  // clearBuffer = () => {\n  //   this.chunks = [];\n  // };\n\n  handleRecord = () => {\n    console.log(\"recording now\");\n    // wipe old data chunks\n    // this.chunks = [];\n    // start recorder with 10ms buffer\n    // this.mediaRecorder.start(10);\n    Mp3Recorder.start();\n    this.setState({ recording: true });\n  };\n\n  handleStopRecord = () => {\n    console.log(\"stopped now\");\n    // stop the recorder\n    // this.mediaRecorder.stop();\n    Mp3Recorder.stop()\n      .getMp3()\n      .then(([buffer, blob]) => {\n        // const file = new File(\n        //   [blob],\n        //   `recording_track_${this.state.selectedTrackId}.mp3`\n        // );\n        // const latency = 220; // in ms\n        // this.createTake(this.state.selectedTrackId, file, latency);\n        const blobURL = URL.createObjectURL(blob);\n        console.log(blobURL);\n        // append videoURL to list of saved videos for rendering\n        const recordings = this.state.recordings.concat([blobURL]);\n        // this.setState({ recordings });\n        this.setState({ recording: false, recordings });\n      })\n      .catch((e) => console.log(e));\n    // save audio to memory\n    // this.saveAudio();\n  };\n\n  convertBuffer = () => {\n    // const data = new Float32Array(this.chunks);\n    // const out = new Int16Array(this.chunks.length);\n    // // float to 16 bits PCM\n    // for (let i = 0; i < data.length; i++) {\n    //   const s = Math.max(-1, Math.min(1, data[i]));\n    //   out[i] = s < 0 ? s * 0x8000 : s * 0x7fff;\n    // }\n    // return out;\n  };\n\n  saveAudio() {\n    // this.samplesMono = this.convertBuffer();\n    // console.log(this.chunks.length);\n    // console.log(this.samplesMono.length);\n    // // encode to mp3\n    // let mp3Data = [];\n    // for (var i = 0; i < this.chunks.length; i += sampleBlockSize) {\n    //   let sampleChunk = this.chunks.subarray(i, i + sampleBlockSize);\n    //   let mp3buf = this.mp3encoder.encodeBuffer(sampleChunk);\n    //   if (mp3buf.length > 0) {\n    //     mp3Data.push(mp3buf);\n    //   }\n    // }\n    // let mp3buf = this.mp3encoder.flush();\n\n    // if (mp3buf.length > 0) {\n    //   mp3Data.push(new Int8Array(mp3buf));\n    // }\n\n    // convert saved chunks to blob\n    const blob = new Blob(this.chunks, { type: audioType });\n    console.log(blob);\n    // generate video url from blob\n    const blobURL = URL.createObjectURL(blob);\n    console.log(blobURL);\n    // append videoURL to list of saved videos for rendering\n    const recordings = this.state.recordings.concat([blobURL]);\n    this.setState({ recordings });\n  }\n\n  deleteRecording(blobURL) {\n    // filter out current videoURL from the list of saved videos\n    const recordings = this.state.recordings.filter((a) => a !== blobURL);\n    this.setState({ recordings });\n  }\n\n  render() {\n    return (\n      <div>\n        <div>\n          <p>test mic with web audio</p>\n          <button disabled={this.state.recording} onClick={this.handleRecord}>\n            record\n          </button>\n          <button\n            disabled={!this.state.recording}\n            onClick={this.handleStopRecord}\n          >\n            stop\n          </button>\n        </div>\n        <div>\n          <p>Recordings:</p>\n          {this.state.recordings.map((blobURL, i) => (\n            <div key={`recording_${i}`}>\n              <audio controls style={{ width: 300 }} src={blobURL} />\n              <div>\n                <button onClick={() => this.deleteRecording(blobURL)}>\n                  Delete\n                </button>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default WebAudio;\n","import Encoder from \"./Encoder\";\n\nclass MicRecorder {\n  constructor(config) {\n    this.mediaRecorder = null;\n    this.mediaChunks = [];\n    this.mediaStream = null;\n    // this.config = {\n    //   // 128 or 160 kbit/s  mid-range bitrate quality\n    //   bitRate: 160,\n    //   startRecordingAt: 0,\n    //   deviceId: null,\n    // };\n    // this.activeStream = null;\n    // this.context = null;\n    // this.microphone = null;\n    // this.processor = null;\n    // this.startTime = 0;\n    // Object.assign(this.config, config);\n  }\n\n  componentDidMount() {}\n\n  getMediaStream = () => {};\n\n  /**\n   * Starts to listen for the microphone sound\n   * @param {MediaStream} stream\n   */\n  addMicrophoneListener(stream) {\n    this.activeStream = stream;\n\n    // This prevents the weird noise once you start listening to the microphone\n    // this.timerToStart = setTimeout(() => {\n    //   delete this.timerToStart;\n    // }, this.config.startRecordingAt);\n\n    // Set up Web Audio API to process data from the media stream (microphone).\n    this.microphone = this.context.createMediaStreamSource(stream);\n\n    // Settings a bufferSize of 0 instructs the browser to choose the best bufferSize\n    this.processor = this.context.createScriptProcessor(0, 1, 1);\n\n    // Add all buffers from LAME into an array.\n    this.processor.onaudioprocess = (event) => {\n      // if (this.timerToStart) {\n      //   return;\n      // }\n\n      // Send microphone data to LAME for MP3 encoding while recording.\n      this.lameEncoder.encode(event.inputBuffer.getChannelData(0));\n    };\n\n    // Begin retrieving microphone data.\n    this.microphone.connect(this.processor);\n    this.processor.connect(this.context.destination);\n  }\n\n  /**\n   * Disconnect microphone, processor and remove activeStream\n   */\n  stop() {\n    if (this.processor && this.microphone) {\n      // Clean up the Web Audio API resources.\n      this.microphone.disconnect();\n      this.processor.disconnect();\n\n      // If all references using this.context are destroyed, context is closed\n      // automatically. DOMException is fired when trying to close again\n      if (this.context && this.context.state !== \"closed\") {\n        this.context.close();\n      }\n\n      this.processor.onaudioprocess = null;\n\n      // Stop all audio tracks. Also, removes recording icon from chrome tab\n      this.activeStream.getAudioTracks().forEach((track) => track.stop());\n    }\n\n    return this;\n  }\n\n  /**\n   * Requests access to the microphone and start recording\n   * @return Promise\n   */\n  start() {\n    this.context = new AudioContext();\n    this.config.sampleRate = this.context.sampleRate;\n    this.lameEncoder = new Encoder(this.config);\n\n    const audio = this.config.deviceId\n      ? { deviceId: { exact: this.config.deviceId } }\n      : true;\n\n    // return new Promise((resolve, reject) => {\n    navigator.mediaDevices.getUserMedia({ audio }).then((stream) => {\n      this.addMicrophoneListener(stream);\n      // resolve(stream);\n    });\n    // .catch(function (err) {\n    //   reject(err);\n    // });\n    // });\n  }\n\n  /**\n   * Return Mp3 Buffer and Blob with type mp3\n   * @return {Promise}\n   */\n  getMp3() {\n    const finalBuffer = this.lameEncoder.finish();\n\n    return new Promise((resolve, reject) => {\n      if (finalBuffer.length === 0) {\n        reject(new Error(\"No buffer to send\"));\n      } else {\n        resolve([finalBuffer, new Blob(finalBuffer, { type: \"audio/mp3\" })]);\n        this.lameEncoder.clearBuffer();\n      }\n    });\n  }\n}\n\nexport default MicRecorder;\n","import React from \"react\";\nimport { Route, Redirect } from \"react-router-dom\";\n\nfunction PrivateRoute({ component: Component, authed, ...rest }) {\n  return (\n    <Route\n      {...rest}\n      render={(props) =>\n        authed === true ? (\n          <Component {...props} />\n        ) : (\n          <Redirect to={{ pathname: \"/\", state: { from: props.location } }} />\n        )\n      }\n    />\n  );\n}\n\nexport default PrivateRoute;\n","import React, { Component } from \"react\";\nimport { HashRouter, NavLink, Route } from \"react-router-dom\";\nimport { Redirect } from \"react-router\";\nimport { createHashHistory } from \"history\";\n\n// import Footer from \"./components/Footer\";\nimport Login from \"./components/Login\";\nimport Logout from \"./components/Logout\";\nimport Project from \"./routes/project/Project\";\nimport ProjectSearch from \"./routes/project/ProjectSearch\";\nimport Home from \"./routes/home/Home\";\nimport Projects from \"./routes/projects/Projects\";\nimport Groups from \"./routes/groups/Groups\";\nimport { EmbeddedJitsi } from \"./routes/temp-jitsi/EmbeddedJitsi\"; // temp\nimport WebAudio from \"./routes/temp-webaudio/WebAudio\"; // temp\n\nimport PrivateRoute from \"./utils/components/PrivateRoute\";\n\nconst history = createHashHistory();\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.state = {\n      userDetails: {},\n      isUserLoggedIn: false,\n    };\n  }\n\n  componentDidMount() {\n    if (history.location.pathname === \"/\") {\n      history.replace(\"/home\");\n    }\n\n    let userDetails = JSON.parse(localStorage.getItem(\"userDetails\"));\n    let isUserLoggedIn = localStorage.getItem(\"isUserLoggedIn\") === \"true\";\n    if (isUserLoggedIn && !this.state.isUserLoggedIn) {\n      this.setState({\n        userDetails: userDetails,\n        isUserLoggedIn: isUserLoggedIn,\n      });\n    }\n  }\n\n  componentDidUpdate(prevState) {\n    if (\n      !this.state.isUserLoggedIn &&\n      prevState.isUserLoggedIn &&\n      history.location.pathname === \"/\"\n    ) {\n      history.replace(\"/home\");\n    }\n  }\n\n  handleSuccessfulLogin = (response) => {\n    const userDetails = response.profileObj;\n    const formData = new FormData();\n    formData.append(\"google_auth_id\", userDetails.googleId);\n    formData.append(\"google_email\", userDetails.email);\n    formData.append(\"user_name\", userDetails.name);\n    const requestOptions = {\n      method: \"POST\",\n      body: formData,\n    };\n\n    fetch(\"/auth/login\", requestOptions)\n      .then((resp) => resp.json())\n      .then((res) => {\n        console.log(res.message);\n        localStorage.setItem(\"userDetails\", JSON.stringify(userDetails));\n        localStorage.setItem(\"isUserLoggedIn\", true);\n        this.setState({ userDetails: userDetails, isUserLoggedIn: true });\n      });\n  };\n\n  handleSuccessfulLogout = () => {\n    fetch(\"/auth/logout\", { method: \"POST\" })\n      .then((resp) => resp.json())\n      .then((res) => {\n        console.log(res.message);\n        localStorage.clear();\n        this.setState({ userDetails: {}, isUserLoggedIn: false });\n      });\n  };\n\n  render() {\n    // default to groups page if no history, otherwise go to last page before refresh\n    let pathname = history.location.pathname;\n    return (\n      <HashRouter history={history}>\n        <div>\n          <h1>JamNSync</h1>\n          <div style={{ position: \"absolute\", right: 20, top: 35 }}>\n            {!this.state.isUserLoggedIn && (\n              <Login onSuccessfulLogin={this.handleSuccessfulLogin} />\n            )}\n            {this.state.isUserLoggedIn && (\n              <div style={{ display: \"flex\" }}>\n                <div>\n                  <p>Welcome, {this.state.userDetails.givenName}!</p>\n                </div>\n                <div style={{ marginLeft: \"5px\" }}>\n                  <Logout onSuccessfulLogout={this.handleSuccessfulLogout} />\n                </div>\n              </div>\n            )}\n          </div>\n\n          <ul className=\"header\">\n            <li>\n              <NavLink to=\"/home\">Home</NavLink>\n            </li>\n            {this.state.isUserLoggedIn && (\n              <li>\n                <NavLink to=\"/groups\">Groups</NavLink>\n              </li>\n            )}\n            {this.state.isUserLoggedIn && (\n              <li>\n                <NavLink to=\"/projects\">Projects</NavLink>\n              </li>\n            )}\n          </ul>\n\n          <div className=\"content\">\n            <Route exact path=\"/\">\n              {this.state.isUserLoggedIn && pathname !== \"/\" ? (\n                <Redirect to={pathname} />\n              ) : (\n                <Home authed={this.state.isUserLoggedIn} />\n              )}\n            </Route>\n            <Route path=\"/home\">\n              <Home authed={this.state.isUserLoggedIn} />\n            </Route>\n            <PrivateRoute\n              path=\"/projects\"\n              component={Projects}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              path=\"/groups\"\n              component={Groups}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              exact\n              path={\"/project\"}\n              component={ProjectSearch}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              path=\"/project/\"\n              component={Project}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              path=\"/jitsi\"\n              component={EmbeddedJitsi}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              path=\"/webaudio\"\n              component={WebAudio}\n              authed={this.state.isUserLoggedIn}\n            />\n          </div>\n\n          {/* <Footer /> */}\n        </div>\n      </HashRouter>\n    );\n  }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(\n  <App />,\n  document.getElementById(\"root\")\n);"],"sourceRoot":""}