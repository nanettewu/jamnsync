{"version":3,"sources":["components/Login.js","utils/refreshToken.js","components/Logout.js","routes/project/daw/Track.js","routes/project/daw/DAW.js","routes/project/Project.js","routes/project/ProjectSearch.js","routes/home/Home.js","routes/groups/Project.js","routes/groups/Group.js","routes/groups/Groups.js","routes/temp-jitsi/EmbeddedJitsi.js","routes/temp-webaudio/Encoder.js","routes/temp-webaudio/WebAudio.js","routes/temp-webaudio/MicRecorder.js","utils/components/PrivateRoute.js","App.js","index.js"],"names":["Login","props","clientId","process","buttonText","onSuccess","res","refreshTiming","tokenObj","expires_in","refreshToken","a","reloadAuthResponse","newAuthRes","console","log","localStorage","setItem","id_token","setTimeout","refreshTokenSetup","onSuccessfulLogin","onFailure","cookiePolicy","style","marginTop","isSignedIn","Logout","onLogoutSuccess","onSuccessfulLogout","FILE_UPLOAD_OPTION","RENAME_TRACK_OPTION","DELETE_TRACK_OPTION","options","Track","playPauseAudio","state","playing","audioFile","pause","setState","play","stop","changeVolume","value","volume","masterVolume","seek","fastForward","duration","currentSeek","forwardTo","rewind","backwardTo","mute","muted","solo","updateSoloTracks","trackId","soloing","selectToRecord","updatedTrackId","selected","setSelectedTrack","_onSelect","option","label","url","takes","s3_info","selectedTake","Howl","src","format","preload","s3URL","clickThreeDotsMenu","e","threeDotsAnchorElement","currentTarget","closeThreeDotsMenu","target","innerText","document","getElementById","click","renameTrack","trackName","deleteTrack","latestTake","Object","keys","length","latestKey","pop","deleteTake","bind","this","prevProps","selectedTrackId","masterPlay","masterRecord","masterStop","soloTracks","targetTake","takeInfo","d","Date","substr","lastIndexOf","formattedDateTime","toLocaleString","name","Confirm","id","newSelectedTake","takeCopy","splice","indexOf","Math","max","apply","newURL","selectedKeyValue","takeDropdownOptions","reduce","acc","take","parseInt","rawDate","push","reverse","marginLeft","display","alt","width","height","title","onClick","IconButton","aria-label","aria-controls","aria-haspopup","type","hidden","onChange","handleFileUpload","files","Menu","anchorEl","keepMounted","open","onClose","PaperProps","maxHeight","map","MenuItem","marginBottom","Tooltip","arrow","disableRipple","color","marginRight","min","defaultValue","placeholder","method","action","Component","recorder","vmsg","Recorder","wasmURL","DAW","createTrack","createTake","track_id","file","latency","take_number","take_id","toggleMasterPlay","startTime","now","runningTime","timer","setInterval","targetId","test","alert","newId","formattedTime","ms","minutes","floor","seconds","toFixed","newSoloTracks","index","isRecording","isBlocked","showCountdown","toggleMasterRecord","toggleMasterStop","navigator","mediaDevices","getUserMedia","audio","clearInterval","stopRecording","blob","File","recordedURL","URL","createObjectURL","trackMetadata","initAudio","initWorker","startRecording","trackInfo","track_name","className","disabled","fontSize","position","isPlaying","colors","onComplete","remainingTime","Project","retrieveProject","project_hash","fetch","URLSearchParams","then","resp","json","data","status","body","obj","tracks","item","formatted_takes","date_uploaded","project_name","group_name","group","project_id","track_metadata","location","pathname","split","Prompt","isRequired","formData","FormData","append","updatedTracks","assign","projectId","new_name","timestamp","toString","pathSuffix","ProjectSearch","useState","setProjectId","redirect","setRedirect","to","startsWith","catch","err","Home","RENAME_PROJECT_OPTION","DELETE_PROJECT_OPTION","history","useHistory","setThreeDotsAnchorElement","renameProject","project","deleteProject","group_id","RENAME_GROUP_OPTION","DELETE_GROUP_OPTION","Group","renameGroup","deleteGroup","projects","createNewProject","concat","updatedProjects","filter","i","projectInfo","Groups","groups","createNewGroup","updatedGroups","groupInfo","EmbeddedJitsi","displayName","setDisplayName","roomName","setRoomName","password","setPassword","onCall","setOnCall","containerStyles","onMeetingEnd","loadingComponent","errorComponent","event","preventDefault","Encoder","config","sampleRate","bitRate","mp3Encoder","Mp3Encoder","maxSamples","samplesMono","clearBuffer","dataBuffer","buffer","Int8Array","input","output","s","arrayBuffer","Float32Array","out","Int16Array","floatTo16BitPCM","convertBuffer","remaining","left","subarray","mp3buffer","encodeBuffer","appendToBuffer","flush","Mp3Recorder","getMediaStream","mediaRecorder","mediaChunks","mediaStream","stream","activeStream","microphone","context","createMediaStreamSource","processor","createScriptProcessor","onaudioprocess","lameEncoder","encode","inputBuffer","getChannelData","connect","destination","disconnect","close","getAudioTracks","forEach","track","AudioContext","deviceId","exact","addMicrophoneListener","finalBuffer","finish","Promise","resolve","reject","Error","Blob","WebAudio","handleRecord","start","recording","handleStopRecord","getMp3","blobURL","recordings","chunks","controls","deleteRecording","PrivateRoute","component","authed","rest","render","from","createHashHistory","App","handleSuccessfulLogin","response","userDetails","profileObj","googleId","email","JSON","stringify","isUserLoggedIn","handleSuccessfulLogout","clear","parse","getItem","right","top","givenName","path","ReactDOM"],"mappings":"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","file":"static/js/main.1a2ac97b.chunk.js","sourcesContent":["// source: https://github.com/Sivanesh-S/react-google-authentication/blob/master/src/components/Login.js\n\nimport React from \"react\";\n\nimport { GoogleLogin } from \"react-google-login\";\nimport { refreshTokenSetup } from \"../utils/refreshToken\";\n\nfunction Login(props) {\n  const onSuccess = (res) => {\n    // console.log(\"Login Success: currentUser:\", res.profileObj);\n    refreshTokenSetup(res);\n    props.onSuccessfulLogin(res);\n  };\n\n  const onFailure = (res) => {\n    console.log(\"Attempt to login failed: res:\", res);\n    // alert(`Failed to login 😢`);\n  };\n\n  return (\n    <div>\n      <GoogleLogin\n        clientId={process.env.REACT_APP_GOOGLE_CLIENT_ID}\n        buttonText=\"Login\"\n        onSuccess={onSuccess}\n        onFailure={onFailure}\n        cookiePolicy={\"single_host_origin\"}\n        style={{ marginTop: \"100px\" }}\n        isSignedIn={true}\n      />\n    </div>\n  );\n}\n\nexport default Login;\n","// source: https://github.com/Sivanesh-S/react-google-authentication/blob/master/src/utils/refreshToken.js\n\nexport const refreshTokenSetup = (res) => {\n  // Timing to renew access token\n  let refreshTiming = (res.tokenObj.expires_in || 3600 - 5 * 60) * 1000;\n\n  const refreshToken = async () => {\n    const newAuthRes = await res.reloadAuthResponse();\n    refreshTiming = (newAuthRes.expires_in || 3600 - 5 * 60) * 1000;\n    console.log(\"newAuthRes:\", newAuthRes);\n    // saveUserToken(newAuthRes.access_token);  <-- save new token\n    localStorage.setItem(\"authToken\", newAuthRes.id_token);\n\n    // Setup the other timer after the first one\n    setTimeout(refreshToken, refreshTiming);\n  };\n\n  // Setup first refresh timer\n  setTimeout(refreshToken, refreshTiming);\n};\n","import React from \"react\";\nimport { GoogleLogout } from \"react-google-login\";\n\nfunction Logout(props) {\n  const onSuccess = () => {\n    // console.log('Logged out successfully');\n    // alert(\"Logged out successfully ✌\");\n    props.onSuccessfulLogout();\n  };\n\n  return (\n    <div>\n      <GoogleLogout\n        clientId={process.env.REACT_APP_GOOGLE_CLIENT_ID}\n        buttonText=\"Logout\"\n        onLogoutSuccess={onSuccess}\n      ></GoogleLogout>\n    </div>\n  );\n}\n\nexport default Logout;\n","import { Howl } from \"howler\";\nimport Slider from \"rc-slider\";\nimport \"rc-slider/assets/index.css\";\nimport React, { Component } from \"react\";\nimport \"./Track.css\";\nimport Dropdown from \"react-dropdown\";\nimport \"react-dropdown/style.css\";\nimport { Confirm } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\nimport HeadsetRoundedIcon from \"@material-ui/icons/HeadsetRounded\";\nimport VolumeOffRoundedIcon from \"@material-ui/icons/VolumeOffRounded\";\n\nconst FILE_UPLOAD_OPTION = \"+ Upload File\";\nconst RENAME_TRACK_OPTION = \"Rename Track\";\nconst DELETE_TRACK_OPTION = \"Delete Track\";\n\nconst options = [FILE_UPLOAD_OPTION, RENAME_TRACK_OPTION, DELETE_TRACK_OPTION];\n\nclass Track extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selected: false,\n      playing: false,\n      muted: false,\n      audioFile: null,\n      s3URL: null,\n      selectedTake: null,\n      latestTake: 0,\n      soloing: false,\n      volume: 84.95,\n      threeDotsAnchorElement: null,\n    };\n    if (Object.keys(props.takes).length !== 0) {\n      const latestKey = Object.keys(props.takes).pop();\n      const url = props.takes[latestKey].s3_info;\n      if (url) {\n        this.state.audioFile = new Howl({\n          src: [url],\n          volume: 0.5,\n          format: [\"mp3\", \"wav\"],\n          preload: true,\n        });\n        this.state.s3URL = url;\n        this.state.selectedTake = latestKey;\n      }\n    }\n    this.deleteTake = this.deleteTake.bind(this);\n  }\n\n  componentDidMount() {\n    // if this track has takes and the page refreshed, select most recent take\n    if (Object.keys(this.props.takes).length !== 0) {\n      const latestKey = Object.keys(this.props.takes).pop();\n      const url = this.props.takes[latestKey].s3_info;\n      if (url) {\n        this.setState({\n          audioFile: new Howl({\n            src: [url],\n            volume: 0.5,\n            format: [\"mp3\", \"wav\"],\n            preload: true,\n          }),\n          s3URL: url,\n          selectedTake: latestKey,\n          latestTake: latestKey,\n        });\n      }\n      // otherwise reset the take state\n    } else {\n      this.setState({\n        selectedTake: null,\n        audioFile: null,\n        s3URL: null,\n        latestTake: 0,\n      });\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    // unselect selected track if a different track is selected\n    if (\n      this.state.selected &&\n      this.props.selectedTrackId !== this.props.trackId\n    ) {\n      this.setState({ selected: false });\n    }\n\n    // if no take is currently selected and # of states updated\n    if (\n      (this.state.selectedTake === null ||\n        this.state.latestTake !== Object.keys(this.props.takes).pop()) &&\n      Object.keys(this.props.takes).length !== 0\n    ) {\n      const latestKey = Object.keys(this.props.takes).pop();\n      const url = this.props.takes[latestKey].s3_info;\n      if (url) {\n        console.log(\"updated take to take \" + latestKey);\n        this.setState({\n          latestTake: latestKey,\n          selectedTake: latestKey,\n          audioFile: new Howl({\n            src: [url],\n            volume: 0.5,\n            format: [\"mp3\", \"wav\"],\n            preload: true,\n          }),\n          s3URL: url,\n        });\n      }\n    } else if (\n      Object.keys(this.props.takes).length === 0 &&\n      this.state.audioFile\n    ) {\n      this.setState({\n        selectedTake: null,\n        audioFile: null,\n        s3URL: null,\n        latestTake: 0,\n      });\n    }\n\n    // play non-selected track during recording or stop if DAW master controls indicate\n    if (\n      this.props.masterPlay &&\n      this.state.audioFile &&\n      !this.state.playing &&\n      (!this.state.selected ||\n        (this.state.selected && !this.props.masterRecord))\n    ) {\n      console.log(`[${this.props.trackName}] playing 1: ${this.state.s3URL}`);\n      this.state.audioFile.seek(0);\n      this.state.audioFile.play();\n      this.setState({ playing: true });\n    } else if (\n      this.props.masterStop &&\n      this.state.audioFile &&\n      this.state.playing\n    ) {\n      this.state.audioFile.stop();\n      this.setState({ playing: false });\n    }\n\n    // update soloing\n    if (\n      !this.state.soloing &&\n      this.props.soloTracks.length !== 0 &&\n      !this.state.muted &&\n      this.state.audioFile\n    ) {\n      this.state.audioFile.mute(true);\n      this.setState({\n        muted: true,\n      });\n    } else if (\n      this.props.soloTracks.length === 0 &&\n      this.state.muted &&\n      prevProps.soloTracks.length !== 0\n    ) {\n      this.state.audioFile.mute(false);\n      this.setState({\n        muted: false,\n      });\n    }\n\n    if (\n      this.state.audioFile &&\n      prevProps.masterVolume !== this.props.masterVolume\n    ) {\n      this.state.audioFile.volume(\n        (this.props.masterVolume * this.state.volume) / 100\n      );\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.state.audioFile) {\n      this.state.audioFile.stop();\n    }\n  }\n\n  playPauseAudio = () => {\n    if (this.state.playing) {\n      this.state.audioFile.pause();\n      this.setState({ playing: false });\n    } else {\n      this.state.audioFile.play();\n      this.setState({ playing: true });\n    }\n  };\n\n  stop = () => {\n    this.state.audioFile.stop();\n    this.setState({ playing: false });\n  };\n\n  changeVolume = (value) => {\n    // convert linear 1->100 to log 1->100 via f(n) = 50 * log(n)\n    // const volume = Math.max(0, 40 * Math.log10(value));\n    // const volume =\n    //   Math.max(0, (1 - Math.log(value) / Math.log(0.5)) / 9.5) * 100;\n    const volume = value;\n    this.state.audioFile.volume((this.props.masterVolume * volume) / 100);\n    this.setState({ volume: volume });\n  };\n\n  seek = (value) => {\n    this.state.audioFile.pause();\n    this.state.audioFile.seek(value);\n    if (this.state.playing) {\n      this.state.audioFile.play();\n    }\n  };\n\n  fastForward = () => {\n    this.state.audioFile.pause();\n    const duration = this.state.audioFile.duration();\n    const currentSeek = this.state.audioFile.seek();\n    const forwardTo = currentSeek + 5;\n    if (forwardTo >= duration) {\n      this.state.audioFile.stop();\n      return;\n    }\n    console.log(\"ff: \" + currentSeek + \" -> \" + forwardTo);\n    this.state.audioFile.seek(forwardTo);\n    if (this.state.playing) {\n      this.state.audioFile.play();\n    }\n  };\n\n  rewind = () => {\n    this.state.audioFile.pause();\n    const currentSeek = this.state.audioFile.seek();\n    let backwardTo = currentSeek - 5;\n    if (backwardTo <= 0) {\n      backwardTo = 0;\n    }\n    console.log(\"rewind: \" + currentSeek + \" -> \" + backwardTo);\n    this.state.audioFile.seek(backwardTo);\n    if (this.state.playing) {\n      this.state.audioFile.play();\n    }\n  };\n\n  mute = () => {\n    this.state.audioFile.mute(!this.state.muted);\n    this.setState({\n      muted: !this.state.muted,\n    });\n  };\n\n  solo = () => {\n    this.props.updateSoloTracks(this.props.trackId);\n    if (!this.state.soloing) {\n      this.state.audioFile.mute(false);\n      this.setState({\n        soloing: true,\n        muted: false,\n      });\n    } else {\n      this.setState({\n        soloing: false,\n      });\n    }\n  };\n\n  selectToRecord = () => {\n    const updatedTrackId = !this.state.selected ? this.props.trackId : null;\n    this.props.setSelectedTrack(updatedTrackId);\n    this.setState({ selected: !this.state.selected });\n  };\n\n  _onSelect = (option) => {\n    console.log(\"Selected \" + option.label);\n    this.state.audioFile.stop();\n    const url = this.props.takes[option.value].s3_info;\n    this.setState({\n      playing: false,\n      selectedTake: option.value,\n      audioFile: new Howl({\n        src: [url],\n        volume: 0.5,\n        format: [\"mp3\", \"wav\"],\n        preload: true,\n      }),\n      s3URL: url,\n    });\n  };\n\n  async deleteTake() {\n    console.log(\"deleting take\");\n    const targetTake = this.state.selectedTake;\n    const takeInfo = this.props.takes[targetTake];\n    const d = new Date(\n      takeInfo[\"date_uploaded\"].substr(\n        0,\n        takeInfo[\"date_uploaded\"].lastIndexOf(\" \") + 1\n      )\n    );\n    const formattedDateTime = d.toLocaleString(\"en-US\");\n\n    const name = `Take ${targetTake} - ${formattedDateTime}`;\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Take\"\n    );\n    if (result) {\n      this.state.audioFile.stop();\n      await this.props.deleteTake(this.props.trackId, targetTake, takeInfo.id);\n\n      let newSelectedTake = null;\n      if (Object.keys(this.props.takes).length > 1) {\n        console.log(\"selecting existing take\");\n        const takeCopy = Object.keys(this.props.takes);\n        takeCopy.splice(takeCopy.indexOf(targetTake), 1);\n        newSelectedTake = Math.max.apply(Math, takeCopy);\n        const newURL = this.props.takes[newSelectedTake].s3_info;\n        this.setState({\n          playing: false,\n          selectedTake: newSelectedTake,\n          audioFile: new Howl({\n            src: [newURL],\n            volume: this.props.masterVolume * 0.5,\n            format: [\"mp3\", \"wav\"],\n            preload: true,\n          }),\n          s3URL: newURL,\n          latestTake: newSelectedTake,\n        });\n      } else {\n        console.log(\"unsetting audio file\");\n        this.setState({\n          playing: false,\n          selectedTake: newSelectedTake,\n          audioFile: null,\n          s3URL: null,\n          latestTake: 0,\n        });\n      }\n    }\n  }\n\n  clickThreeDotsMenu = (e) => {\n    this.setState({ threeDotsAnchorElement: e.currentTarget });\n  };\n\n  closeThreeDotsMenu = (e) => {\n    const option = e.target.innerText;\n    if (option === FILE_UPLOAD_OPTION) {\n      document.getElementById(\"file-upload\").click();\n    } else if (option === RENAME_TRACK_OPTION) {\n      this.props.renameTrack(this.props.trackId, this.props.trackName);\n    } else if (option === DELETE_TRACK_OPTION) {\n      this.props.deleteTrack(this.props.trackId, this.props.trackName);\n    }\n    this.setState({ threeDotsAnchorElement: null });\n  };\n\n  render() {\n    let selectedKeyValue = { value: this.state.selectedTake };\n    const takeDropdownOptions = Object.keys(this.props.takes)\n      .reduce((acc, take) => {\n        if (parseInt(take) <= parseInt(this.state.latestTake)) {\n          const rawDate = this.props.takes[take][\"date_uploaded\"];\n          const d = new Date(rawDate.substr(0, rawDate.lastIndexOf(\" \") + 1));\n          const formattedDateTime = d.toLocaleString(\"en-US\");\n          if (take === this.state.selectedTake) {\n            selectedKeyValue[\"label\"] = `Take ${take} - ${formattedDateTime}`;\n          }\n          acc.push({\n            value: take,\n            label: `Take ${take} - ${formattedDateTime}`,\n          });\n        }\n        return acc;\n      }, [])\n      .reverse();\n\n    return (\n      <div style={{ marginLeft: \"5px\" }}>\n        <hr />\n        <div>\n          {this.state.selected ? (\n            <div style={{ display: \"inline-block\" }}>\n              <img\n                src=\"images/daw/selected.png\"\n                alt=\"selected\"\n                width=\"10\"\n                height=\"10\"\n              />{\" \"}\n              <b>Track: {this.props.trackName}</b>{\" \"}\n            </div>\n          ) : (\n            <div style={{ display: \"inline-block\" }}>\n              Track: {this.props.trackName}{\" \"}\n            </div>\n          )}\n          <button\n            title=\"Select/unselect track for recording\"\n            onClick={this.selectToRecord}\n            style={{ marginLeft: \"5px\" }}\n          >\n            {this.state.selected ? \"Unselect\" : \"Select to Record\"}\n          </button>\n          <IconButton\n            aria-label=\"more\"\n            aria-controls=\"track-menu\"\n            aria-haspopup=\"true\"\n            onClick={this.clickThreeDotsMenu}\n            style={{ marginLeft: \"5px\" }}\n          >\n            <MoreHorizIcon />\n          </IconButton>\n          <input\n            type=\"file\"\n            id=\"file-upload\"\n            hidden\n            onChange={(e) =>\n              this.props.handleFileUpload(e.target.files, this.props.trackId)\n            }\n          />\n          <Menu\n            id=\"track-menu\"\n            anchorEl={this.state.threeDotsAnchorElement}\n            keepMounted\n            open={this.state.threeDotsAnchorElement !== null}\n            onClose={this.closeThreeDotsMenu}\n            PaperProps={{\n              style: {\n                maxHeight: 40 * 4.5,\n                width: \"20ch\",\n              },\n            }}\n          >\n            {options.map((option) => (\n              <MenuItem key={option} onClick={this.closeThreeDotsMenu}>\n                {option}\n              </MenuItem>\n            ))}\n          </Menu>\n        </div>\n        {this.state.audioFile && Object.keys(this.props.takes).length > 0 && (\n          <div style={{ marginBottom: \"20px\" }}>\n            <Tooltip title=\"Mute\" arrow>\n              <IconButton\n                disableRipple\n                aria-label=\"Mute this track\"\n                onClick={this.mute}\n              >\n                {this.state.muted ? (\n                  <VolumeOffRoundedIcon color=\"secondary\" />\n                ) : (\n                  <VolumeOffRoundedIcon />\n                )}\n              </IconButton>\n            </Tooltip>\n            <Tooltip title=\"Solo\" arrow>\n              <IconButton\n                disableRipple\n                aria-label=\"Solo this track\"\n                onClick={this.solo}\n              >\n                {this.state.soloing ? (\n                  <HeadsetRoundedIcon color=\"secondary\" />\n                ) : (\n                  <HeadsetRoundedIcon />\n                )}\n              </IconButton>\n            </Tooltip>\n            <div\n              style={{\n                display: \"inline-block\",\n                marginLeft: \"10px\",\n                marginRight: \"10px\",\n                width: \"100px\",\n              }}\n            >\n              Volume\n              <Slider\n                min={0}\n                max={100}\n                defaultValue={50}\n                onChange={this.changeVolume}\n              />\n            </div>\n            <div\n              style={{\n                marginLeft: \"10px\",\n                display: \"inline-flex\",\n                width: 310,\n              }}\n            >\n              <Dropdown\n                options={takeDropdownOptions}\n                onChange={this._onSelect}\n                value={selectedKeyValue}\n                placeholder=\"Select an option\"\n              />\n            </div>\n            <div style={{ display: \"inline-flex\" }}>\n              <form method=\"get\" action={this.state.s3URL}>\n                <button type=\"submit\">Download Take</button>\n              </form>\n              <button onClick={this.deleteTake}>Delete Take</button>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default Track;\n","import React, { Component } from \"react\";\nimport \"./DAW.css\";\nimport Track from \"./Track\";\nimport { CountdownCircleTimer } from \"react-countdown-circle-timer\";\n// import { CustomDialog } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\n// import AlignRecordingModalContent from \"./AlignRecording\";\nimport Slider from \"rc-slider\";\nimport \"rc-slider/assets/index.css\";\nimport vmsg from \"vmsg\"; // https://github.com/Kagami/vmsg\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport PlayArrowRoundedIcon from \"@material-ui/icons/PlayArrowRounded\";\nimport StopRoundedIcon from \"@material-ui/icons/StopRounded\";\nimport FiberManualRecordRoundedIcon from \"@material-ui/icons/FiberManualRecordRounded\";\n\nconst recorder = new vmsg.Recorder({\n  wasmURL: \"https://unpkg.com/vmsg@0.3.0/vmsg.wasm\", // ! TODO\n});\n\nclass DAW extends Component {\n  constructor() {\n    super();\n    this.state = {\n      masterPlay: false,\n      masterStop: false,\n      masterRecord: false,\n      isRecording: false,\n      selectedTrackId: null, // to record\n      isBlocked: false,\n      showCountdown: false,\n      runningTime: 0,\n      soloTracks: [],\n      masterVolume: 0.5,\n    };\n    this.toggleMasterRecord = this.toggleMasterRecord.bind(this);\n    this.toggleMasterStop = this.toggleMasterStop.bind(this);\n    // this.test = this.test.bind(this);\n  }\n\n  componentDidUpdate() {\n    if (this.state.masterPlay && this.state.masterStop) {\n      this.setState({\n        masterPlay: false,\n        masterStop: false,\n        runningTime: 0,\n      });\n    }\n  }\n\n  componentDidMount() {\n    console.log(\"reloading DAW\");\n    navigator.mediaDevices.getUserMedia(\n      { audio: true },\n      () => {\n        console.log(\"Permission Granted\");\n        this.setState({ isBlocked: false });\n      },\n      () => {\n        console.log(\"Permission Denied\");\n        this.setState({ isBlocked: true });\n      }\n    );\n    this.setState({\n      isRecording: false,\n      masterRecord: false,\n      selectedTrackId: null,\n      soloTracks: [],\n    });\n  }\n\n  // TRACK OPERATIONS\n\n  createTrack = () => {\n    this.props.createTrack();\n  };\n\n  renameTrack = (id, name) => {\n    this.props.renameTrack(id, name);\n  };\n\n  deleteTrack = (id, name) => {\n    const successfulDelete = this.props.deleteTrack(id, name);\n    if (successfulDelete) {\n      // if deleted a selected track, reset selected track\n      this.setState({ selectedTrackId: null });\n    }\n  };\n\n  // TAKE OPERATIONS\n\n  createTake = (track_id, file, latency = 0) => {\n    this.props.createTake(track_id, file, latency);\n  };\n\n  deleteTake = (track_id, take_number, take_id) => {\n    this.props.deleteTake(track_id, take_number, take_id);\n  };\n\n  // PLAYBACK OPERATIONS\n\n  toggleMasterPlay = () => {\n    console.log(\"master play\");\n    this.setState((state) => {\n      const startTime = Date.now() - this.state.runningTime;\n      this.timer = setInterval(() => {\n        this.setState({ runningTime: Date.now() - startTime });\n      });\n      return { masterPlay: true };\n    });\n  };\n\n  async toggleMasterStop() {\n    console.log(\"master stop\");\n    if (!this.state.masterPlay) {\n      return;\n    }\n    clearInterval(this.timer);\n    this.setState({ masterStop: true, runningTime: 0 });\n    // let recordedURL, file;\n    if (this.state.isRecording) {\n      const blob = await recorder.stopRecording();\n      // Mp3Recorder.stop()\n      //   .getMp3()\n      //   .then(([buffer, blob]) => {\n      let file = new File(\n        [blob],\n        `recording_track_${this.state.selectedTrackId}.mp3`\n      );\n      let recordedURL = URL.createObjectURL(file);\n      console.log(recordedURL);\n      //   return { file: file, recordedURL: recordedURL };\n      // })\n      // .then(async (obj) => {\n      let latency = -1; // in ms\n      if (Object.keys(this.props.trackMetadata).length > 1) {\n        // ! TODO\n        // latency = await CustomDialog(\n        //   <AlignRecordingModalContent\n        //     recordedURL={recordedURL}\n        //     recordedTrackId={this.state.selectedTrackId}\n        //     trackMetadata={this.props.trackMetadata}\n        //   />,\n        //   {\n        //     title: \"Check Recording\",\n        //     showCloseIcon: true,\n        //   }\n        // );\n        // console.log(\"latency:\", latency);\n      }\n      this.createTake(this.state.selectedTrackId, file, latency); // ! TODO\n      this.setState({ isRecording: false, masterRecord: false });\n      // })\n      // .catch((e) => console.log(e));\n    }\n  }\n\n  // async test() {\n  //   const latency = await CustomDialog(\n  //     <AlignRecordingModalContent recordedURL={\"test1\"} />,\n  //     {\n  //       title: \"Check Recording\",\n  //       showCloseIcon: true,\n  //     }\n  //   );\n  //   console.log(\"latency:\", latency);\n  // }\n\n  // https://codesandbox.io/s/v67oz43lm7?file=/src/index.js\n  async toggleMasterRecord() {\n    console.log(\"master record!\");\n    if (this.state.isBlocked) {\n      console.log(\"Permission Denied\");\n      alert(\"Permission Denied!\");\n    } else if (this.state.selectedTrackId === null) {\n      alert(\"Select a track to record!\");\n    } else {\n      console.log(\"recording\" + this.state.selectedTrackId);\n      // Mp3Recorder.start();\n      await recorder.initAudio();\n      await recorder.initWorker();\n      recorder.startRecording();\n\n      this.setState((state) => {\n        return {\n          masterRecord: true,\n          showCountdown: true,\n          isRecording: true,\n        };\n      });\n    }\n  }\n\n  handleFileUpload = (files, targetId) => {\n    console.log(\"handling file upload\");\n    if (\n      files === null ||\n      files[0] === null ||\n      typeof files[0] === \"undefined\"\n    ) {\n      return;\n    }\n    if (/\\.(mp3|ogg|wav|flac|aac|aiff|m4a)$/i.test(files[0].name)) {\n      console.log(\"> validated file: \", files[0].name);\n      this.createTake(targetId, files[0]);\n    } else {\n      alert(\n        \"Please upload valid audio file type (mp3, ogg, wav, flac, aac, aiff, m4a)\"\n      );\n      return;\n    }\n  };\n\n  setSelectedTrack = (id) => {\n    const newId = id !== null ? id : null;\n    console.log(\"selecting track to record: \" + newId);\n    this.setState({ selectedTrackId: newId });\n  };\n\n  formattedTime = (ms) => {\n    let minutes = Math.floor(ms / 60000);\n    let seconds = ((ms % 60000) / 1000).toFixed(2);\n    return minutes + \":\" + (seconds < 10 ? \"0\" : \"\") + seconds;\n  };\n\n  updateSoloTracks = (trackId) => {\n    let newSoloTracks = [...this.state.soloTracks];\n    let index = newSoloTracks.indexOf(trackId);\n\n    if (index !== -1) {\n      // remove\n      newSoloTracks.splice(index, 1);\n    } else {\n      // add\n      newSoloTracks.push(trackId);\n    }\n    console.log(\"new solo tracks:\", newSoloTracks);\n    this.setState({ soloTracks: newSoloTracks });\n  };\n\n  changeVolume = (value) => {\n    // convert linear 1->100 to log 1->100 via f(n) = 50 * log(n)\n    this.setState({ masterVolume: value / 75 });\n  };\n\n  render() {\n    return (\n      <div>\n        <div>\n          {this.props.trackMetadata &&\n          Object.keys(this.props.trackMetadata).length > 0 ? (\n            Object.keys(this.props.trackMetadata).map((trackId) => {\n              const trackInfo = this.props.trackMetadata[trackId];\n              return (\n                <div key={`track_${trackId}`}>\n                  <div>\n                    <Track\n                      trackName={trackInfo.track_name}\n                      trackId={trackId}\n                      takes={trackInfo.takes}\n                      masterPlay={this.state.masterPlay}\n                      masterStop={this.state.masterStop}\n                      masterRecord={this.state.masterRecord}\n                      selectedTrackId={this.state.selectedTrackId}\n                      setSelectedTrack={this.setSelectedTrack}\n                      deleteTake={this.deleteTake}\n                      soloTracks={this.state.soloTracks}\n                      updateSoloTracks={this.updateSoloTracks}\n                      masterVolume={this.state.masterVolume}\n                      renameTrack={this.renameTrack}\n                      deleteTrack={this.deleteTrack}\n                      handleFileUpload={this.handleFileUpload}\n                    />\n                  </div>\n                  {Object.keys(this.props.trackMetadata[trackId].takes)\n                    .length === 0 && (\n                    <div style={{ marginTop: \"-20px\" }}>\n                      <input\n                        style={{\n                          marginLeft: \"20px\",\n                          marginTop: \"25px\",\n                          marginBottom: \"20px\",\n                        }}\n                        type=\"file\"\n                        onChange={(e) =>\n                          this.handleFileUpload(e.target.files, trackId)\n                        }\n                      />\n                    </div>\n                  )}\n                </div>\n              );\n            })\n          ) : (\n            <div style={{ marginTop: \"10px\" }} />\n          )}\n        </div>\n        <button\n          style={{ marginTop: \"10px\", marginLeft: \"5px\" }}\n          className=\"stitched\"\n          onClick={this.createTrack}\n        >\n          + New Track\n        </button>\n        <p>\n          <b>Master Controls</b>\n        </p>\n        {/* TODO: Live Monitoring, Rehearse */}\n        <IconButton\n          disableRipple\n          aria-label=\"Stop\"\n          onClick={this.toggleMasterRecord}\n          disabled={this.state.masterPlay}\n        >\n          {this.state.masterPlay ? (\n            <FiberManualRecordRoundedIcon style={{ fontSize: 28 }} />\n          ) : (\n            <FiberManualRecordRoundedIcon\n              style={{ fontSize: 28 }}\n              color=\"secondary\"\n            />\n          )}\n        </IconButton>\n        <IconButton\n          disableRipple\n          aria-label=\"Stop\"\n          onClick={this.toggleMasterStop}\n          disabled={!this.state.masterPlay}\n        >\n          <StopRoundedIcon style={{ fontSize: 35 }} />\n        </IconButton>\n        <IconButton\n          disableRipple\n          aria-label=\"Play\"\n          onClick={this.toggleMasterPlay}\n          disabled={this.state.masterPlay}\n          style={{ marginLeft: \"-5px\" }}\n        >\n          <PlayArrowRoundedIcon style={{ fontSize: 35 }} />\n        </IconButton>{\" \"}\n        {/* <button onClick={this.test}>Test</button>{\" \"} */}\n        {this.formattedTime(this.state.runningTime)}\n        <div\n          style={{\n            position: \"absolute\",\n            marginLeft: \"245px\",\n            marginTop: \"-45px\",\n            width: \"100px\",\n          }}\n        >\n          Volume\n          <Slider\n            min={0}\n            max={100}\n            defaultValue={50}\n            onChange={this.changeVolume}\n          />\n        </div>\n        {this.state.showCountdown && (\n          <div className=\"timer\" style={{ marginTop: \"10px\" }}>\n            <CountdownCircleTimer\n              isPlaying\n              duration={3}\n              colors={[[\"#0f52bd\", 1]]}\n              onComplete={() => {\n                const startTime = Date.now() - this.state.runningTime;\n                this.timer = setInterval(() => {\n                  this.setState({ runningTime: Date.now() - startTime });\n                });\n                this.setState({ showCountdown: false, masterPlay: true });\n              }}\n            >\n              {({ remainingTime }) => remainingTime}\n            </CountdownCircleTimer>\n            <button\n              onClick={() => {\n                this.setState({\n                  showCountdown: false,\n                });\n                this.toggleMasterStop();\n              }}\n              style={{ marginTop: \"10px\" }}\n            >\n              Ahh I'm not ready!\n            </button>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default DAW;\n","import React, { Component } from \"react\";\nimport DAW from \"./daw/DAW\";\nimport { Prompt, Confirm } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\n\nclass Project extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      project_name: null,\n      group_name: null,\n      project_id: null,\n      track_metadata: null,\n      project_hash: props.location.pathname.split(\"/\").pop(),\n    };\n    if (this.state.project_hash === \"project\") {\n      this.state.project_hash = null;\n    }\n    this.createTrack = this.createTrack.bind(this);\n    this.deleteTrack = this.deleteTrack.bind(this);\n    this.renameTrack = this.renameTrack.bind(this);\n    this.createTake = this.createTake.bind(this);\n    this.deleteTake = this.deleteTake.bind(this);\n  }\n\n  componentDidMount() {\n    this.retrieveProject();\n  }\n\n  retrieveProject = () => {\n    console.log(\"retrieving project: \" + this.state.project_hash);\n    if (this.state.project_hash === null || this.state.project_hash === \"\") {\n      return;\n    }\n    fetch(\n      \"/api/project?\" +\n        new URLSearchParams({ project_hash: this.state.project_hash })\n    )\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        const tracks = obj.body.tracks\n          ? obj.body.tracks.reduce((obj, item) => {\n              const formatted_takes = item[\"takes\"].reduce((obj, item) => {\n                obj[item[\"take\"]] = {\n                  date_uploaded: item[\"date_uploaded\"],\n                  id: item[\"id\"],\n                  s3_info: item[\"s3_info\"],\n                  track_id: item[\"track_id\"],\n                };\n                return obj;\n              }, {});\n              obj[item[\"id\"]] = {\n                takes: formatted_takes,\n                track_name: item[\"track_name\"],\n              };\n              return obj;\n            }, {})\n          : {};\n        if (obj.status === 200) {\n          this.setState({\n            project_name: obj.body.project_name,\n            group_name: obj.body.group.group_name,\n            project_id: obj.body.id,\n            track_metadata: tracks,\n          });\n        }\n      });\n  };\n\n  async createTrack() {\n    console.log(\"creating new track\");\n    const track_name = await Prompt(\"Name Your Track\", {\n      isRequired: true,\n    });\n    if (track_name) {\n      const formData = new FormData();\n      formData.append(\"track_name\", track_name);\n      formData.append(\"project_id\", this.state.project_id);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n      fetch(\"/api/track\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status !== 400) {\n            console.log(\"added new track\");\n            let updatedTracks = Object.assign({}, this.state.track_metadata);\n            updatedTracks[obj.body.track_id] = {\n              id: parseInt(obj.body.track_id),\n              project_id: this.state.projectId,\n              takes: {},\n              track_name: track_name,\n            };\n            this.setState({ track_metadata: updatedTracks });\n          }\n        });\n    }\n  }\n\n  async renameTrack(id, name) {\n    console.log(\"renaming track\");\n    const new_name = await Prompt(\"Rename Your Track\", {\n      isRequired: true,\n      defaultValue: name,\n    });\n    if (new_name) {\n      const formData = new FormData();\n      formData.append(\"track_id\", id);\n      formData.append(\"new_name\", new_name);\n      const requestOptions = {\n        method: \"PUT\",\n        body: formData,\n      };\n      fetch(\"/api/track\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            let updatedTracks = Object.assign({}, this.state.track_metadata);\n            updatedTracks[id].track_name = new_name;\n            this.setState({ track_metadata: updatedTracks });\n          }\n        });\n    }\n  }\n\n  async deleteTrack(id, name) {\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Track\"\n    );\n    if (result) {\n      const formData = new FormData();\n      formData.append(\"track_id\", id);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/track\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedTracks = Object.assign({}, this.state.track_metadata);\n            delete updatedTracks[id];\n            this.setState({ track_metadata: updatedTracks });\n            return true;\n          }\n        });\n    }\n    return false;\n  }\n\n  createTake(track_id, file, latency) {\n    console.log(\"creating new take for\", track_id);\n    const formData = new FormData();\n    formData.append(\"track_id\", track_id);\n    formData.append(\"file\", file);\n    formData.append(\"latency\", latency);\n    const requestOptions = {\n      method: \"POST\",\n      body: formData,\n    };\n\n    fetch(\"/api/take\", requestOptions)\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        if (obj.status !== 400) {\n          let updatedTracks = Object.assign({}, this.state.track_metadata);\n          updatedTracks[parseInt(track_id)].takes[parseInt(obj.body.take)] = {\n            id: parseInt(obj.body.take_id),\n            track_id: parseInt(track_id),\n            s3_info: obj.body.s3_info,\n            date_uploaded: new Date(obj.body.timestamp).toString(),\n          };\n          this.setState({ track_metadata: updatedTracks });\n        }\n      });\n  }\n\n  deleteTake(track_id, take_number, take_id) {\n    const formData = new FormData();\n    formData.append(\"take_id\", take_id);\n    const requestOptions = {\n      method: \"DELETE\",\n      body: formData,\n    };\n    fetch(\"/api/take\", requestOptions)\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        if (obj.status === 200) {\n          const updatedTracks = Object.assign({}, this.state.track_metadata);\n          delete updatedTracks[track_id].takes[take_number];\n          this.setState({ track_metadata: updatedTracks });\n        }\n      });\n  }\n\n  render() {\n    const pathSuffix = this.props.location.pathname.split(\"/\").pop();\n    return (\n      this.state.project_hash &&\n      pathSuffix !== \"project\" &&\n      pathSuffix !== \"\" && (\n        <div>\n          <h2>{this.state.project_name}</h2>\n          <div style={{ marginTop: \"20px\" }}>\n            <DAW\n              trackMetadata={this.state.track_metadata}\n              retrieveProject={this.retrieveProject}\n              createTrack={this.createTrack}\n              deleteTrack={this.deleteTrack}\n              renameTrack={this.renameTrack}\n              createTake={this.createTake}\n              deleteTake={this.deleteTake}\n            />\n          </div>\n        </div>\n      )\n    );\n  }\n}\n\nexport default Project;\n","import React, { useState } from \"react\";\nimport { Redirect } from \"react-router\";\n\n// mimics Zoom's search functionality (i.e. if you enter mit.zoom.us/j/ without any ID)\nfunction ProjectSearch() {\n  const [projectId, setProjectId] = useState(\"\");\n  const [redirect, setRedirect] = useState(false);\n\n  const searchProject = () => {\n    console.log(\"projectId\", projectId);\n    fetch(\"/api/project?\" + new URLSearchParams({ project_hash: projectId }))\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((obj) => {\n        console.log(obj);\n        if (obj.status === 200) {\n          setRedirect(true);\n        }\n      })\n      .catch(function (err) {\n        alert(\"Cannot find project ID or URL: \" + projectId, err);\n      });\n  };\n\n  const handleChange = (e) => {\n    // url\n    if (e.target.value.startsWith(\"http\")) {\n      setProjectId(e.target.value.split(\"/\").pop());\n    } else {\n      setProjectId(e.target.value);\n    }\n  };\n\n  if (redirect) {\n    return <Redirect to={`/project/${projectId}`} />;\n  }\n\n  return (\n    <div>\n      <h2>Find a Project</h2>\n      <br></br>\n      <form style={{ marginLeft: 10 }}>\n        <input\n          style={{ width: 250 }}\n          type=\"text\"\n          value={projectId}\n          onChange={handleChange}\n          placeholder=\"Enter Project ID or URL\"\n        ></input>\n        <input type=\"submit\" hidden></input>\n        <button onClick={searchProject}>Go!</button>\n      </form>\n    </div>\n  );\n}\n\nexport default ProjectSearch;\n","import React, { Component } from \"react\";\n\nclass Home extends Component {\n  render() {\n    return (\n      <div>\n        <h2>HOMEPAGE</h2>\n        <p>Let's jam in sync! 🎶</p>\n      </div>\n    );\n  }\n}\n\nexport default Home;\n","import React, { useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\n\nconst RENAME_PROJECT_OPTION = \"Rename Project\";\nconst DELETE_PROJECT_OPTION = \"Delete Project\";\nconst options = [RENAME_PROJECT_OPTION, DELETE_PROJECT_OPTION];\n\nfunction Project(props) {\n  const history = useHistory();\n  const [threeDotsAnchorElement, setThreeDotsAnchorElement] = useState(null);\n\n  const rehearse = () => {\n    history.push({\n      pathname: `/project/${props.project.project_hash}`,\n      state: {\n        project: props.project,\n        group_name: props.group_name,\n        group_id: props.group_id,\n      },\n    });\n  };\n\n  const clickThreeDotsMenu = (e) => {\n    setThreeDotsAnchorElement(e.currentTarget);\n  };\n\n  const closeThreeDotsMenu = (e) => {\n    const option = e.target.innerText;\n    if (option === RENAME_PROJECT_OPTION) {\n      props.renameProject(props.project.id, props.project.project_name);\n    } else if (option === DELETE_PROJECT_OPTION) {\n      props.deleteProject(props.project.id, props.project.project_name);\n    }\n    setThreeDotsAnchorElement(null);\n  };\n\n  return (\n    <li>\n      Project: {props.project.project_name}{\" \"}\n      <button onClick={rehearse}>Rehearse!</button>\n      <IconButton\n        aria-label=\"more\"\n        aria-controls=\"project-menu\"\n        aria-haspopup=\"true\"\n        onClick={clickThreeDotsMenu}\n        style={{ marginLeft: \"5px\" }}\n      >\n        <MoreHorizIcon />\n      </IconButton>\n      <Menu\n        id=\"project-menu\"\n        anchorEl={threeDotsAnchorElement}\n        keepMounted\n        open={threeDotsAnchorElement !== null}\n        onClose={closeThreeDotsMenu}\n        PaperProps={{\n          style: {\n            maxHeight: 40 * 4.5,\n            width: \"20ch\",\n          },\n        }}\n      >\n        {options.map((option) => (\n          <MenuItem key={option} onClick={closeThreeDotsMenu}>\n            {option}\n          </MenuItem>\n        ))}\n      </Menu>\n    </li>\n  );\n}\n\nexport default Project;\n","import React, { Component } from \"react\";\nimport Project from \"./Project\";\nimport \"./Group.css\";\nimport { Prompt, Confirm } from \"react-st-modal\";\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\n\nconst RENAME_GROUP_OPTION = \"Rename Group\";\nconst DELETE_GROUP_OPTION = \"Delete Group\";\nconst options = [RENAME_GROUP_OPTION, DELETE_GROUP_OPTION];\n\nclass Group extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      projects: props.projects,\n      threeDotsAnchorElement: null,\n    };\n    this.createNewProject = this.createNewProject.bind(this);\n    this.deleteProject = this.deleteProject.bind(this);\n    this.renameProject = this.renameProject.bind(this);\n  }\n\n  async createNewProject() {\n    const project_name = await Prompt(\"Name Your Project\", {\n      isRequired: true,\n    });\n    if (project_name) {\n      const formData = new FormData();\n      formData.append(\"project_name\", project_name);\n      formData.append(\"group_id\", this.props.id);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n\n      fetch(\"/api/project\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status !== 400) {\n            this.setState({\n              projects: this.state.projects.concat([\n                {\n                  project_name: project_name,\n                  id: obj.body.project_id,\n                  project_hash: obj.body.project_hash,\n                },\n              ]),\n            });\n          }\n        });\n    }\n  }\n\n  async deleteProject(id, name) {\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Project\"\n    );\n    if (result) {\n      const formData = new FormData();\n      formData.append(\"project_id\", id);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/project\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedProjects = [...this.state.projects].filter(\n              (i) => i.id !== id\n            );\n            this.setState({\n              projects: updatedProjects,\n            });\n          }\n        });\n    }\n  }\n\n  async renameProject(id, name) {\n    const new_name = await Prompt(\"Rename Your Project\", {\n      isRequired: true,\n      defaultValue: name,\n    });\n    if (new_name) {\n      const formData = new FormData();\n      formData.append(\"project_id\", id);\n      formData.append(\"new_name\", new_name);\n      const requestOptions = {\n        method: \"PUT\",\n        body: formData,\n      };\n\n      fetch(\"/api/project\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedProjects = [\n              ...this.state.projects,\n            ].map((projectInfo) =>\n              projectInfo.id === id\n                ? { ...projectInfo, project_name: new_name }\n                : projectInfo\n            );\n            this.setState({\n              projects: updatedProjects,\n            });\n          }\n        });\n    }\n  }\n\n  clickThreeDotsMenu = (e) => {\n    this.setState({ threeDotsAnchorElement: e.currentTarget });\n  };\n\n  closeThreeDotsMenu = (e) => {\n    const option = e.target.innerText;\n    if (option === RENAME_GROUP_OPTION) {\n      this.props.renameGroup(this.props.id, this.props.name);\n    } else if (option === DELETE_GROUP_OPTION) {\n      this.props.deleteGroup(this.props.id, this.props.name);\n    }\n    this.setState({ threeDotsAnchorElement: null });\n  };\n\n  render() {\n    return (\n      <div>\n        <h3>\n          Group Name: {this.props.name}{\" \"}\n          <button onClick={this.createNewProject}>+ New Project</button>\n          <IconButton\n            aria-label=\"more\"\n            aria-controls=\"group-menu\"\n            aria-haspopup=\"true\"\n            onClick={this.clickThreeDotsMenu}\n            style={{ marginLeft: \"5px\" }}\n          >\n            <MoreHorizIcon />\n          </IconButton>\n          <Menu\n            id=\"group-menu\"\n            anchorEl={this.state.threeDotsAnchorElement}\n            keepMounted\n            open={this.state.threeDotsAnchorElement !== null}\n            onClose={this.closeThreeDotsMenu}\n            PaperProps={{\n              style: {\n                maxHeight: 40 * 4.5,\n                width: \"20ch\",\n              },\n            }}\n          >\n            {options.map((option) => (\n              <MenuItem key={option} onClick={this.closeThreeDotsMenu}>\n                {option}\n              </MenuItem>\n            ))}\n          </Menu>\n        </h3>\n        <div style={{ marginTop: \"-25px\" }}>\n          <ul>\n            {this.state.projects && this.state.projects.length === 0 && (\n              <p className=\"text-muted\" style={{ marginTop: \"25px\" }}>\n                No projects created yet!\n              </p>\n            )}\n            {this.state.projects.map((projectInfo, i) => (\n              <div key={`project_${i}`}>\n                <div style={{ marginTop: \"-20px\", marginBottom: \"-10px\" }}>\n                  <Project\n                    project={projectInfo}\n                    group_name={this.props.name}\n                    group_id={this.props.id}\n                    renameProject={this.renameProject}\n                    deleteProject={this.deleteProject}\n                  />\n                </div>\n              </div>\n            ))}\n          </ul>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Group;\n","import React, { Component } from \"react\";\nimport Group from \"./Group\";\nimport \"./Groups.css\";\nimport { Confirm, Prompt } from \"react-st-modal\"; // https://github.com/Nodlik/react-st-modal\n\nclass Groups extends Component {\n  constructor() {\n    super();\n    this.state = {\n      groups: [],\n    };\n    fetch(\"/api/groups\", {\n      method: \"GET\",\n    })\n      .then((resp) =>\n        resp.json().then((data) => ({ status: resp.status, body: data }))\n      )\n      .then((res) => {\n        if (res.status !== 400) {\n          this.setState({ groups: res.body });\n        }\n      });\n    this.createNewGroup = this.createNewGroup.bind(this);\n    this.deleteGroup = this.deleteGroup.bind(this);\n    this.renameGroup = this.renameGroup.bind(this);\n  }\n\n  async createNewGroup() {\n    console.log(\"creating new group!\");\n    const group_name = await Prompt(\"Name Your Group\", {\n      isRequired: true,\n    });\n    if (group_name) {\n      const formData = new FormData();\n      formData.append(\"group_name\", group_name);\n      const requestOptions = {\n        method: \"POST\",\n        body: formData,\n      };\n\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status !== 400) {\n            this.setState({\n              groups: this.state.groups.concat([\n                { group_name: group_name, id: obj.body.group_id, projects: [] },\n              ]),\n            });\n          }\n        });\n    }\n  }\n\n  async deleteGroup(id, name) {\n    console.log(\"deleting group\");\n    const result = await Confirm(\n      `Are you sure you want to delete \"${name}\"?`,\n      \"Delete Group\"\n    );\n    if (result) {\n      const formData = new FormData();\n      formData.append(\"group_id\", id);\n      const requestOptions = {\n        method: \"DELETE\",\n        body: formData,\n      };\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedGroups = [...this.state.groups].filter(\n              (i) => i.id !== id\n            );\n            this.setState({\n              groups: updatedGroups,\n            });\n          }\n        });\n    }\n  }\n\n  async renameGroup(id, name) {\n    console.log(\"renaming group\");\n    const new_name = await Prompt(\"Rename Your Group\", {\n      isRequired: true,\n      defaultValue: name,\n    });\n    if (new_name) {\n      const formData = new FormData();\n      formData.append(\"new_name\", new_name);\n      formData.append(\"group_id\", id);\n      const requestOptions = {\n        method: \"PUT\",\n        body: formData,\n      };\n\n      fetch(\"/api/group\", requestOptions)\n        .then((resp) =>\n          resp.json().then((data) => ({ status: resp.status, body: data }))\n        )\n        .then((obj) => {\n          if (obj.status === 200) {\n            const updatedGroups = [...this.state.groups].map((groupInfo) =>\n              groupInfo.id === id\n                ? { ...groupInfo, group_name: new_name }\n                : groupInfo\n            );\n            this.setState({\n              groups: updatedGroups,\n            });\n          }\n        });\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <h2>GROUPS</h2>\n        {this.state.groups &&\n          this.state.groups.map((groupInfo, i) => (\n            <div key={`group_${i}`}>\n              <Group\n                id={groupInfo.id}\n                name={groupInfo.group_name}\n                projects={groupInfo.projects}\n                renameGroup={this.renameGroup}\n                deleteGroup={this.deleteGroup}\n              />\n            </div>\n          ))}\n        <button className=\"stitched\" onClick={this.createNewGroup}>\n          + New Group\n        </button>\n      </div>\n    );\n  }\n}\n\nexport default Groups;\n","import React, { useState } from \"react\";\nimport { Jutsu } from \"react-jutsu\";\n\n// https://github.com/this-fifo/jutsu\nexport const EmbeddedJitsi = () => {\n  const [displayName, setDisplayName] = useState(\"\");\n  const [roomName, setRoomName] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [onCall, setOnCall] = useState(false);\n\n  const handleClick = (event) => {\n    event.preventDefault();\n    if (roomName && displayName) setOnCall(true);\n  };\n\n  return (\n    <div>\n      <h2>Jitsi</h2>\n      <br />\n      {onCall ? (\n        <Jutsu\n          containerStyles={{ width: \"800px\", height: \"400px\" }}\n          roomName={roomName}\n          displayName={displayName}\n          password={password}\n          onMeetingEnd={() => console.log(\"Meeting has ended\")}\n          loadingComponent={<p>Loading ...</p>}\n          errorComponent={<p>Oops, something went wrong</p>}\n        />\n      ) : (\n        <form>\n          <p>Create a Room</p>\n          <input\n            id=\"room\"\n            type=\"text\"\n            placeholder=\"Room Name\"\n            value={roomName}\n            onChange={(e) => setRoomName(e.target.value)}\n          />\n          <input\n            id=\"name\"\n            type=\"text\"\n            placeholder=\"Name\"\n            value={displayName}\n            onChange={(e) => setDisplayName(e.target.value)}\n          />\n          <input\n            id=\"password\"\n            type=\"text\"\n            placeholder=\"Password (optional)\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n          />\n          <button onClick={handleClick} type=\"submit\">\n            Start / Join\n          </button>\n        </form>\n      )}\n    </div>\n  );\n};\n","import { Mp3Encoder } from \"lamejs\";\n\nclass Encoder {\n  constructor(config) {\n    this.config = {\n      sampleRate: 44100,\n      bitRate: 128,\n    };\n\n    Object.assign(this.config, config);\n\n    this.mp3Encoder = new Mp3Encoder(\n      1,\n      this.config.sampleRate,\n      this.config.bitRate\n    );\n\n    // Audio is processed by frames of 1152 samples per audio channel\n    // http://lame.sourceforge.net/tech-FAQ.txt\n    this.maxSamples = 1152;\n\n    this.samplesMono = null;\n    this.clearBuffer();\n  }\n\n  /**\n   * Clear active buffer\n   */\n  clearBuffer() {\n    this.dataBuffer = [];\n  }\n\n  /**\n   * Append new audio buffer to current active buffer\n   * @param {Buffer} buffer\n   */\n  appendToBuffer(buffer) {\n    this.dataBuffer.push(new Int8Array(buffer));\n  }\n\n  /**\n   * Float current data to 16 bits PCM\n   * @param {Float32Array} input\n   * @param {Int16Array} output\n   */\n  floatTo16BitPCM(input, output) {\n    for (let i = 0; i < input.length; i++) {\n      const s = Math.max(-1, Math.min(1, input[i]));\n      output[i] = s < 0 ? s * 0x8000 : s * 0x7fff;\n    }\n  }\n\n  /**\n   * Convert buffer to proper format\n   * @param {Array} arrayBuffer\n   */\n  convertBuffer(arrayBuffer) {\n    const data = new Float32Array(arrayBuffer);\n    const out = new Int16Array(arrayBuffer.length);\n    this.floatTo16BitPCM(data, out);\n\n    return out;\n  }\n\n  /**\n   * Encode and append current buffer to dataBuffer\n   * @param {Array} arrayBuffer\n   */\n  encode(arrayBuffer) {\n    this.samplesMono = this.convertBuffer(arrayBuffer);\n    let remaining = this.samplesMono.length;\n\n    for (let i = 0; remaining >= 0; i += this.maxSamples) {\n      const left = this.samplesMono.subarray(i, i + this.maxSamples);\n      const mp3buffer = this.mp3Encoder.encodeBuffer(left);\n      this.appendToBuffer(mp3buffer);\n      remaining -= this.maxSamples;\n    }\n  }\n\n  /**\n   * Return full dataBuffer\n   */\n  finish() {\n    this.appendToBuffer(this.mp3Encoder.flush());\n\n    return this.dataBuffer;\n  }\n}\n\nexport default Encoder;\n","import React, { Component } from \"react\";\nimport MicRecorder from \"./MicRecorder\";\n\nconst audioType = \"audio/mp3\";\nconst Mp3Recorder = new MicRecorder({ bitRate: 128 });\n\nclass WebAudio extends Component {\n  constructor() {\n    super();\n    this.state = {\n      recording: false,\n      recordings: [],\n    };\n    // this.clearBuffer();\n  }\n\n  // componentDidMount() {\n  //   navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {\n  //     this.mediaRecorder = new MediaRecorder(stream);\n  //     this.chunks = [];\n  //     this.mediaRecorder.ondataavailable = (e) => {\n  //       if (e.data && e.data.size > 0) {\n  //         this.chunks.push(e.data);\n  //       }\n  //     };\n  //   });\n  // }\n\n  // /**\n  //  * Clear active buffer\n  //  */\n  // clearBuffer = () => {\n  //   this.chunks = [];\n  // };\n\n  handleRecord = () => {\n    console.log(\"recording now\");\n    // wipe old data chunks\n    // this.chunks = [];\n    // start recorder with 10ms buffer\n    // this.mediaRecorder.start(10);\n    Mp3Recorder.start();\n    this.setState({ recording: true });\n  };\n\n  handleStopRecord = () => {\n    console.log(\"stopped now\");\n    // stop the recorder\n    // this.mediaRecorder.stop();\n    Mp3Recorder.stop()\n      .getMp3()\n      .then(([buffer, blob]) => {\n        // const file = new File(\n        //   [blob],\n        //   `recording_track_${this.state.selectedTrackId}.mp3`\n        // );\n        // const latency = 220; // in ms\n        // this.createTake(this.state.selectedTrackId, file, latency);\n        const blobURL = URL.createObjectURL(blob);\n        console.log(blobURL);\n        // append videoURL to list of saved videos for rendering\n        const recordings = this.state.recordings.concat([blobURL]);\n        // this.setState({ recordings });\n        this.setState({ recording: false, recordings });\n      })\n      .catch((e) => console.log(e));\n    // save audio to memory\n    // this.saveAudio();\n  };\n\n  convertBuffer = () => {\n    // const data = new Float32Array(this.chunks);\n    // const out = new Int16Array(this.chunks.length);\n    // // float to 16 bits PCM\n    // for (let i = 0; i < data.length; i++) {\n    //   const s = Math.max(-1, Math.min(1, data[i]));\n    //   out[i] = s < 0 ? s * 0x8000 : s * 0x7fff;\n    // }\n    // return out;\n  };\n\n  saveAudio() {\n    // this.samplesMono = this.convertBuffer();\n    // console.log(this.chunks.length);\n    // console.log(this.samplesMono.length);\n    // // encode to mp3\n    // let mp3Data = [];\n    // for (var i = 0; i < this.chunks.length; i += sampleBlockSize) {\n    //   let sampleChunk = this.chunks.subarray(i, i + sampleBlockSize);\n    //   let mp3buf = this.mp3encoder.encodeBuffer(sampleChunk);\n    //   if (mp3buf.length > 0) {\n    //     mp3Data.push(mp3buf);\n    //   }\n    // }\n    // let mp3buf = this.mp3encoder.flush();\n\n    // if (mp3buf.length > 0) {\n    //   mp3Data.push(new Int8Array(mp3buf));\n    // }\n\n    // convert saved chunks to blob\n    const blob = new Blob(this.chunks, { type: audioType });\n    console.log(blob);\n    // generate video url from blob\n    const blobURL = URL.createObjectURL(blob);\n    console.log(blobURL);\n    // append videoURL to list of saved videos for rendering\n    const recordings = this.state.recordings.concat([blobURL]);\n    this.setState({ recordings });\n  }\n\n  deleteRecording(blobURL) {\n    // filter out current videoURL from the list of saved videos\n    const recordings = this.state.recordings.filter((a) => a !== blobURL);\n    this.setState({ recordings });\n  }\n\n  render() {\n    return (\n      <div>\n        <div>\n          <p>test mic with web audio</p>\n          <button disabled={this.state.recording} onClick={this.handleRecord}>\n            record\n          </button>\n          <button\n            disabled={!this.state.recording}\n            onClick={this.handleStopRecord}\n          >\n            stop\n          </button>\n        </div>\n        <div>\n          <p>Recordings:</p>\n          {this.state.recordings.map((blobURL, i) => (\n            <div key={`recording_${i}`}>\n              <audio controls style={{ width: 300 }} src={blobURL} />\n              <div>\n                <button onClick={() => this.deleteRecording(blobURL)}>\n                  Delete\n                </button>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default WebAudio;\n","import Encoder from \"./Encoder\";\n\nclass MicRecorder {\n  constructor(config) {\n    this.mediaRecorder = null;\n    this.mediaChunks = [];\n    this.mediaStream = null;\n    // this.config = {\n    //   // 128 or 160 kbit/s – mid-range bitrate quality\n    //   bitRate: 160,\n    //   startRecordingAt: 0,\n    //   deviceId: null,\n    // };\n    // this.activeStream = null;\n    // this.context = null;\n    // this.microphone = null;\n    // this.processor = null;\n    // this.startTime = 0;\n    // Object.assign(this.config, config);\n  }\n\n  componentDidMount() {}\n\n  getMediaStream = () => {};\n\n  /**\n   * Starts to listen for the microphone sound\n   * @param {MediaStream} stream\n   */\n  addMicrophoneListener(stream) {\n    this.activeStream = stream;\n\n    // This prevents the weird noise once you start listening to the microphone\n    // this.timerToStart = setTimeout(() => {\n    //   delete this.timerToStart;\n    // }, this.config.startRecordingAt);\n\n    // Set up Web Audio API to process data from the media stream (microphone).\n    this.microphone = this.context.createMediaStreamSource(stream);\n\n    // Settings a bufferSize of 0 instructs the browser to choose the best bufferSize\n    this.processor = this.context.createScriptProcessor(0, 1, 1);\n\n    // Add all buffers from LAME into an array.\n    this.processor.onaudioprocess = (event) => {\n      // if (this.timerToStart) {\n      //   return;\n      // }\n\n      // Send microphone data to LAME for MP3 encoding while recording.\n      this.lameEncoder.encode(event.inputBuffer.getChannelData(0));\n    };\n\n    // Begin retrieving microphone data.\n    this.microphone.connect(this.processor);\n    this.processor.connect(this.context.destination);\n  }\n\n  /**\n   * Disconnect microphone, processor and remove activeStream\n   */\n  stop() {\n    if (this.processor && this.microphone) {\n      // Clean up the Web Audio API resources.\n      this.microphone.disconnect();\n      this.processor.disconnect();\n\n      // If all references using this.context are destroyed, context is closed\n      // automatically. DOMException is fired when trying to close again\n      if (this.context && this.context.state !== \"closed\") {\n        this.context.close();\n      }\n\n      this.processor.onaudioprocess = null;\n\n      // Stop all audio tracks. Also, removes recording icon from chrome tab\n      this.activeStream.getAudioTracks().forEach((track) => track.stop());\n    }\n\n    return this;\n  }\n\n  /**\n   * Requests access to the microphone and start recording\n   * @return Promise\n   */\n  start() {\n    this.context = new AudioContext();\n    this.config.sampleRate = this.context.sampleRate;\n    this.lameEncoder = new Encoder(this.config);\n\n    const audio = this.config.deviceId\n      ? { deviceId: { exact: this.config.deviceId } }\n      : true;\n\n    // return new Promise((resolve, reject) => {\n    navigator.mediaDevices.getUserMedia({ audio }).then((stream) => {\n      this.addMicrophoneListener(stream);\n      // resolve(stream);\n    });\n    // .catch(function (err) {\n    //   reject(err);\n    // });\n    // });\n  }\n\n  /**\n   * Return Mp3 Buffer and Blob with type mp3\n   * @return {Promise}\n   */\n  getMp3() {\n    const finalBuffer = this.lameEncoder.finish();\n\n    return new Promise((resolve, reject) => {\n      if (finalBuffer.length === 0) {\n        reject(new Error(\"No buffer to send\"));\n      } else {\n        resolve([finalBuffer, new Blob(finalBuffer, { type: \"audio/mp3\" })]);\n        this.lameEncoder.clearBuffer();\n      }\n    });\n  }\n}\n\nexport default MicRecorder;\n","import React from \"react\";\nimport { Route, Redirect } from \"react-router-dom\";\n\nfunction PrivateRoute({ component: Component, authed, ...rest }) {\n  return (\n    <Route\n      {...rest}\n      render={(props) => authed === true\n        ? <Component {...props} />\n        : <Redirect to={{ pathname: '/', state: { from: props.location } }} />\n      }\n    />\n  )\n}\n\nexport default PrivateRoute;","import React, { Component } from \"react\";\nimport { HashRouter, NavLink, Route } from \"react-router-dom\";\nimport { Redirect } from \"react-router\";\nimport { createHashHistory } from \"history\";\n\n// import Footer from \"./components/Footer\";\nimport Login from \"./components/Login\";\nimport Logout from \"./components/Logout\";\nimport Project from \"./routes/project/Project\";\nimport ProjectSearch from \"./routes/project/ProjectSearch\";\nimport Home from \"./routes/home/Home\";\nimport Groups from \"./routes/groups/Groups\";\nimport { EmbeddedJitsi } from \"./routes/temp-jitsi/EmbeddedJitsi\"; // temp\nimport WebAudio from \"./routes/temp-webaudio/WebAudio\"; // temp\n\nimport PrivateRoute from \"./utils/components/PrivateRoute\";\n\nconst history = createHashHistory();\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.state = {\n      userDetails: {},\n      isUserLoggedIn: false,\n    };\n  }\n\n  componentDidMount() {\n    let userDetails = JSON.parse(localStorage.getItem(\"userDetails\"));\n    let isUserLoggedIn = localStorage.getItem(\"isUserLoggedIn\") === \"true\";\n    if (isUserLoggedIn && !this.state.isUserLoggedIn) {\n      this.setState({\n        userDetails: userDetails,\n        isUserLoggedIn: isUserLoggedIn,\n      });\n    }\n  }\n\n  handleSuccessfulLogin = (response) => {\n    const userDetails = response.profileObj;\n    const formData = new FormData();\n    formData.append(\"google_auth_id\", userDetails.googleId);\n    formData.append(\"google_email\", userDetails.email);\n    formData.append(\"user_name\", userDetails.name);\n    const requestOptions = {\n      method: \"POST\",\n      body: formData,\n    };\n\n    fetch(\"/auth/login\", requestOptions)\n      .then((resp) => resp.json())\n      .then((res) => {\n        console.log(res);\n      });\n\n    localStorage.setItem(\"userDetails\", JSON.stringify(userDetails));\n    localStorage.setItem(\"isUserLoggedIn\", true);\n    this.setState({ userDetails: userDetails, isUserLoggedIn: true });\n  };\n\n  handleSuccessfulLogout = () => {\n    fetch(\"/auth/logout\", { method: \"POST\" })\n      .then((resp) => resp.json())\n      .then((res) => {\n        console.log(res);\n      });\n    localStorage.clear();\n    this.setState({ userDetails: {}, isUserLoggedIn: false });\n  };\n\n  render() {\n    // default to groups page if no history, otherwise go to last page before refresh\n    let pathname = history.location.pathname;\n    if (this.state.isUserLoggedIn && history.location.pathname === \"/\") {\n      pathname = \"/groups\";\n    }\n    return (\n      <HashRouter history={history}>\n        <div>\n          <h1>JamNSync</h1>\n          <div style={{ position: \"absolute\", right: 20, top: 35 }}>\n            {!this.state.isUserLoggedIn && (\n              <Login onSuccessfulLogin={this.handleSuccessfulLogin} />\n            )}\n            {this.state.isUserLoggedIn && (\n              <div style={{ display: \"flex\" }}>\n                <div>\n                  <p>Welcome, {this.state.userDetails.givenName}!</p>\n                </div>\n                <div style={{ marginLeft: \"5px\" }}>\n                  <Logout onSuccessfulLogout={this.handleSuccessfulLogout} />\n                </div>\n              </div>\n            )}\n          </div>\n\n          <ul className=\"header\">\n            {!this.state.isUserLoggedIn && (\n              <li>\n                <NavLink exact to=\"/\">\n                  Home\n                </NavLink>\n              </li>\n            )}\n            {this.state.isUserLoggedIn && (\n              <div>\n                <li>\n                  <NavLink to=\"/groups\">Groups</NavLink>\n                </li>\n                <li>\n                  <NavLink to=\"/project\">Project</NavLink>\n                </li>\n                {/* <li>\n                  <NavLink to=\"/jitsi\">Jitsi (temp)</NavLink>\n                </li> */}\n                {/* <li>\n                  <NavLink to=\"/webaudio\">Web Audio (temp)</NavLink>\n                </li> */}\n              </div>\n            )}\n          </ul>\n\n          <div className=\"content\">\n            <Route exact path=\"/\">\n              {this.state.isUserLoggedIn ? (\n                <Redirect to={pathname} />\n              ) : (\n                <Home />\n              )}\n            </Route>\n            <PrivateRoute\n              path=\"/groups\"\n              component={Groups}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              exact\n              path={[\"/project\", \"/project/\"]}\n              component={ProjectSearch}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              path=\"/project\"\n              component={Project}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              path=\"/jitsi\"\n              component={EmbeddedJitsi}\n              authed={this.state.isUserLoggedIn}\n            />\n            <PrivateRoute\n              path=\"/webaudio\"\n              component={WebAudio}\n              authed={this.state.isUserLoggedIn}\n            />\n          </div>\n\n          {/* <Footer /> */}\n        </div>\n      </HashRouter>\n    );\n  }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(\n  <App />,\n  document.getElementById(\"root\")\n);"],"sourceRoot":""}